"use strict";var ad=Object.create;var Do=Object.defineProperty;var od=Object.getOwnPropertyDescriptor;var sd=Object.getOwnPropertyNames;var ld=Object.getPrototypeOf,cd=Object.prototype.hasOwnProperty;var ud=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of sd(t))!cd.call(e,i)&&i!==r&&Do(e,i,{get:()=>t[i],enumerable:!(n=od(t,i))||n.enumerable});return e};var fd=(e,t,r)=>(r=e!=null?ad(ld(e)):{},ud(t||!e||!e.__esModule?Do(r,"default",{value:e,enumerable:!0}):r,e));const D=require("electron"),V=require("path"),st=require("url"),ue=require("fs"),hr=require("crypto"),dd=require("constants"),zr=require("stream"),Oa=require("util"),Ol=require("assert"),Jn=require("child_process"),Dl=require("events"),Pl=require("tty"),Qn=require("os"),Fl=require("zlib"),hd=require("http");var Di=typeof document<"u"?document.currentScript:null;const ha="https://hardwavestudios.com/api",lr=V.join(D.app.getPath("userData"),"auth.json");let et=null;function $l(e){try{const t=JSON.stringify(e);if(D.safeStorage.isEncryptionAvailable()){const r=D.safeStorage.encryptString(t);ue.writeFileSync(lr,r)}else ue.writeFileSync(lr,t);et=e}catch(t){console.error("Failed to save auth data:",t)}}function Zn(){if(et)return et;try{if(!ue.existsSync(lr))return null;const e=ue.readFileSync(lr);if(D.safeStorage.isEncryptionAvailable())try{const t=D.safeStorage.decryptString(e);return et=JSON.parse(t),et}catch{return et=JSON.parse(e.toString()),et}else return et=JSON.parse(e.toString()),et}catch(e){return console.error("Failed to load auth data:",e),null}}function Ll(){try{ue.existsSync(lr)&&ue.unlinkSync(lr),et=null}catch(e){console.error("Failed to clear auth data:",e)}}async function pd(e,t){try{const n=await(await fetch(`${ha}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})).json();if(!n.success)return{success:!1,error:n.error||"Login failed"};const i=await fetch(`${ha}/subscription`,{headers:{Authorization:`Bearer ${n.token}`}});let a=null;if(i.ok){const s=await i.json();s.success&&s.subscription&&(a={status:s.subscription.status,planName:s.subscription.planName,currentPeriodEnd:s.subscription.currentPeriodEnd})}const o={token:n.token,user:{id:n.user.id,email:n.user.email,displayName:n.user.display_name,isAdmin:n.user.isAdmin},subscription:a};return $l(o),{success:!0,data:o}}catch(r){return console.error("Login error:",r),{success:!1,error:"Connection failed. Please check your internet."}}}async function md(){var t,r,n,i,a,o;const e=Zn();if(!e)return{valid:!1,hasSubscription:!1};try{const s=await fetch(`${ha}/subscription`,{headers:{Authorization:`Bearer ${e.token}`}});if(!s.ok)return s.status===401?(Ll(),{valid:!1,hasSubscription:!1}):{valid:!0,hasSubscription:((t=e.subscription)==null?void 0:t.status)==="active"||((r=e.subscription)==null?void 0:r.status)==="trialing",data:e};const l=await s.json();return l.success&&(e.subscription=l.subscription?{status:l.subscription.status,planName:l.subscription.planName,currentPeriodEnd:l.subscription.currentPeriodEnd}:null,$l(e)),{valid:!0,hasSubscription:((n=e.subscription)==null?void 0:n.status)==="active"||((i=e.subscription)==null?void 0:i.status)==="trialing"||e.user.isAdmin,data:e}}catch(s){return console.error("Session verification error:",s),{valid:!0,hasSubscription:((a=e.subscription)==null?void 0:a.status)==="active"||((o=e.subscription)==null?void 0:o.status)==="trialing"||e.user.isAdmin,data:e}}}function gd(){return Zn()}function Ed(){var t,r;const e=Zn();return e?e.user.isAdmin?!0:((t=e.subscription)==null?void 0:t.status)==="active"||((r=e.subscription)==null?void 0:r.status)==="trialing":!1}function ei(){const e=Zn();return(e==null?void 0:e.token)??null}const yd="https://hardwavestudios.com/api/library";async function oe(e,t={}){const{method:r="GET",body:n,params:i}=t,a=ei();if(!a)throw new Error("Not authenticated");let o=`${yd}${e}`;if(i){const s=new URLSearchParams;for(const[h,c]of Object.entries(i))c!=null&&s.append(h,String(c));const l=s.toString();l&&(o+=`?${l}`)}return new Promise((s,l)=>{const h=D.net.request({method:r,url:o});h.setHeader("Authorization",`Bearer ${a}`),h.setHeader("Content-Type","application/json");let c="";h.on("response",f=>{f.on("data",d=>{c+=d.toString()}),f.on("end",()=>{try{const d=JSON.parse(c);f.statusCode&&f.statusCode>=400?l(new Error(d.error||`HTTP ${f.statusCode}`)):s(d)}catch{l(new Error("Failed to parse response"))}})}),h.on("error",f=>{l(f)}),n&&h.write(JSON.stringify(n)),h.end()})}const At={async getAll(e=100,t=0,r){return(await oe("/files",{params:{limit:e,offset:t,...r&&{search:r}}})).files},async search(e,t={}){const r=await oe("/files",{params:{search:e,...t}});return{files:r.files,total:r.total}},async getById(e){return oe(`/files/${e}`)},async sync(e){return oe("/files/sync",{method:"POST",body:{files:e}})},async update(e,t){return oe(`/files/${e}`,{method:"PATCH",body:t})},async delete(e){return oe(`/files/${e}`,{method:"DELETE"})},async setFavorite(e,t){return this.update(e,{is_favorite:t?1:0})},async setRating(e,t){return this.update(e,{rating:t})},async addTags(e,t){var i;const n=((i=(await this.getById(e)).tags)==null?void 0:i.map(a=>a.id))||[];return this.update(e,{tagIds:[...new Set([...n,...t])]})},async removeTags(e,t){var i;const n=((i=(await this.getById(e)).tags)==null?void 0:i.map(a=>a.id))||[];return this.update(e,{tagIds:n.filter(a=>!t.includes(a))})}},Da={async getAll(){return(await oe("/tags")).tags},async create(e,t,r){return oe("/tags",{method:"POST",body:{name:e,category:t,color:r}})},async delete(e){return oe("/tags",{method:"DELETE",body:{id:e}})}},Mt={async getAll(){return(await oe("/collections")).collections},async getById(e){return oe(`/collections/${e}`)},async create(e,t,r){return oe("/collections",{method:"POST",body:{name:e,color:t,description:r}})},async update(e,t){return oe(`/collections/${e}`,{method:"PATCH",body:t})},async delete(e){return oe(`/collections/${e}`,{method:"DELETE"})},async addFiles(e,t){return this.update(e,{addFileIds:t})},async removeFiles(e,t){return this.update(e,{removeFileIds:t})}},wd={async get(){return oe("/stats")}},Po="https://hardwavestudios.com/api/cloud",Bt={async getFiles(e=1,t=50){return oe("/cloud/files",{params:{page:e,limit:t}})},async getFile(e){return oe(`/cloud/files/${e}`)},async deleteFile(e){return oe(`/cloud/files/${e}`,{method:"DELETE"})},getDownloadUrl(e){const t=ei();return`${Po}/download/${e}?token=${t}`},getShareDownloadUrl(e){return`${Po}/download/share/${e}`},async shareFile(e,t=!0){return oe(`/cloud/share/${e}`,{method:"POST",body:{is_public:t}})},async revokeShare(e){return oe(`/cloud/share/${e}`,{method:"DELETE"})},async getSharedWithMe(){return oe("/cloud/shared-with-me")},async getStorage(){return oe("/cloud/storage")},async getFileInfo(e){return oe(`/cloud/file-info/${e}`)}},_d=[".wav",".mp3",".flac",".aiff",".ogg",".m4a"],vd=[".flp"],Td=[".mid",".midi"],Ad=[".fst",".nmsv",".sylenth1",".serum"];function Sd(e){return _d.includes(e)?"sample":vd.includes(e)?"project":Td.includes(e)?"midi":Ad.includes(e)?"preset":null}async function Cd(e){return new Promise((t,r)=>{const n=hr.createHash("sha256"),i=ue.createReadStream(e);i.on("data",a=>n.update(a)),i.on("end",()=>t(n.digest("hex"))),i.on("error",r)})}async function Nd(e){try{const t=ue.statSync(e),r=V.extname(e).toLowerCase(),n=Sd(r);if(console.log(`Scanning: ${e}, ext: ${r}, type: ${n}`),!n)return console.log(`Skipping file with unsupported extension: ${r}`),null;const i=V.basename(e),a=await Cd(e);return{file_path:e,filename:i,file_type:n,file_extension:r,file_size:t.size,created_at:Math.floor(t.birthtimeMs),modified_at:Math.floor(t.mtimeMs),hash:a,indexed_at:Date.now(),duration:void 0,sample_rate:void 0,bit_depth:void 0,channels:void 0,bpm:void 0,detected_key:void 0,detected_scale:void 0,energy_level:void 0,notes:void 0,rating:0,color_code:void 0,is_favorite:!1,use_count:0}}catch(t){return console.error(`Error scanning file ${e}:`,t),null}}async function*xl(e){try{const t=ue.readdirSync(e,{withFileTypes:!0});for(const r of t){const n=V.join(e,r.name);if(r.isDirectory()){if(r.name.startsWith(".")||r.name==="node_modules")continue;yield*xl(n)}else r.isFile()&&(yield n)}}catch(t){console.error(`Error reading directory ${e}:`,t)}}function bd(e){const t=[],r=V.basename(e).toLowerCase(),n=V.dirname(e).toLowerCase();(r.includes("hardstyle")||n.includes("hardstyle"))&&t.push("Hardstyle"),(r.includes("rawstyle")||r.includes("raw")||n.includes("rawstyle"))&&t.push("Rawstyle"),(r.includes("hardcore")||n.includes("hardcore"))&&t.push("Hardcore"),(r.includes("uptempo")||n.includes("uptempo"))&&t.push("Uptempo"),(r.includes("euphoric")||n.includes("euphoric"))&&t.push("Euphoric"),r.includes("kick")&&t.push("Kick"),r.includes("lead")&&t.push("Lead"),(r.includes("screech")||r.includes("screecher"))&&t.push("Screech"),(r.includes("atmosphere")||r.includes("atmo"))&&t.push("Atmosphere"),r.includes("vocal")&&t.push("Vocal"),(r.includes("fx")||r.includes("effect"))&&t.push("FX");const i=r.match(/(\d{3})\s*bpm/i);if(i){const a=parseInt(i[1]);a>=140&&a<=155&&t.push("Hardstyle"),a>=150&&a<=160&&t.push("Rawstyle"),a>=160&&a<=180&&t.push("Hardcore"),a>=180&&t.push("Uptempo")}return t}async function Ul(e,t={}){const{recursive:r=!0,autoTag:n=!0,onProgress:i}=t;console.log("========================================"),console.log(`Starting scan of folder: ${e}`),console.log(`Recursive: ${r}, AutoTag: ${n}`),console.log("========================================");const a={indexed:0,duplicates:0,errors:0,files:[]};let o=[];if(r)for await(const h of xl(e))o.push(h);else o=ue.readdirSync(e,{withFileTypes:!0}).filter(c=>c.isFile()).map(c=>V.join(e,c.name));const s=o.length;console.log(`Found ${s} total files in directory`),i&&i({total:s,indexed:0,status:"scanning"});const l=[];for(let h=0;h<o.length;h++){const c=o[h];try{const f=await Nd(c);if(f){const d=n?bd(c):[];l.push({...f,suggestedTags:d})}i&&(h%10===0||h===o.length-1)&&i({total:s,indexed:h+1,current_file:V.basename(c),status:"scanning"})}catch(f){a.errors++,console.error(`Error processing ${c}:`,f)}}if(l.length>0)try{i&&i({total:s,indexed:l.length,status:"analyzing"});const h=50;for(let c=0;c<l.length;c+=h){const f=l.slice(c,c+h),d=await At.sync(f);if(d.results){for(const m of d.results)a.files.push(m);a.indexed+=d.results.length}}}catch(h){console.error("Error syncing files to cloud:",h),a.errors+=l.length}return i&&i({total:s,indexed:a.indexed,status:"complete"}),a}async function Rd(e,t={}){const r={indexed:0,duplicates:0,errors:0,files:[]};for(const n of e){const i=await Ul(n,t);r.indexed+=i.indexed,r.duplicates+=i.duplicates,r.errors+=i.errors,r.files.push(...i.files)}return r}let kl;try{kl=require("better-sqlite3")}catch(e){throw console.error("Failed to load better-sqlite3:",e),e}let Me=null;function Id(){const e=D.app.getPath("userData");return V.join(e,"fl-organizer.db")}function Od(){if(Me)return Me;const e=Id();console.log("Initializing database at:",e),Me=new kl(e),Me.pragma("foreign_keys = ON"),Me.pragma("journal_mode = WAL"),Me.pragma("synchronous = NORMAL"),Me.pragma("cache_size = -64000"),Me.pragma("temp_store = MEMORY");const t=`
-- FL Studio Organizer Database Schema
-- SQLite3 Database

-- Core file registry
CREATE TABLE IF NOT EXISTS files (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  file_path TEXT UNIQUE NOT NULL,
  filename TEXT NOT NULL,
  file_type TEXT NOT NULL CHECK(file_type IN ('sample', 'project', 'preset', 'midi', 'kickchain')),
  file_extension TEXT NOT NULL,
  file_size INTEGER,
  created_at INTEGER,
  modified_at INTEGER,
  last_accessed INTEGER,
  hash TEXT,
  indexed_at INTEGER NOT NULL,

  -- Audio metadata
  duration REAL,
  sample_rate INTEGER,
  bit_depth INTEGER,
  channels INTEGER,

  -- Musical metadata
  bpm REAL,
  detected_key TEXT,
  detected_scale TEXT,
  energy_level INTEGER,

  -- Custom fields
  notes TEXT,
  rating INTEGER DEFAULT 0 CHECK(rating >= 0 AND rating <= 5),
  color_code TEXT,
  is_favorite INTEGER DEFAULT 0 CHECK(is_favorite IN (0, 1)),
  use_count INTEGER DEFAULT 0
);

-- Indexes for performance
CREATE INDEX IF NOT EXISTS idx_files_type ON files(file_type);
CREATE INDEX IF NOT EXISTS idx_files_bpm ON files(bpm);
CREATE INDEX IF NOT EXISTS idx_files_key ON files(detected_key);
CREATE INDEX IF NOT EXISTS idx_files_favorite ON files(is_favorite);
CREATE INDEX IF NOT EXISTS idx_files_modified ON files(modified_at);
CREATE INDEX IF NOT EXISTS idx_files_hash ON files(hash);
CREATE INDEX IF NOT EXISTS idx_files_filename ON files(filename);

-- Full-text search on filenames and notes
CREATE VIRTUAL TABLE IF NOT EXISTS files_fts USING fts5(
  filename,
  notes,
  content='files',
  content_rowid='id'
);

-- Triggers to keep FTS in sync
CREATE TRIGGER IF NOT EXISTS files_fts_insert AFTER INSERT ON files BEGIN
  INSERT INTO files_fts(rowid, filename, notes) VALUES (new.id, new.filename, new.notes);
END;

CREATE TRIGGER IF NOT EXISTS files_fts_update AFTER UPDATE ON files BEGIN
  UPDATE files_fts SET filename = new.filename, notes = new.notes WHERE rowid = new.id;
END;

CREATE TRIGGER IF NOT EXISTS files_fts_delete AFTER DELETE ON files BEGIN
  DELETE FROM files_fts WHERE rowid = old.id;
END;

-- Tags system
CREATE TABLE IF NOT EXISTS tags (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT UNIQUE NOT NULL,
  category TEXT CHECK(category IN ('genre', 'instrument', 'energy', 'custom')),
  color TEXT,
  created_at INTEGER NOT NULL
);

CREATE INDEX IF NOT EXISTS idx_tags_category ON tags(category);
CREATE INDEX IF NOT EXISTS idx_tags_name ON tags(name);

-- Many-to-many relationship for file tags
CREATE TABLE IF NOT EXISTS file_tags (
  file_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  PRIMARY KEY (file_id, tag_id),
  FOREIGN KEY (file_id) REFERENCES files(id) ON DELETE CASCADE,
  FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE
);

CREATE INDEX IF NOT EXISTS idx_file_tags_file ON file_tags(file_id);
CREATE INDEX IF NOT EXISTS idx_file_tags_tag ON file_tags(tag_id);

-- Collections
CREATE TABLE IF NOT EXISTS collections (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  description TEXT,
  color TEXT,
  icon TEXT,
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL,
  is_smart INTEGER DEFAULT 0 CHECK(is_smart IN (0, 1)),
  smart_query TEXT
);

CREATE TABLE IF NOT EXISTS collection_files (
  collection_id INTEGER NOT NULL,
  file_id INTEGER NOT NULL,
  added_at INTEGER NOT NULL,
  sort_order INTEGER,
  PRIMARY KEY (collection_id, file_id),
  FOREIGN KEY (collection_id) REFERENCES collections(id) ON DELETE CASCADE,
  FOREIGN KEY (file_id) REFERENCES files(id) ON DELETE CASCADE
);

CREATE INDEX IF NOT EXISTS idx_collection_files_collection ON collection_files(collection_id);
CREATE INDEX IF NOT EXISTS idx_collection_files_file ON collection_files(file_id);

-- Kickchains (special composite files)
CREATE TABLE IF NOT EXISTS kickchains (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  bpm REAL,
  notes TEXT,
  created_at INTEGER NOT NULL
);

CREATE TABLE IF NOT EXISTS kickchain_layers (
  kickchain_id INTEGER NOT NULL,
  file_id INTEGER NOT NULL,
  layer_order INTEGER NOT NULL,
  volume REAL DEFAULT 1.0 CHECK(volume >= 0 AND volume <= 2.0),
  notes TEXT,
  PRIMARY KEY (kickchain_id, layer_order),
  FOREIGN KEY (kickchain_id) REFERENCES kickchains(id) ON DELETE CASCADE,
  FOREIGN KEY (file_id) REFERENCES files(id) ON DELETE CASCADE
);

-- Watched folders
CREATE TABLE IF NOT EXISTS watched_folders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  folder_path TEXT UNIQUE NOT NULL,
  is_active INTEGER DEFAULT 1 CHECK(is_active IN (0, 1)),
  auto_tag_pattern TEXT,
  added_at INTEGER NOT NULL,
  last_scanned INTEGER
);

-- Search history
CREATE TABLE IF NOT EXISTS search_history (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  query TEXT NOT NULL,
  filters TEXT,
  result_count INTEGER,
  searched_at INTEGER NOT NULL
);

CREATE INDEX IF NOT EXISTS idx_search_history_date ON search_history(searched_at);

-- User preferences
CREATE TABLE IF NOT EXISTS user_preferences (
  key TEXT PRIMARY KEY,
  value TEXT NOT NULL
);

-- Insert default tag presets for harder-styles
INSERT OR IGNORE INTO tags (name, category, color, created_at) VALUES
  ('Hardstyle', 'genre', '#FF00AA', strftime('%s', 'now')),
  ('Rawstyle', 'genre', '#FF0044', strftime('%s', 'now')),
  ('Hardcore', 'genre', '#FF3366', strftime('%s', 'now')),
  ('Uptempo', 'genre', '#AA00FF', strftime('%s', 'now')),
  ('Euphoric', 'genre', '#00D4FF', strftime('%s', 'now')),

  ('Kick', 'instrument', '#FF4466', strftime('%s', 'now')),
  ('Lead', 'instrument', '#00FFDD', strftime('%s', 'now')),
  ('Screech', 'instrument', '#FF8833', strftime('%s', 'now')),
  ('Atmosphere', 'instrument', '#0088FF', strftime('%s', 'now')),
  ('Vocal', 'instrument', '#FF00CC', strftime('%s', 'now')),
  ('FX', 'instrument', '#00FF88', strftime('%s', 'now')),

  ('High Energy', 'energy', '#FF0055', strftime('%s', 'now')),
  ('Medium Energy', 'energy', '#FFAA00', strftime('%s', 'now')),
  ('Low Energy', 'energy', '#00FF88', strftime('%s', 'now'));
  `;console.log("Executing database schema...");const r=t.split(";").map(i=>i.trim()).filter(i=>i.length>0);console.log(`Total statements to execute: ${r.length}`);for(let i=0;i<r.length;i++){const a=r[i];try{Me.exec(a),console.log(`✓ Statement ${i+1}/${r.length} executed`)}catch(o){throw console.error(`✗ Error executing statement ${i+1}/${r.length}:`,o),console.error("Failed statement:",a.substring(0,100)),o}}const n=Me.prepare("SELECT name FROM sqlite_master WHERE type='table'").all();return console.log("Created tables:",n.map(i=>i.name).join(", ")),console.log("Database initialized successfully"),Me}function Dd(){return Me||Od()}function Pd(e,t){const r=Dd(),n=Object.keys(t).filter(s=>s!=="id");if(n.length===0)return;const a=`UPDATE files SET ${n.map(s=>`${s} = @${s}`).join(", ")} WHERE id = @id`;r.prepare(a).run({...t,id:e})}let Pi;const Ml=async()=>(Pi||(Pi=(await import("music-metadata")).parseFile),Pi);function Fd(e){if(!e)return;const t=e.match(/^([A-G][#b]?)/);return t?t[1]:void 0}function $d(e){if(e){if(e.toLowerCase().includes("minor"))return"minor";if(e.toLowerCase().includes("major"))return"major"}}function Ld(e){const t=e.common.bpm;if(t)return t>=180?10:t>=170?9:t>=160?8:t>=155?7:t>=150?6:t>=145?5:t>=140?4:t>=130?3:t>=120?2:1}async function xd(e){try{const r=await(await Ml())(e,{duration:!0,skipCovers:!0});return{duration:r.format.duration,sample_rate:r.format.sampleRate,bit_depth:r.format.bitsPerSample,channels:r.format.numberOfChannels,bpm:r.common.bpm,detected_key:Fd(r.common.key),detected_scale:$d(r.common.key)}}catch(t){return console.error(`Error analyzing audio file ${e}:`,t),null}}async function Bl(e,t){try{const r=await xd(t);if(!r)return!1;const i=await(await Ml())(t,{duration:!0,skipCovers:!0}),a=Ld(i);return Pd(e,{duration:r.duration,sample_rate:r.sample_rate,bit_depth:r.bit_depth,channels:r.channels,bpm:r.bpm,detected_key:r.detected_key,detected_scale:r.detected_scale,energy_level:a}),!0}catch(r){return console.error(`Error analyzing and updating file ${e}:`,r),!1}}async function Ud(e,t){const r={success:0,failed:0};for(let n=0;n<e.length;n++){const i=e[n];if(t){const o=i.file_path.split(/[\\/]/).pop()||"";t(n+1,e.length,o)}await Bl(i.id,i.file_path)?r.success++:r.failed++}return r}var Re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Le={},Ht={},De={};De.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((r,n)=>{t.push((i,a)=>i!=null?n(i):r(a)),e.apply(this,t)})},"name",{value:e.name})};De.fromPromise=function(e){return Object.defineProperty(function(...t){const r=t[t.length-1];if(typeof r!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(n=>r(null,n),r)},"name",{value:e.name})};var dt=dd,kd=process.cwd,Ln=null,Md=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Ln||(Ln=kd.call(process)),Ln};try{process.cwd()}catch{}if(typeof process.chdir=="function"){var Fo=process.chdir;process.chdir=function(e){Ln=null,Fo.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Fo)}var Bd=Hd;function Hd(e){dt.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=a(e.chown),e.fchown=a(e.fchown),e.lchown=a(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=o(e.chownSync),e.fchownSync=o(e.fchownSync),e.lchownSync=o(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=s(e.stat),e.fstat=s(e.fstat),e.lstat=s(e.lstat),e.statSync=l(e.statSync),e.fstatSync=l(e.fstatSync),e.lstatSync=l(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(c,f,d){d&&process.nextTick(d)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(c,f,d,m){m&&process.nextTick(m)},e.lchownSync=function(){}),Md==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(c){function f(d,m,w){var E=Date.now(),T=0;c(d,m,function S(A){if(A&&(A.code==="EACCES"||A.code==="EPERM"||A.code==="EBUSY")&&Date.now()-E<6e4){setTimeout(function(){e.stat(m,function($,P){$&&$.code==="ENOENT"?c(d,m,S):w(A)})},T),T<100&&(T+=10);return}w&&w(A)})}return Object.setPrototypeOf&&Object.setPrototypeOf(f,c),f}(e.rename)),e.read=typeof e.read!="function"?e.read:function(c){function f(d,m,w,E,T,S){var A;if(S&&typeof S=="function"){var $=0;A=function(P,J,ne){if(P&&P.code==="EAGAIN"&&$<10)return $++,c.call(e,d,m,w,E,T,A);S.apply(this,arguments)}}return c.call(e,d,m,w,E,T,A)}return Object.setPrototypeOf&&Object.setPrototypeOf(f,c),f}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(c){return function(f,d,m,w,E){for(var T=0;;)try{return c.call(e,f,d,m,w,E)}catch(S){if(S.code==="EAGAIN"&&T<10){T++;continue}throw S}}}(e.readSync);function t(c){c.lchmod=function(f,d,m){c.open(f,dt.O_WRONLY|dt.O_SYMLINK,d,function(w,E){if(w){m&&m(w);return}c.fchmod(E,d,function(T){c.close(E,function(S){m&&m(T||S)})})})},c.lchmodSync=function(f,d){var m=c.openSync(f,dt.O_WRONLY|dt.O_SYMLINK,d),w=!0,E;try{E=c.fchmodSync(m,d),w=!1}finally{if(w)try{c.closeSync(m)}catch{}else c.closeSync(m)}return E}}function r(c){dt.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(f,d,m,w){c.open(f,dt.O_SYMLINK,function(E,T){if(E){w&&w(E);return}c.futimes(T,d,m,function(S){c.close(T,function(A){w&&w(S||A)})})})},c.lutimesSync=function(f,d,m){var w=c.openSync(f,dt.O_SYMLINK),E,T=!0;try{E=c.futimesSync(w,d,m),T=!1}finally{if(T)try{c.closeSync(w)}catch{}else c.closeSync(w)}return E}):c.futimes&&(c.lutimes=function(f,d,m,w){w&&process.nextTick(w)},c.lutimesSync=function(){})}function n(c){return c&&function(f,d,m){return c.call(e,f,d,function(w){h(w)&&(w=null),m&&m.apply(this,arguments)})}}function i(c){return c&&function(f,d){try{return c.call(e,f,d)}catch(m){if(!h(m))throw m}}}function a(c){return c&&function(f,d,m,w){return c.call(e,f,d,m,function(E){h(E)&&(E=null),w&&w.apply(this,arguments)})}}function o(c){return c&&function(f,d,m){try{return c.call(e,f,d,m)}catch(w){if(!h(w))throw w}}}function s(c){return c&&function(f,d,m){typeof d=="function"&&(m=d,d=null);function w(E,T){T&&(T.uid<0&&(T.uid+=4294967296),T.gid<0&&(T.gid+=4294967296)),m&&m.apply(this,arguments)}return d?c.call(e,f,d,w):c.call(e,f,w)}}function l(c){return c&&function(f,d){var m=d?c.call(e,f,d):c.call(e,f);return m&&(m.uid<0&&(m.uid+=4294967296),m.gid<0&&(m.gid+=4294967296)),m}}function h(c){if(!c||c.code==="ENOSYS")return!0;var f=!process.getuid||process.getuid()!==0;return!!(f&&(c.code==="EINVAL"||c.code==="EPERM"))}}var $o=zr.Stream,jd=Gd;function Gd(e){return{ReadStream:t,WriteStream:r};function t(n,i){if(!(this instanceof t))return new t(n,i);$o.call(this);var a=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var o=Object.keys(i),s=0,l=o.length;s<l;s++){var h=o[s];this[h]=i[h]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){a._read()});return}e.open(this.path,this.flags,this.mode,function(c,f){if(c){a.emit("error",c),a.readable=!1;return}a.fd=f,a.emit("open",f),a._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);$o.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var a=Object.keys(i),o=0,s=a.length;o<s;o++){var l=a[o];this[l]=i[l]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}var qd=Wd,Vd=Object.getPrototypeOf||function(e){return e.__proto__};function Wd(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:Vd(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}var ae=ue,Xd=Bd,Yd=jd,zd=qd,yn=Oa,we,Mn;typeof Symbol=="function"&&typeof Symbol.for=="function"?(we=Symbol.for("graceful-fs.queue"),Mn=Symbol.for("graceful-fs.previous")):(we="___graceful-fs.queue",Mn="___graceful-fs.previous");function Kd(){}function Hl(e,t){Object.defineProperty(e,we,{get:function(){return t}})}var xt=Kd;yn.debuglog?xt=yn.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(xt=function(){var e=yn.format.apply(yn,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});if(!ae[we]){var Jd=Re[we]||[];Hl(ae,Jd),ae.close=function(e){function t(r,n){return e.call(ae,r,function(i){i||Lo(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Mn,{value:e}),t}(ae.close),ae.closeSync=function(e){function t(r){e.apply(ae,arguments),Lo()}return Object.defineProperty(t,Mn,{value:e}),t}(ae.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){xt(ae[we]),Ol.equal(ae[we].length,0)})}Re[we]||Hl(Re,ae[we]);var Pe=Pa(zd(ae));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!ae.__patched&&(Pe=Pa(ae),ae.__patched=!0);function Pa(e){Xd(e),e.gracefulify=Pa,e.createReadStream=J,e.createWriteStream=ne;var t=e.readFile;e.readFile=r;function r(y,q,H){return typeof q=="function"&&(H=q,q=null),B(y,q,H);function B(Q,I,b,F){return t(Q,I,function(N){N&&(N.code==="EMFILE"||N.code==="ENFILE")?Wt([B,[Q,I,b],N,F||Date.now(),Date.now()]):typeof b=="function"&&b.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=i;function i(y,q,H,B){return typeof H=="function"&&(B=H,H=null),Q(y,q,H,B);function Q(I,b,F,N,L){return n(I,b,F,function(O){O&&(O.code==="EMFILE"||O.code==="ENFILE")?Wt([Q,[I,b,F,N],O,L||Date.now(),Date.now()]):typeof N=="function"&&N.apply(this,arguments)})}}var a=e.appendFile;a&&(e.appendFile=o);function o(y,q,H,B){return typeof H=="function"&&(B=H,H=null),Q(y,q,H,B);function Q(I,b,F,N,L){return a(I,b,F,function(O){O&&(O.code==="EMFILE"||O.code==="ENFILE")?Wt([Q,[I,b,F,N],O,L||Date.now(),Date.now()]):typeof N=="function"&&N.apply(this,arguments)})}}var s=e.copyFile;s&&(e.copyFile=l);function l(y,q,H,B){return typeof H=="function"&&(B=H,H=0),Q(y,q,H,B);function Q(I,b,F,N,L){return s(I,b,F,function(O){O&&(O.code==="EMFILE"||O.code==="ENFILE")?Wt([Q,[I,b,F,N],O,L||Date.now(),Date.now()]):typeof N=="function"&&N.apply(this,arguments)})}}var h=e.readdir;e.readdir=f;var c=/^v[0-5]\./;function f(y,q,H){typeof q=="function"&&(H=q,q=null);var B=c.test(process.version)?function(b,F,N,L){return h(b,Q(b,F,N,L))}:function(b,F,N,L){return h(b,F,Q(b,F,N,L))};return B(y,q,H);function Q(I,b,F,N){return function(L,O){L&&(L.code==="EMFILE"||L.code==="ENFILE")?Wt([B,[I,b,F],L,N||Date.now(),Date.now()]):(O&&O.sort&&O.sort(),typeof F=="function"&&F.call(this,L,O))}}}if(process.version.substr(0,4)==="v0.8"){var d=Yd(e);S=d.ReadStream,$=d.WriteStream}var m=e.ReadStream;m&&(S.prototype=Object.create(m.prototype),S.prototype.open=A);var w=e.WriteStream;w&&($.prototype=Object.create(w.prototype),$.prototype.open=P),Object.defineProperty(e,"ReadStream",{get:function(){return S},set:function(y){S=y},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return $},set:function(y){$=y},enumerable:!0,configurable:!0});var E=S;Object.defineProperty(e,"FileReadStream",{get:function(){return E},set:function(y){E=y},enumerable:!0,configurable:!0});var T=$;Object.defineProperty(e,"FileWriteStream",{get:function(){return T},set:function(y){T=y},enumerable:!0,configurable:!0});function S(y,q){return this instanceof S?(m.apply(this,arguments),this):S.apply(Object.create(S.prototype),arguments)}function A(){var y=this;Ce(y.path,y.flags,y.mode,function(q,H){q?(y.autoClose&&y.destroy(),y.emit("error",q)):(y.fd=H,y.emit("open",H),y.read())})}function $(y,q){return this instanceof $?(w.apply(this,arguments),this):$.apply(Object.create($.prototype),arguments)}function P(){var y=this;Ce(y.path,y.flags,y.mode,function(q,H){q?(y.destroy(),y.emit("error",q)):(y.fd=H,y.emit("open",H))})}function J(y,q){return new e.ReadStream(y,q)}function ne(y,q){return new e.WriteStream(y,q)}var X=e.open;e.open=Ce;function Ce(y,q,H,B){return typeof H=="function"&&(B=H,H=null),Q(y,q,H,B);function Q(I,b,F,N,L){return X(I,b,F,function(O,M){O&&(O.code==="EMFILE"||O.code==="ENFILE")?Wt([Q,[I,b,F,N],O,L||Date.now(),Date.now()]):typeof N=="function"&&N.apply(this,arguments)})}}return e}function Wt(e){xt("ENQUEUE",e[0].name,e[1]),ae[we].push(e),Fa()}var wn;function Lo(){for(var e=Date.now(),t=0;t<ae[we].length;++t)ae[we][t].length>2&&(ae[we][t][3]=e,ae[we][t][4]=e);Fa()}function Fa(){if(clearTimeout(wn),wn=void 0,ae[we].length!==0){var e=ae[we].shift(),t=e[0],r=e[1],n=e[2],i=e[3],a=e[4];if(i===void 0)xt("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){xt("TIMEOUT",t.name,r);var o=r.pop();typeof o=="function"&&o.call(null,n)}else{var s=Date.now()-a,l=Math.max(a-i,1),h=Math.min(l*1.2,100);s>=h?(xt("RETRY",t.name,r),t.apply(null,r.concat([i]))):ae[we].push(e)}wn===void 0&&(wn=setTimeout(Fa,0))}}(function(e){const t=De.fromCallback,r=Pe,n=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(i=>typeof r[i]=="function");Object.assign(e,r),n.forEach(i=>{e[i]=t(r[i])}),e.exists=function(i,a){return typeof a=="function"?r.exists(i,a):new Promise(o=>r.exists(i,o))},e.read=function(i,a,o,s,l,h){return typeof h=="function"?r.read(i,a,o,s,l,h):new Promise((c,f)=>{r.read(i,a,o,s,l,(d,m,w)=>{if(d)return f(d);c({bytesRead:m,buffer:w})})})},e.write=function(i,a,...o){return typeof o[o.length-1]=="function"?r.write(i,a,...o):new Promise((s,l)=>{r.write(i,a,...o,(h,c,f)=>{if(h)return l(h);s({bytesWritten:c,buffer:f})})})},typeof r.writev=="function"&&(e.writev=function(i,a,...o){return typeof o[o.length-1]=="function"?r.writev(i,a,...o):new Promise((s,l)=>{r.writev(i,a,...o,(h,c,f)=>{if(h)return l(h);s({bytesWritten:c,buffers:f})})})}),typeof r.realpath.native=="function"?e.realpath.native=t(r.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")})(Ht);var $a={},jl={};const Qd=V;jl.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Qd.parse(t).root,""))){const n=new Error(`Path contains invalid characters: ${t}`);throw n.code="EINVAL",n}};const Gl=Ht,{checkPath:ql}=jl,Vl=e=>{const t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};$a.makeDir=async(e,t)=>(ql(e),Gl.mkdir(e,{mode:Vl(t),recursive:!0}));$a.makeDirSync=(e,t)=>(ql(e),Gl.mkdirSync(e,{mode:Vl(t),recursive:!0}));const Zd=De.fromPromise,{makeDir:eh,makeDirSync:Fi}=$a,$i=Zd(eh);var rt={mkdirs:$i,mkdirsSync:Fi,mkdirp:$i,mkdirpSync:Fi,ensureDir:$i,ensureDirSync:Fi};const th=De.fromPromise,Wl=Ht;function rh(e){return Wl.access(e).then(()=>!0).catch(()=>!1)}var jt={pathExists:th(rh),pathExistsSync:Wl.existsSync};const ar=Pe;function nh(e,t,r,n){ar.open(e,"r+",(i,a)=>{if(i)return n(i);ar.futimes(a,t,r,o=>{ar.close(a,s=>{n&&n(o||s)})})})}function ih(e,t,r){const n=ar.openSync(e,"r+");return ar.futimesSync(n,t,r),ar.closeSync(n)}var Xl={utimesMillis:nh,utimesMillisSync:ih};const cr=Ht,ge=V,ah=Oa;function oh(e,t,r){const n=r.dereference?i=>cr.stat(i,{bigint:!0}):i=>cr.lstat(i,{bigint:!0});return Promise.all([n(e),n(t).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,a])=>({srcStat:i,destStat:a}))}function sh(e,t,r){let n;const i=r.dereference?o=>cr.statSync(o,{bigint:!0}):o=>cr.lstatSync(o,{bigint:!0}),a=i(e);try{n=i(t)}catch(o){if(o.code==="ENOENT")return{srcStat:a,destStat:null};throw o}return{srcStat:a,destStat:n}}function lh(e,t,r,n,i){ah.callbackify(oh)(e,t,n,(a,o)=>{if(a)return i(a);const{srcStat:s,destStat:l}=o;if(l){if(Kr(s,l)){const h=ge.basename(e),c=ge.basename(t);return r==="move"&&h!==c&&h.toLowerCase()===c.toLowerCase()?i(null,{srcStat:s,destStat:l,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(s.isDirectory()&&!l.isDirectory())return i(new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`));if(!s.isDirectory()&&l.isDirectory())return i(new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`))}return s.isDirectory()&&La(e,t)?i(new Error(ti(e,t,r))):i(null,{srcStat:s,destStat:l})})}function ch(e,t,r,n){const{srcStat:i,destStat:a}=sh(e,t,n);if(a){if(Kr(i,a)){const o=ge.basename(e),s=ge.basename(t);if(r==="move"&&o!==s&&o.toLowerCase()===s.toLowerCase())return{srcStat:i,destStat:a,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!a.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!i.isDirectory()&&a.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(i.isDirectory()&&La(e,t))throw new Error(ti(e,t,r));return{srcStat:i,destStat:a}}function Yl(e,t,r,n,i){const a=ge.resolve(ge.dirname(e)),o=ge.resolve(ge.dirname(r));if(o===a||o===ge.parse(o).root)return i();cr.stat(o,{bigint:!0},(s,l)=>s?s.code==="ENOENT"?i():i(s):Kr(t,l)?i(new Error(ti(e,r,n))):Yl(e,t,o,n,i))}function zl(e,t,r,n){const i=ge.resolve(ge.dirname(e)),a=ge.resolve(ge.dirname(r));if(a===i||a===ge.parse(a).root)return;let o;try{o=cr.statSync(a,{bigint:!0})}catch(s){if(s.code==="ENOENT")return;throw s}if(Kr(t,o))throw new Error(ti(e,r,n));return zl(e,t,a,n)}function Kr(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function La(e,t){const r=ge.resolve(e).split(ge.sep).filter(i=>i),n=ge.resolve(t).split(ge.sep).filter(i=>i);return r.reduce((i,a,o)=>i&&n[o]===a,!0)}function ti(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}var pr={checkPaths:lh,checkPathsSync:ch,checkParentPaths:Yl,checkParentPathsSync:zl,isSrcSubdir:La,areIdentical:Kr};const xe=Pe,$r=V,uh=rt.mkdirs,fh=jt.pathExists,dh=Xl.utimesMillis,Lr=pr;function hh(e,t,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),Lr.checkPaths(e,t,"copy",r,(i,a)=>{if(i)return n(i);const{srcStat:o,destStat:s}=a;Lr.checkParentPaths(e,o,t,"copy",l=>l?n(l):r.filter?Kl(xo,s,e,t,r,n):xo(s,e,t,r,n))})}function xo(e,t,r,n,i){const a=$r.dirname(r);fh(a,(o,s)=>{if(o)return i(o);if(s)return Bn(e,t,r,n,i);uh(a,l=>l?i(l):Bn(e,t,r,n,i))})}function Kl(e,t,r,n,i,a){Promise.resolve(i.filter(r,n)).then(o=>o?e(t,r,n,i,a):a(),o=>a(o))}function ph(e,t,r,n,i){return n.filter?Kl(Bn,e,t,r,n,i):Bn(e,t,r,n,i)}function Bn(e,t,r,n,i){(n.dereference?xe.stat:xe.lstat)(t,(o,s)=>o?i(o):s.isDirectory()?vh(s,e,t,r,n,i):s.isFile()||s.isCharacterDevice()||s.isBlockDevice()?mh(s,e,t,r,n,i):s.isSymbolicLink()?Sh(e,t,r,n,i):s.isSocket()?i(new Error(`Cannot copy a socket file: ${t}`)):s.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${t}`)):i(new Error(`Unknown file: ${t}`)))}function mh(e,t,r,n,i,a){return t?gh(e,r,n,i,a):Jl(e,r,n,i,a)}function gh(e,t,r,n,i){if(n.overwrite)xe.unlink(r,a=>a?i(a):Jl(e,t,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function Jl(e,t,r,n,i){xe.copyFile(t,r,a=>a?i(a):n.preserveTimestamps?Eh(e.mode,t,r,i):ri(r,e.mode,i))}function Eh(e,t,r,n){return yh(e)?wh(r,e,i=>i?n(i):Uo(e,t,r,n)):Uo(e,t,r,n)}function yh(e){return(e&128)===0}function wh(e,t,r){return ri(e,t|128,r)}function Uo(e,t,r,n){_h(t,r,i=>i?n(i):ri(r,e,n))}function ri(e,t,r){return xe.chmod(e,t,r)}function _h(e,t,r){xe.stat(e,(n,i)=>n?r(n):dh(t,i.atime,i.mtime,r))}function vh(e,t,r,n,i,a){return t?Ql(r,n,i,a):Th(e.mode,r,n,i,a)}function Th(e,t,r,n,i){xe.mkdir(r,a=>{if(a)return i(a);Ql(t,r,n,o=>o?i(o):ri(r,e,i))})}function Ql(e,t,r,n){xe.readdir(e,(i,a)=>i?n(i):Zl(a,e,t,r,n))}function Zl(e,t,r,n,i){const a=e.pop();return a?Ah(e,a,t,r,n,i):i()}function Ah(e,t,r,n,i,a){const o=$r.join(r,t),s=$r.join(n,t);Lr.checkPaths(o,s,"copy",i,(l,h)=>{if(l)return a(l);const{destStat:c}=h;ph(c,o,s,i,f=>f?a(f):Zl(e,r,n,i,a))})}function Sh(e,t,r,n,i){xe.readlink(t,(a,o)=>{if(a)return i(a);if(n.dereference&&(o=$r.resolve(process.cwd(),o)),e)xe.readlink(r,(s,l)=>s?s.code==="EINVAL"||s.code==="UNKNOWN"?xe.symlink(o,r,i):i(s):(n.dereference&&(l=$r.resolve(process.cwd(),l)),Lr.isSrcSubdir(o,l)?i(new Error(`Cannot copy '${o}' to a subdirectory of itself, '${l}'.`)):e.isDirectory()&&Lr.isSrcSubdir(l,o)?i(new Error(`Cannot overwrite '${l}' with '${o}'.`)):Ch(o,r,i)));else return xe.symlink(o,r,i)})}function Ch(e,t,r){xe.unlink(t,n=>n?r(n):xe.symlink(e,t,r))}var Nh=hh;const Ae=Pe,xr=V,bh=rt.mkdirsSync,Rh=Xl.utimesMillisSync,Ur=pr;function Ih(e,t,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");const{srcStat:n,destStat:i}=Ur.checkPathsSync(e,t,"copy",r);return Ur.checkParentPathsSync(e,n,t,"copy"),Oh(i,e,t,r)}function Oh(e,t,r,n){if(n.filter&&!n.filter(t,r))return;const i=xr.dirname(r);return Ae.existsSync(i)||bh(i),ec(e,t,r,n)}function Dh(e,t,r,n){if(!(n.filter&&!n.filter(t,r)))return ec(e,t,r,n)}function ec(e,t,r,n){const a=(n.dereference?Ae.statSync:Ae.lstatSync)(t);if(a.isDirectory())return kh(a,e,t,r,n);if(a.isFile()||a.isCharacterDevice()||a.isBlockDevice())return Ph(a,e,t,r,n);if(a.isSymbolicLink())return Hh(e,t,r,n);throw a.isSocket()?new Error(`Cannot copy a socket file: ${t}`):a.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Ph(e,t,r,n,i){return t?Fh(e,r,n,i):tc(e,r,n,i)}function Fh(e,t,r,n){if(n.overwrite)return Ae.unlinkSync(r),tc(e,t,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function tc(e,t,r,n){return Ae.copyFileSync(t,r),n.preserveTimestamps&&$h(e.mode,t,r),xa(r,e.mode)}function $h(e,t,r){return Lh(e)&&xh(r,e),Uh(t,r)}function Lh(e){return(e&128)===0}function xh(e,t){return xa(e,t|128)}function xa(e,t){return Ae.chmodSync(e,t)}function Uh(e,t){const r=Ae.statSync(e);return Rh(t,r.atime,r.mtime)}function kh(e,t,r,n,i){return t?rc(r,n,i):Mh(e.mode,r,n,i)}function Mh(e,t,r,n){return Ae.mkdirSync(r),rc(t,r,n),xa(r,e)}function rc(e,t,r){Ae.readdirSync(e).forEach(n=>Bh(n,e,t,r))}function Bh(e,t,r,n){const i=xr.join(t,e),a=xr.join(r,e),{destStat:o}=Ur.checkPathsSync(i,a,"copy",n);return Dh(o,i,a,n)}function Hh(e,t,r,n){let i=Ae.readlinkSync(t);if(n.dereference&&(i=xr.resolve(process.cwd(),i)),e){let a;try{a=Ae.readlinkSync(r)}catch(o){if(o.code==="EINVAL"||o.code==="UNKNOWN")return Ae.symlinkSync(i,r);throw o}if(n.dereference&&(a=xr.resolve(process.cwd(),a)),Ur.isSrcSubdir(i,a))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${a}'.`);if(Ae.statSync(r).isDirectory()&&Ur.isSrcSubdir(a,i))throw new Error(`Cannot overwrite '${a}' with '${i}'.`);return jh(i,r)}else return Ae.symlinkSync(i,r)}function jh(e,t){return Ae.unlinkSync(t),Ae.symlinkSync(e,t)}var Gh=Ih;const qh=De.fromCallback;var Ua={copy:qh(Nh),copySync:Gh};const ko=Pe,nc=V,ee=Ol,kr=process.platform==="win32";function ic(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{e[r]=e[r]||ko[r],r=r+"Sync",e[r]=e[r]||ko[r]}),e.maxBusyTries=e.maxBusyTries||3}function ka(e,t,r){let n=0;typeof t=="function"&&(r=t,t={}),ee(e,"rimraf: missing path"),ee.strictEqual(typeof e,"string","rimraf: path should be a string"),ee.strictEqual(typeof r,"function","rimraf: callback function required"),ee(t,"rimraf: invalid options argument provided"),ee.strictEqual(typeof t,"object","rimraf: options should be object"),ic(t),Mo(e,t,function i(a){if(a){if((a.code==="EBUSY"||a.code==="ENOTEMPTY"||a.code==="EPERM")&&n<t.maxBusyTries){n++;const o=n*100;return setTimeout(()=>Mo(e,t,i),o)}a.code==="ENOENT"&&(a=null)}r(a)})}function Mo(e,t,r){ee(e),ee(t),ee(typeof r=="function"),t.lstat(e,(n,i)=>{if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&kr)return Bo(e,t,n,r);if(i&&i.isDirectory())return xn(e,t,n,r);t.unlink(e,a=>{if(a){if(a.code==="ENOENT")return r(null);if(a.code==="EPERM")return kr?Bo(e,t,a,r):xn(e,t,a,r);if(a.code==="EISDIR")return xn(e,t,a,r)}return r(a)})})}function Bo(e,t,r,n){ee(e),ee(t),ee(typeof n=="function"),t.chmod(e,438,i=>{i?n(i.code==="ENOENT"?null:r):t.stat(e,(a,o)=>{a?n(a.code==="ENOENT"?null:r):o.isDirectory()?xn(e,t,r,n):t.unlink(e,n)})})}function Ho(e,t,r){let n;ee(e),ee(t);try{t.chmodSync(e,438)}catch(i){if(i.code==="ENOENT")return;throw r}try{n=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?Un(e,t,r):t.unlinkSync(e)}function xn(e,t,r,n){ee(e),ee(t),ee(typeof n=="function"),t.rmdir(e,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?Vh(e,t,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function Vh(e,t,r){ee(e),ee(t),ee(typeof r=="function"),t.readdir(e,(n,i)=>{if(n)return r(n);let a=i.length,o;if(a===0)return t.rmdir(e,r);i.forEach(s=>{ka(nc.join(e,s),t,l=>{if(!o){if(l)return r(o=l);--a===0&&t.rmdir(e,r)}})})})}function ac(e,t){let r;t=t||{},ic(t),ee(e,"rimraf: missing path"),ee.strictEqual(typeof e,"string","rimraf: path should be a string"),ee(t,"rimraf: missing options"),ee.strictEqual(typeof t,"object","rimraf: options should be object");try{r=t.lstatSync(e)}catch(n){if(n.code==="ENOENT")return;n.code==="EPERM"&&kr&&Ho(e,t,n)}try{r&&r.isDirectory()?Un(e,t,null):t.unlinkSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="EPERM")return kr?Ho(e,t,n):Un(e,t,n);if(n.code!=="EISDIR")throw n;Un(e,t,n)}}function Un(e,t,r){ee(e),ee(t);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOTDIR")throw r;if(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")Wh(e,t);else if(n.code!=="ENOENT")throw n}}function Wh(e,t){if(ee(e),ee(t),t.readdirSync(e).forEach(r=>ac(nc.join(e,r),t)),kr){const r=Date.now();do try{return t.rmdirSync(e,t)}catch{}while(Date.now()-r<500)}else return t.rmdirSync(e,t)}var Xh=ka;ka.sync=ac;const Hn=Pe,Yh=De.fromCallback,oc=Xh;function zh(e,t){if(Hn.rm)return Hn.rm(e,{recursive:!0,force:!0},t);oc(e,t)}function Kh(e){if(Hn.rmSync)return Hn.rmSync(e,{recursive:!0,force:!0});oc.sync(e)}var ni={remove:Yh(zh),removeSync:Kh};const Jh=De.fromPromise,sc=Ht,lc=V,cc=rt,uc=ni,jo=Jh(async function(t){let r;try{r=await sc.readdir(t)}catch{return cc.mkdirs(t)}return Promise.all(r.map(n=>uc.remove(lc.join(t,n))))});function Go(e){let t;try{t=sc.readdirSync(e)}catch{return cc.mkdirsSync(e)}t.forEach(r=>{r=lc.join(e,r),uc.removeSync(r)})}var Qh={emptyDirSync:Go,emptydirSync:Go,emptyDir:jo,emptydir:jo};const Zh=De.fromCallback,fc=V,mt=Pe,dc=rt;function ep(e,t){function r(){mt.writeFile(e,"",n=>{if(n)return t(n);t()})}mt.stat(e,(n,i)=>{if(!n&&i.isFile())return t();const a=fc.dirname(e);mt.stat(a,(o,s)=>{if(o)return o.code==="ENOENT"?dc.mkdirs(a,l=>{if(l)return t(l);r()}):t(o);s.isDirectory()?r():mt.readdir(a,l=>{if(l)return t(l)})})})}function tp(e){let t;try{t=mt.statSync(e)}catch{}if(t&&t.isFile())return;const r=fc.dirname(e);try{mt.statSync(r).isDirectory()||mt.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")dc.mkdirsSync(r);else throw n}mt.writeFileSync(e,"")}var rp={createFile:Zh(ep),createFileSync:tp};const np=De.fromCallback,hc=V,pt=Pe,pc=rt,ip=jt.pathExists,{areIdentical:mc}=pr;function ap(e,t,r){function n(i,a){pt.link(i,a,o=>{if(o)return r(o);r(null)})}pt.lstat(t,(i,a)=>{pt.lstat(e,(o,s)=>{if(o)return o.message=o.message.replace("lstat","ensureLink"),r(o);if(a&&mc(s,a))return r(null);const l=hc.dirname(t);ip(l,(h,c)=>{if(h)return r(h);if(c)return n(e,t);pc.mkdirs(l,f=>{if(f)return r(f);n(e,t)})})})})}function op(e,t){let r;try{r=pt.lstatSync(t)}catch{}try{const a=pt.lstatSync(e);if(r&&mc(a,r))return}catch(a){throw a.message=a.message.replace("lstat","ensureLink"),a}const n=hc.dirname(t);return pt.existsSync(n)||pc.mkdirsSync(n),pt.linkSync(e,t)}var sp={createLink:np(ap),createLinkSync:op};const gt=V,Or=Pe,lp=jt.pathExists;function cp(e,t,r){if(gt.isAbsolute(e))return Or.lstat(e,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:e,toDst:e}));{const n=gt.dirname(t),i=gt.join(n,e);return lp(i,(a,o)=>a?r(a):o?r(null,{toCwd:i,toDst:e}):Or.lstat(e,s=>s?(s.message=s.message.replace("lstat","ensureSymlink"),r(s)):r(null,{toCwd:e,toDst:gt.relative(n,e)})))}}function up(e,t){let r;if(gt.isAbsolute(e)){if(r=Or.existsSync(e),!r)throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}else{const n=gt.dirname(t),i=gt.join(n,e);if(r=Or.existsSync(i),r)return{toCwd:i,toDst:e};if(r=Or.existsSync(e),!r)throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:gt.relative(n,e)}}}var fp={symlinkPaths:cp,symlinkPathsSync:up};const gc=Pe;function dp(e,t,r){if(r=typeof t=="function"?t:r,t=typeof t=="function"?!1:t,t)return r(null,t);gc.lstat(e,(n,i)=>{if(n)return r(null,"file");t=i&&i.isDirectory()?"dir":"file",r(null,t)})}function hp(e,t){let r;if(t)return t;try{r=gc.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}var pp={symlinkType:dp,symlinkTypeSync:hp};const mp=De.fromCallback,Ec=V,We=Ht,yc=rt,gp=yc.mkdirs,Ep=yc.mkdirsSync,wc=fp,yp=wc.symlinkPaths,wp=wc.symlinkPathsSync,_c=pp,_p=_c.symlinkType,vp=_c.symlinkTypeSync,Tp=jt.pathExists,{areIdentical:vc}=pr;function Ap(e,t,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,We.lstat(t,(i,a)=>{!i&&a.isSymbolicLink()?Promise.all([We.stat(e),We.stat(t)]).then(([o,s])=>{if(vc(o,s))return n(null);qo(e,t,r,n)}):qo(e,t,r,n)})}function qo(e,t,r,n){yp(e,t,(i,a)=>{if(i)return n(i);e=a.toDst,_p(a.toCwd,r,(o,s)=>{if(o)return n(o);const l=Ec.dirname(t);Tp(l,(h,c)=>{if(h)return n(h);if(c)return We.symlink(e,t,s,n);gp(l,f=>{if(f)return n(f);We.symlink(e,t,s,n)})})})})}function Sp(e,t,r){let n;try{n=We.lstatSync(t)}catch{}if(n&&n.isSymbolicLink()){const s=We.statSync(e),l=We.statSync(t);if(vc(s,l))return}const i=wp(e,t);e=i.toDst,r=vp(i.toCwd,r);const a=Ec.dirname(t);return We.existsSync(a)||Ep(a),We.symlinkSync(e,t,r)}var Cp={createSymlink:mp(Ap),createSymlinkSync:Sp};const{createFile:Vo,createFileSync:Wo}=rp,{createLink:Xo,createLinkSync:Yo}=sp,{createSymlink:zo,createSymlinkSync:Ko}=Cp;var Np={createFile:Vo,createFileSync:Wo,ensureFile:Vo,ensureFileSync:Wo,createLink:Xo,createLinkSync:Yo,ensureLink:Xo,ensureLinkSync:Yo,createSymlink:zo,createSymlinkSync:Ko,ensureSymlink:zo,ensureSymlinkSync:Ko};function bp(e,{EOL:t=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){const a=r?t:"";return JSON.stringify(e,n,i).replace(/\n/g,t)+a}function Rp(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}var Ma={stringify:bp,stripBom:Rp};let ur;try{ur=Pe}catch{ur=ue}const ii=De,{stringify:Tc,stripBom:Ac}=Ma;async function Ip(e,t={}){typeof t=="string"&&(t={encoding:t});const r=t.fs||ur,n="throws"in t?t.throws:!0;let i=await ii.fromCallback(r.readFile)(e,t);i=Ac(i);let a;try{a=JSON.parse(i,t?t.reviver:null)}catch(o){if(n)throw o.message=`${e}: ${o.message}`,o;return null}return a}const Op=ii.fromPromise(Ip);function Dp(e,t={}){typeof t=="string"&&(t={encoding:t});const r=t.fs||ur,n="throws"in t?t.throws:!0;try{let i=r.readFileSync(e,t);return i=Ac(i),JSON.parse(i,t.reviver)}catch(i){if(n)throw i.message=`${e}: ${i.message}`,i;return null}}async function Pp(e,t,r={}){const n=r.fs||ur,i=Tc(t,r);await ii.fromCallback(n.writeFile)(e,i,r)}const Fp=ii.fromPromise(Pp);function $p(e,t,r={}){const n=r.fs||ur,i=Tc(t,r);return n.writeFileSync(e,i,r)}var Lp={readFile:Op,readFileSync:Dp,writeFile:Fp,writeFileSync:$p};const _n=Lp;var xp={readJson:_n.readFile,readJsonSync:_n.readFileSync,writeJson:_n.writeFile,writeJsonSync:_n.writeFileSync};const Up=De.fromCallback,Dr=Pe,Sc=V,Cc=rt,kp=jt.pathExists;function Mp(e,t,r,n){typeof r=="function"&&(n=r,r="utf8");const i=Sc.dirname(e);kp(i,(a,o)=>{if(a)return n(a);if(o)return Dr.writeFile(e,t,r,n);Cc.mkdirs(i,s=>{if(s)return n(s);Dr.writeFile(e,t,r,n)})})}function Bp(e,...t){const r=Sc.dirname(e);if(Dr.existsSync(r))return Dr.writeFileSync(e,...t);Cc.mkdirsSync(r),Dr.writeFileSync(e,...t)}var Ba={outputFile:Up(Mp),outputFileSync:Bp};const{stringify:Hp}=Ma,{outputFile:jp}=Ba;async function Gp(e,t,r={}){const n=Hp(t,r);await jp(e,n,r)}var qp=Gp;const{stringify:Vp}=Ma,{outputFileSync:Wp}=Ba;function Xp(e,t,r){const n=Vp(t,r);Wp(e,n,r)}var Yp=Xp;const zp=De.fromPromise,Oe=xp;Oe.outputJson=zp(qp);Oe.outputJsonSync=Yp;Oe.outputJSON=Oe.outputJson;Oe.outputJSONSync=Oe.outputJsonSync;Oe.writeJSON=Oe.writeJson;Oe.writeJSONSync=Oe.writeJsonSync;Oe.readJSON=Oe.readJson;Oe.readJSONSync=Oe.readJsonSync;var Kp=Oe;const Jp=Pe,pa=V,Qp=Ua.copy,Nc=ni.remove,Zp=rt.mkdirp,em=jt.pathExists,Jo=pr;function tm(e,t,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};const i=r.overwrite||r.clobber||!1;Jo.checkPaths(e,t,"move",r,(a,o)=>{if(a)return n(a);const{srcStat:s,isChangingCase:l=!1}=o;Jo.checkParentPaths(e,s,t,"move",h=>{if(h)return n(h);if(rm(t))return Qo(e,t,i,l,n);Zp(pa.dirname(t),c=>c?n(c):Qo(e,t,i,l,n))})})}function rm(e){const t=pa.dirname(e);return pa.parse(t).root===t}function Qo(e,t,r,n,i){if(n)return Li(e,t,r,i);if(r)return Nc(t,a=>a?i(a):Li(e,t,r,i));em(t,(a,o)=>a?i(a):o?i(new Error("dest already exists.")):Li(e,t,r,i))}function Li(e,t,r,n){Jp.rename(e,t,i=>i?i.code!=="EXDEV"?n(i):nm(e,t,r,n):n())}function nm(e,t,r,n){Qp(e,t,{overwrite:r,errorOnExist:!0},a=>a?n(a):Nc(e,n))}var im=tm;const bc=Pe,ma=V,am=Ua.copySync,Rc=ni.removeSync,om=rt.mkdirpSync,Zo=pr;function sm(e,t,r){r=r||{};const n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:a=!1}=Zo.checkPathsSync(e,t,"move",r);return Zo.checkParentPathsSync(e,i,t,"move"),lm(t)||om(ma.dirname(t)),cm(e,t,n,a)}function lm(e){const t=ma.dirname(e);return ma.parse(t).root===t}function cm(e,t,r,n){if(n)return xi(e,t,r);if(r)return Rc(t),xi(e,t,r);if(bc.existsSync(t))throw new Error("dest already exists.");return xi(e,t,r)}function xi(e,t,r){try{bc.renameSync(e,t)}catch(n){if(n.code!=="EXDEV")throw n;return um(e,t,r)}}function um(e,t,r){return am(e,t,{overwrite:r,errorOnExist:!0}),Rc(e)}var fm=sm;const dm=De.fromCallback;var hm={move:dm(im),moveSync:fm},St={...Ht,...Ua,...Qh,...Np,...Kp,...rt,...hm,...Ba,...jt,...ni},Gt={},yt={},he={},wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.CancellationError=wt.CancellationToken=void 0;const pm=Dl;class mm extends pm.EventEmitter{get cancelled(){return this._cancelled||this._parent!=null&&this._parent.cancelled}set parent(t){this.removeParentCancelHandler(),this._parent=t,this.parentCancelHandler=()=>this.cancel(),this._parent.onCancel(this.parentCancelHandler)}constructor(t){super(),this.parentCancelHandler=null,this._parent=null,this._cancelled=!1,t!=null&&(this.parent=t)}cancel(){this._cancelled=!0,this.emit("cancel")}onCancel(t){this.cancelled?t():this.once("cancel",t)}createPromise(t){if(this.cancelled)return Promise.reject(new ga);const r=()=>{if(n!=null)try{this.removeListener("cancel",n),n=null}catch{}};let n=null;return new Promise((i,a)=>{let o=null;if(n=()=>{try{o!=null&&(o(),o=null)}finally{a(new ga)}},this.cancelled){n();return}this.onCancel(n),t(i,a,s=>{o=s})}).then(i=>(r(),i)).catch(i=>{throw r(),i})}removeParentCancelHandler(){const t=this._parent;t!=null&&this.parentCancelHandler!=null&&(t.removeListener("cancel",this.parentCancelHandler),this.parentCancelHandler=null)}dispose(){try{this.removeParentCancelHandler()}finally{this.removeAllListeners(),this._parent=null}}}wt.CancellationToken=mm;class ga extends Error{constructor(){super("cancelled")}}wt.CancellationError=ga;var mr={};Object.defineProperty(mr,"__esModule",{value:!0});mr.newError=gm;function gm(e,t){const r=new Error(e);return r.code=t,r}var Ie={},Ea={exports:{}},vn={exports:{}},Ui,es;function Em(){if(es)return Ui;es=1;var e=1e3,t=e*60,r=t*60,n=r*24,i=n*7,a=n*365.25;Ui=function(c,f){f=f||{};var d=typeof c;if(d==="string"&&c.length>0)return o(c);if(d==="number"&&isFinite(c))return f.long?l(c):s(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function o(c){if(c=String(c),!(c.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(f){var d=parseFloat(f[1]),m=(f[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return d*a;case"weeks":case"week":case"w":return d*i;case"days":case"day":case"d":return d*n;case"hours":case"hour":case"hrs":case"hr":case"h":return d*r;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function s(c){var f=Math.abs(c);return f>=n?Math.round(c/n)+"d":f>=r?Math.round(c/r)+"h":f>=t?Math.round(c/t)+"m":f>=e?Math.round(c/e)+"s":c+"ms"}function l(c){var f=Math.abs(c);return f>=n?h(c,f,n,"day"):f>=r?h(c,f,r,"hour"):f>=t?h(c,f,t,"minute"):f>=e?h(c,f,e,"second"):c+" ms"}function h(c,f,d,m){var w=f>=d*1.5;return Math.round(c/d)+" "+m+(w?"s":"")}return Ui}var ki,ts;function Ic(){if(ts)return ki;ts=1;function e(t){n.debug=n,n.default=n,n.coerce=h,n.disable=s,n.enable=a,n.enabled=l,n.humanize=Em(),n.destroy=c,Object.keys(t).forEach(f=>{n[f]=t[f]}),n.names=[],n.skips=[],n.formatters={};function r(f){let d=0;for(let m=0;m<f.length;m++)d=(d<<5)-d+f.charCodeAt(m),d|=0;return n.colors[Math.abs(d)%n.colors.length]}n.selectColor=r;function n(f){let d,m=null,w,E;function T(...S){if(!T.enabled)return;const A=T,$=Number(new Date),P=$-(d||$);A.diff=P,A.prev=d,A.curr=$,d=$,S[0]=n.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let J=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(X,Ce)=>{if(X==="%%")return"%";J++;const y=n.formatters[Ce];if(typeof y=="function"){const q=S[J];X=y.call(A,q),S.splice(J,1),J--}return X}),n.formatArgs.call(A,S),(A.log||n.log).apply(A,S)}return T.namespace=f,T.useColors=n.useColors(),T.color=n.selectColor(f),T.extend=i,T.destroy=n.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(w!==n.namespaces&&(w=n.namespaces,E=n.enabled(f)),E),set:S=>{m=S}}),typeof n.init=="function"&&n.init(T),T}function i(f,d){const m=n(this.namespace+(typeof d>"u"?":":d)+f);return m.log=this.log,m}function a(f){n.save(f),n.namespaces=f,n.names=[],n.skips=[];const d=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const m of d)m[0]==="-"?n.skips.push(m.slice(1)):n.names.push(m)}function o(f,d){let m=0,w=0,E=-1,T=0;for(;m<f.length;)if(w<d.length&&(d[w]===f[m]||d[w]==="*"))d[w]==="*"?(E=w,T=m,w++):(m++,w++);else if(E!==-1)w=E+1,T++,m=T;else return!1;for(;w<d.length&&d[w]==="*";)w++;return w===d.length}function s(){const f=[...n.names,...n.skips.map(d=>"-"+d)].join(",");return n.enable(""),f}function l(f){for(const d of n.skips)if(o(f,d))return!1;for(const d of n.names)if(o(f,d))return!0;return!1}function h(f){return f instanceof Error?f.stack||f.message:f}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return ki=e,ki}var rs;function ym(){return rs||(rs=1,function(e,t){t.formatArgs=n,t.save=i,t.load=a,t.useColors=r,t.storage=o(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;l.splice(1,0,h,"color: inherit");let c=0,f=0;l[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(c++,d==="%c"&&(f=c))}),l.splice(f,0,h)}t.log=console.debug||console.log||(()=>{});function i(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function a(){let l;try{l=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=process.env.DEBUG),l}function o(){try{return localStorage}catch{}}e.exports=Ic()(t);const{formatters:s}=e.exports;s.j=function(l){try{return JSON.stringify(l)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}(vn,vn.exports)),vn.exports}var Tn={exports:{}},Mi,ns;function wm(){return ns||(ns=1,Mi=(e,t=process.argv)=>{const r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}),Mi}var Bi,is;function _m(){if(is)return Bi;is=1;const e=Qn,t=Pl,r=wm(),{env:n}=process;let i;r("no-color")||r("no-colors")||r("color=false")||r("color=never")?i=0:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(i=1);function a(){if("FORCE_COLOR"in n)return n.FORCE_COLOR==="true"?1:n.FORCE_COLOR==="false"?0:n.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(n.FORCE_COLOR,10),3)}function o(h){return h===0?!1:{level:h,hasBasic:!0,has256:h>=2,has16m:h>=3}}function s(h,{streamIsTTY:c,sniffFlags:f=!0}={}){const d=a();d!==void 0&&(i=d);const m=f?i:d;if(m===0)return 0;if(f){if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2}if(h&&!c&&m===void 0)return 0;const w=m||0;if(n.TERM==="dumb")return w;if(process.platform==="win32"){const E=e.release().split(".");return Number(E[0])>=10&&Number(E[2])>=10586?Number(E[2])>=14931?3:2:1}if("CI"in n)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(E=>E in n)||n.CI_NAME==="codeship"?1:w;if("TEAMCITY_VERSION"in n)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(n.TEAMCITY_VERSION)?1:0;if(n.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in n){const E=Number.parseInt((n.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(n.TERM_PROGRAM){case"iTerm.app":return E>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(n.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(n.TERM)||"COLORTERM"in n?1:w}function l(h,c={}){const f=s(h,{streamIsTTY:h&&h.isTTY,...c});return o(f)}return Bi={supportsColor:l,stdout:l({isTTY:t.isatty(1)}),stderr:l({isTTY:t.isatty(2)})},Bi}var as;function vm(){return as||(as=1,function(e,t){const r=Pl,n=Oa;t.init=c,t.log=s,t.formatArgs=a,t.save=l,t.load=h,t.useColors=i,t.destroy=n.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const d=_m();d&&(d.stderr||d).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}t.inspectOpts=Object.keys(process.env).filter(d=>/^debug_/i.test(d)).reduce((d,m)=>{const w=m.substring(6).toLowerCase().replace(/_([a-z])/g,(T,S)=>S.toUpperCase());let E=process.env[m];return/^(yes|on|true|enabled)$/i.test(E)?E=!0:/^(no|off|false|disabled)$/i.test(E)?E=!1:E==="null"?E=null:E=Number(E),d[w]=E,d},{});function i(){return"colors"in t.inspectOpts?!!t.inspectOpts.colors:r.isatty(process.stderr.fd)}function a(d){const{namespace:m,useColors:w}=this;if(w){const E=this.color,T="\x1B[3"+(E<8?E:"8;5;"+E),S=`  ${T};1m${m} \x1B[0m`;d[0]=S+d[0].split(`
`).join(`
`+S),d.push(T+"m+"+e.exports.humanize(this.diff)+"\x1B[0m")}else d[0]=o()+m+" "+d[0]}function o(){return t.inspectOpts.hideDate?"":new Date().toISOString()+" "}function s(...d){return process.stderr.write(n.formatWithOptions(t.inspectOpts,...d)+`
`)}function l(d){d?process.env.DEBUG=d:delete process.env.DEBUG}function h(){return process.env.DEBUG}function c(d){d.inspectOpts={};const m=Object.keys(t.inspectOpts);for(let w=0;w<m.length;w++)d.inspectOpts[m[w]]=t.inspectOpts[m[w]]}e.exports=Ic()(t);const{formatters:f}=e.exports;f.o=function(d){return this.inspectOpts.colors=this.useColors,n.inspect(d,this.inspectOpts).split(`
`).map(m=>m.trim()).join(" ")},f.O=function(d){return this.inspectOpts.colors=this.useColors,n.inspect(d,this.inspectOpts)}}(Tn,Tn.exports)),Tn.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Ea.exports=ym():Ea.exports=vm();var Tm=Ea.exports,Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.ProgressCallbackTransform=void 0;const Am=zr;class Sm extends Am.Transform{constructor(t,r,n){super(),this.total=t,this.cancellationToken=r,this.onProgress=n,this.start=Date.now(),this.transferred=0,this.delta=0,this.nextUpdate=this.start+1e3}_transform(t,r,n){if(this.cancellationToken.cancelled){n(new Error("cancelled"),null);return}this.transferred+=t.length,this.delta+=t.length;const i=Date.now();i>=this.nextUpdate&&this.transferred!==this.total&&(this.nextUpdate=i+1e3,this.onProgress({total:this.total,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.total*100,bytesPerSecond:Math.round(this.transferred/((i-this.start)/1e3))}),this.delta=0),n(null,t)}_flush(t){if(this.cancellationToken.cancelled){t(new Error("cancelled"));return}this.onProgress({total:this.total,delta:this.delta,transferred:this.total,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,t(null)}}Jr.ProgressCallbackTransform=Sm;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.DigestTransform=Ie.HttpExecutor=Ie.HttpError=void 0;Ie.createHttpError=wa;Ie.parseJson=Pm;Ie.configureRequestOptionsFromUrl=Dc;Ie.configureRequestUrl=ja;Ie.safeGetHeader=or;Ie.configureRequestOptions=jn;Ie.safeStringifyJson=Gn;const Cm=hr,Nm=Tm,bm=ue,Rm=zr,ya=st,Im=wt,os=mr,Om=Jr,Dt=(0,Nm.default)("electron-builder");function wa(e,t=null){return new Ha(e.statusCode||-1,`${e.statusCode} ${e.statusMessage}`+(t==null?"":`
`+JSON.stringify(t,null,"  "))+`
Headers: `+Gn(e.headers),t)}const Dm=new Map([[429,"Too many requests"],[400,"Bad request"],[403,"Forbidden"],[404,"Not found"],[405,"Method not allowed"],[406,"Not acceptable"],[408,"Request timeout"],[413,"Request entity too large"],[500,"Internal server error"],[502,"Bad gateway"],[503,"Service unavailable"],[504,"Gateway timeout"],[505,"HTTP version not supported"]]);class Ha extends Error{constructor(t,r=`HTTP error: ${Dm.get(t)||t}`,n=null){super(r),this.statusCode=t,this.description=n,this.name="HttpError",this.code=`HTTP_ERROR_${t}`}isServerError(){return this.statusCode>=500&&this.statusCode<=599}}Ie.HttpError=Ha;function Pm(e){return e.then(t=>t==null||t.length===0?null:JSON.parse(t))}class Zt{constructor(){this.maxRedirects=10}request(t,r=new Im.CancellationToken,n){jn(t);const i=n==null?void 0:JSON.stringify(n),a=i?Buffer.from(i):void 0;if(a!=null){Dt(i);const{headers:o,...s}=t;t={method:"post",headers:{"Content-Type":"application/json","Content-Length":a.length,...o},...s}}return this.doApiRequest(t,r,o=>o.end(a))}doApiRequest(t,r,n,i=0){return Dt.enabled&&Dt(`Request: ${Gn(t)}`),r.createPromise((a,o,s)=>{const l=this.createRequest(t,h=>{try{this.handleResponse(h,t,r,a,o,i,n)}catch(c){o(c)}});this.addErrorAndTimeoutHandlers(l,o,t.timeout),this.addRedirectHandlers(l,t,o,i,h=>{this.doApiRequest(h,r,n,i).then(a).catch(o)}),n(l,o),s(()=>l.abort())})}addRedirectHandlers(t,r,n,i,a){}addErrorAndTimeoutHandlers(t,r,n=60*1e3){this.addTimeOutHandler(t,r,n),t.on("error",r),t.on("aborted",()=>{r(new Error("Request has been aborted by the server"))})}handleResponse(t,r,n,i,a,o,s){var l;if(Dt.enabled&&Dt(`Response: ${t.statusCode} ${t.statusMessage}, request options: ${Gn(r)}`),t.statusCode===404){a(wa(t,`method: ${r.method||"GET"} url: ${r.protocol||"https:"}//${r.hostname}${r.port?`:${r.port}`:""}${r.path}

Please double check that your authentication token is correct. Due to security reasons, actual status maybe not reported, but 404.
`));return}else if(t.statusCode===204){i();return}const h=(l=t.statusCode)!==null&&l!==void 0?l:0,c=h>=300&&h<400,f=or(t,"location");if(c&&f!=null){if(o>this.maxRedirects){a(this.createMaxRedirectError());return}this.doApiRequest(Zt.prepareRedirectUrlOptions(f,r),n,s,o).then(i).catch(a);return}t.setEncoding("utf8");let d="";t.on("error",a),t.on("data",m=>d+=m),t.on("end",()=>{try{if(t.statusCode!=null&&t.statusCode>=400){const m=or(t,"content-type"),w=m!=null&&(Array.isArray(m)?m.find(E=>E.includes("json"))!=null:m.includes("json"));a(wa(t,`method: ${r.method||"GET"} url: ${r.protocol||"https:"}//${r.hostname}${r.port?`:${r.port}`:""}${r.path}

          Data:
          ${w?JSON.stringify(JSON.parse(d)):d}
          `))}else i(d.length===0?null:d)}catch(m){a(m)}})}async downloadToBuffer(t,r){return await r.cancellationToken.createPromise((n,i,a)=>{const o=[],s={headers:r.headers||void 0,redirect:"manual"};ja(t,s),jn(s),this.doDownload(s,{destination:null,options:r,onCancel:a,callback:l=>{l==null?n(Buffer.concat(o)):i(l)},responseHandler:(l,h)=>{let c=0;l.on("data",f=>{if(c+=f.length,c>524288e3){h(new Error("Maximum allowed size is 500 MB"));return}o.push(f)}),l.on("end",()=>{h(null)})}},0)})}doDownload(t,r,n){const i=this.createRequest(t,a=>{if(a.statusCode>=400){r.callback(new Error(`Cannot download "${t.protocol||"https:"}//${t.hostname}${t.path}", status ${a.statusCode}: ${a.statusMessage}`));return}a.on("error",r.callback);const o=or(a,"location");if(o!=null){n<this.maxRedirects?this.doDownload(Zt.prepareRedirectUrlOptions(o,t),r,n++):r.callback(this.createMaxRedirectError());return}r.responseHandler==null?$m(r,a):r.responseHandler(a,r.callback)});this.addErrorAndTimeoutHandlers(i,r.callback,t.timeout),this.addRedirectHandlers(i,t,r.callback,n,a=>{this.doDownload(a,r,n++)}),i.end()}createMaxRedirectError(){return new Error(`Too many redirects (> ${this.maxRedirects})`)}addTimeOutHandler(t,r,n){t.on("socket",i=>{i.setTimeout(n,()=>{t.abort(),r(new Error("Request timed out"))})})}static prepareRedirectUrlOptions(t,r){const n=Dc(t,{...r}),i=n.headers;if(i!=null&&i.authorization){const a=Zt.reconstructOriginalUrl(r),o=Oc(t,r);Zt.isCrossOriginRedirect(a,o)&&(Dt.enabled&&Dt(`Given the cross-origin redirect (from ${a.host} to ${o.host}), the Authorization header will be stripped out.`),delete i.authorization)}return n}static reconstructOriginalUrl(t){const r=t.protocol||"https:";if(!t.hostname)throw new Error("Missing hostname in request options");const n=t.hostname,i=t.port?`:${t.port}`:"",a=t.path||"/";return new ya.URL(`${r}//${n}${i}${a}`)}static isCrossOriginRedirect(t,r){if(t.hostname.toLowerCase()!==r.hostname.toLowerCase())return!0;if(t.protocol==="http:"&&["80",""].includes(t.port)&&r.protocol==="https:"&&["443",""].includes(r.port))return!1;if(t.protocol!==r.protocol)return!0;const n=t.port,i=r.port;return n!==i}static retryOnServerError(t,r=3){for(let n=0;;n++)try{return t()}catch(i){if(n<r&&(i instanceof Ha&&i.isServerError()||i.code==="EPIPE"))continue;throw i}}}Ie.HttpExecutor=Zt;function Oc(e,t){try{return new ya.URL(e)}catch{const r=t.hostname,n=t.protocol||"https:",i=t.port?`:${t.port}`:"",a=`${n}//${r}${i}`;return new ya.URL(e,a)}}function Dc(e,t){const r=jn(t),n=Oc(e,t);return ja(n,r),r}function ja(e,t){t.protocol=e.protocol,t.hostname=e.hostname,e.port?t.port=e.port:t.port&&delete t.port,t.path=e.pathname+e.search}class _a extends Rm.Transform{get actual(){return this._actual}constructor(t,r="sha512",n="base64"){super(),this.expected=t,this.algorithm=r,this.encoding=n,this._actual=null,this.isValidateOnEnd=!0,this.digester=(0,Cm.createHash)(r)}_transform(t,r,n){this.digester.update(t),n(null,t)}_flush(t){if(this._actual=this.digester.digest(this.encoding),this.isValidateOnEnd)try{this.validate()}catch(r){t(r);return}t(null)}validate(){if(this._actual==null)throw(0,os.newError)("Not finished yet","ERR_STREAM_NOT_FINISHED");if(this._actual!==this.expected)throw(0,os.newError)(`${this.algorithm} checksum mismatch, expected ${this.expected}, got ${this._actual}`,"ERR_CHECKSUM_MISMATCH");return null}}Ie.DigestTransform=_a;function Fm(e,t,r){return e!=null&&t!=null&&e!==t?(r(new Error(`checksum mismatch: expected ${t} but got ${e} (X-Checksum-Sha2 header)`)),!1):!0}function or(e,t){const r=e.headers[t];return r==null?null:Array.isArray(r)?r.length===0?null:r[r.length-1]:r}function $m(e,t){if(!Fm(or(t,"X-Checksum-Sha2"),e.options.sha2,e.callback))return;const r=[];if(e.options.onProgress!=null){const o=or(t,"content-length");o!=null&&r.push(new Om.ProgressCallbackTransform(parseInt(o,10),e.options.cancellationToken,e.options.onProgress))}const n=e.options.sha512;n!=null?r.push(new _a(n,"sha512",n.length===128&&!n.includes("+")&&!n.includes("Z")&&!n.includes("=")?"hex":"base64")):e.options.sha2!=null&&r.push(new _a(e.options.sha2,"sha256","hex"));const i=(0,bm.createWriteStream)(e.destination);r.push(i);let a=t;for(const o of r)o.on("error",s=>{i.close(),e.options.cancellationToken.cancelled||e.callback(s)}),a=a.pipe(o);i.on("finish",()=>{i.close(e.callback)})}function jn(e,t,r){r!=null&&(e.method=r),e.headers={...e.headers};const n=e.headers;return t!=null&&(n.authorization=t.startsWith("Basic")||t.startsWith("Bearer")?t:`token ${t}`),n["User-Agent"]==null&&(n["User-Agent"]="electron-builder"),(r==null||r==="GET"||n["Cache-Control"]==null)&&(n["Cache-Control"]="no-cache"),e.protocol==null&&process.versions.electron!=null&&(e.protocol="https:"),e}function Gn(e,t){return JSON.stringify(e,(r,n)=>r.endsWith("Authorization")||r.endsWith("authorization")||r.endsWith("Password")||r.endsWith("PASSWORD")||r.endsWith("Token")||r.includes("password")||r.includes("token")||t!=null&&t.has(r)?"<stripped sensitive data>":n,2)}var ai={};Object.defineProperty(ai,"__esModule",{value:!0});ai.MemoLazy=void 0;class Lm{constructor(t,r){this.selector=t,this.creator=r,this.selected=void 0,this._value=void 0}get hasValue(){return this._value!==void 0}get value(){const t=this.selector();if(this._value!==void 0&&Pc(this.selected,t))return this._value;this.selected=t;const r=this.creator(t);return this.value=r,r}set value(t){this._value=t}}ai.MemoLazy=Lm;function Pc(e,t){if(typeof e=="object"&&e!==null&&(typeof t=="object"&&t!==null)){const i=Object.keys(e),a=Object.keys(t);return i.length===a.length&&i.every(o=>Pc(e[o],t[o]))}return e===t}var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.githubUrl=xm;Qr.githubTagPrefix=Um;Qr.getS3LikeProviderBaseUrl=km;function xm(e,t="github.com"){return`${e.protocol||"https"}://${e.host||t}`}function Um(e){var t;return e.tagNamePrefix?e.tagNamePrefix:!((t=e.vPrefixedTagName)!==null&&t!==void 0)||t?"v":""}function km(e){const t=e.provider;if(t==="s3")return Mm(e);if(t==="spaces")return Bm(e);throw new Error(`Not supported provider: ${t}`)}function Mm(e){let t;if(e.accelerate==!0)t=`https://${e.bucket}.s3-accelerate.amazonaws.com`;else if(e.endpoint!=null)t=`${e.endpoint}/${e.bucket}`;else if(e.bucket.includes(".")){if(e.region==null)throw new Error(`Bucket name "${e.bucket}" includes a dot, but S3 region is missing`);e.region==="us-east-1"?t=`https://s3.amazonaws.com/${e.bucket}`:t=`https://s3-${e.region}.amazonaws.com/${e.bucket}`}else e.region==="cn-north-1"?t=`https://${e.bucket}.s3.${e.region}.amazonaws.com.cn`:t=`https://${e.bucket}.s3.amazonaws.com`;return Fc(t,e.path)}function Fc(e,t){return t!=null&&t.length>0&&(t.startsWith("/")||(e+="/"),e+=t),e}function Bm(e){if(e.name==null)throw new Error("name is missing");if(e.region==null)throw new Error("region is missing");return Fc(`https://${e.name}.${e.region}.digitaloceanspaces.com`,e.path)}var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.retry=$c;const Hm=wt;async function $c(e,t){var r;const{retries:n,interval:i,backoff:a=0,attempt:o=0,shouldRetry:s,cancellationToken:l=new Hm.CancellationToken}=t;try{return await e()}catch(h){if(await Promise.resolve((r=s==null?void 0:s(h))!==null&&r!==void 0?r:!0)&&n>0&&!l.cancelled)return await new Promise(c=>setTimeout(c,i+a*o)),await $c(e,{...t,retries:n-1,attempt:o+1});throw h}}var qa={};Object.defineProperty(qa,"__esModule",{value:!0});qa.parseDn=jm;function jm(e){let t=!1,r=null,n="",i=0;e=e.trim();const a=new Map;for(let o=0;o<=e.length;o++){if(o===e.length){r!==null&&a.set(r,n);break}const s=e[o];if(t){if(s==='"'){t=!1;continue}}else{if(s==='"'){t=!0;continue}if(s==="\\"){o++;const l=parseInt(e.slice(o,o+2),16);Number.isNaN(l)?n+=e[o]:(o++,n+=String.fromCharCode(l));continue}if(r===null&&s==="="){r=n,n="";continue}if(s===","||s===";"||s==="+"){r!==null&&a.set(r,n),r=null,n="";continue}}if(s===" "&&!t){if(n.length===0)continue;if(o>i){let l=o;for(;e[l]===" ";)l++;i=l}if(i>=e.length||e[i]===","||e[i]===";"||r===null&&e[i]==="="||r!==null&&e[i]==="+"){o=i-1;continue}}n+=s}return a}var fr={};Object.defineProperty(fr,"__esModule",{value:!0});fr.nil=fr.UUID=void 0;const Lc=hr,xc=mr,Gm="options.name must be either a string or a Buffer",ss=(0,Lc.randomBytes)(16);ss[0]=ss[0]|1;const kn={},Y=[];for(let e=0;e<256;e++){const t=(e+256).toString(16).substr(1);kn[t]=e,Y[e]=t}class kt{constructor(t){this.ascii=null,this.binary=null;const r=kt.check(t);if(!r)throw new Error("not a UUID");this.version=r.version,r.format==="ascii"?this.ascii=t:this.binary=t}static v5(t,r){return qm(t,"sha1",80,r)}toString(){return this.ascii==null&&(this.ascii=Vm(this.binary)),this.ascii}inspect(){return`UUID v${this.version} ${this.toString()}`}static check(t,r=0){if(typeof t=="string")return t=t.toLowerCase(),/^[a-f0-9]{8}(-[a-f0-9]{4}){3}-([a-f0-9]{12})$/.test(t)?t==="00000000-0000-0000-0000-000000000000"?{version:void 0,variant:"nil",format:"ascii"}:{version:(kn[t[14]+t[15]]&240)>>4,variant:ls((kn[t[19]+t[20]]&224)>>5),format:"ascii"}:!1;if(Buffer.isBuffer(t)){if(t.length<r+16)return!1;let n=0;for(;n<16&&t[r+n]===0;n++);return n===16?{version:void 0,variant:"nil",format:"binary"}:{version:(t[r+6]&240)>>4,variant:ls((t[r+8]&224)>>5),format:"binary"}}throw(0,xc.newError)("Unknown type of uuid","ERR_UNKNOWN_UUID_TYPE")}static parse(t){const r=Buffer.allocUnsafe(16);let n=0;for(let i=0;i<16;i++)r[i]=kn[t[n++]+t[n++]],(i===3||i===5||i===7||i===9)&&(n+=1);return r}}fr.UUID=kt;kt.OID=kt.parse("6ba7b812-9dad-11d1-80b4-00c04fd430c8");function ls(e){switch(e){case 0:case 1:case 3:return"ncs";case 4:case 5:return"rfc4122";case 6:return"microsoft";default:return"future"}}var Pr;(function(e){e[e.ASCII=0]="ASCII",e[e.BINARY=1]="BINARY",e[e.OBJECT=2]="OBJECT"})(Pr||(Pr={}));function qm(e,t,r,n,i=Pr.ASCII){const a=(0,Lc.createHash)(t);if(typeof e!="string"&&!Buffer.isBuffer(e))throw(0,xc.newError)(Gm,"ERR_INVALID_UUID_NAME");a.update(n),a.update(e);const s=a.digest();let l;switch(i){case Pr.BINARY:s[6]=s[6]&15|r,s[8]=s[8]&63|128,l=s;break;case Pr.OBJECT:s[6]=s[6]&15|r,s[8]=s[8]&63|128,l=new kt(s);break;default:l=Y[s[0]]+Y[s[1]]+Y[s[2]]+Y[s[3]]+"-"+Y[s[4]]+Y[s[5]]+"-"+Y[s[6]&15|r]+Y[s[7]]+"-"+Y[s[8]&63|128]+Y[s[9]]+"-"+Y[s[10]]+Y[s[11]]+Y[s[12]]+Y[s[13]]+Y[s[14]]+Y[s[15]];break}return l}function Vm(e){return Y[e[0]]+Y[e[1]]+Y[e[2]]+Y[e[3]]+"-"+Y[e[4]]+Y[e[5]]+"-"+Y[e[6]]+Y[e[7]]+"-"+Y[e[8]]+Y[e[9]]+"-"+Y[e[10]]+Y[e[11]]+Y[e[12]]+Y[e[13]]+Y[e[14]]+Y[e[15]]}fr.nil=new kt("00000000-0000-0000-0000-000000000000");var Zr={},Uc={};(function(e){(function(t){t.parser=function(p,u){return new n(p,u)},t.SAXParser=n,t.SAXStream=c,t.createStream=h,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(p,u){if(!(this instanceof n))return new n(p,u);var C=this;a(C),C.q=C.c="",C.bufferCheckPosition=t.MAX_BUFFER_LENGTH,C.opt=u||{},C.opt.lowercase=C.opt.lowercase||C.opt.lowercasetags,C.looseCase=C.opt.lowercase?"toLowerCase":"toUpperCase",C.tags=[],C.closed=C.closedRoot=C.sawRoot=!1,C.tag=C.error=null,C.strict=!!p,C.noscript=!!(p||C.opt.noscript),C.state=y.BEGIN,C.strictEntities=C.opt.strictEntities,C.ENTITIES=C.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),C.attribList=[],C.opt.xmlns&&(C.ns=Object.create(E)),C.opt.unquotedAttributeValues===void 0&&(C.opt.unquotedAttributeValues=!p),C.trackPosition=C.opt.position!==!1,C.trackPosition&&(C.position=C.line=C.column=0),H(C,"onready")}Object.create||(Object.create=function(p){function u(){}u.prototype=p;var C=new u;return C}),Object.keys||(Object.keys=function(p){var u=[];for(var C in p)p.hasOwnProperty(C)&&u.push(C);return u});function i(p){for(var u=Math.max(t.MAX_BUFFER_LENGTH,10),C=0,v=0,z=r.length;v<z;v++){var te=p[r[v]].length;if(te>u)switch(r[v]){case"textNode":Q(p);break;case"cdata":B(p,"oncdata",p.cdata),p.cdata="";break;case"script":B(p,"onscript",p.script),p.script="";break;default:b(p,"Max buffer length exceeded: "+r[v])}C=Math.max(C,te)}var se=t.MAX_BUFFER_LENGTH-C;p.bufferCheckPosition=se+p.position}function a(p){for(var u=0,C=r.length;u<C;u++)p[r[u]]=""}function o(p){Q(p),p.cdata!==""&&(B(p,"oncdata",p.cdata),p.cdata=""),p.script!==""&&(B(p,"onscript",p.script),p.script="")}n.prototype={end:function(){F(this)},write:Je,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var s;try{s=require("stream").Stream}catch{s=function(){}}s||(s=function(){});var l=t.EVENTS.filter(function(p){return p!=="error"&&p!=="end"});function h(p,u){return new c(p,u)}function c(p,u){if(!(this instanceof c))return new c(p,u);s.apply(this),this._parser=new n(p,u),this.writable=!0,this.readable=!0;var C=this;this._parser.onend=function(){C.emit("end")},this._parser.onerror=function(v){C.emit("error",v),C._parser.error=null},this._decoder=null,l.forEach(function(v){Object.defineProperty(C,"on"+v,{get:function(){return C._parser["on"+v]},set:function(z){if(!z)return C.removeAllListeners(v),C._parser["on"+v]=z,z;C.on(v,z)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(s.prototype,{constructor:{value:c}}),c.prototype.write=function(p){return typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(p)&&(this._decoder||(this._decoder=new TextDecoder("utf8")),p=this._decoder.decode(p,{stream:!0})),this._parser.write(p.toString()),this.emit("data",p),!0},c.prototype.end=function(p){if(p&&p.length&&this.write(p),this._decoder){var u=this._decoder.decode();u&&(this._parser.write(u),this.emit("data",u))}return this._parser.end(),!0},c.prototype.on=function(p,u){var C=this;return!C._parser["on"+p]&&l.indexOf(p)!==-1&&(C._parser["on"+p]=function(){var v=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);v.splice(0,0,p),C.emit.apply(C,v)}),s.prototype.on.call(C,p,u)};var f="[CDATA[",d="DOCTYPE",m="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",E={xml:m,xmlns:w},T=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,A=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,$=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function P(p){return p===" "||p===`
`||p==="\r"||p==="	"}function J(p){return p==='"'||p==="'"}function ne(p){return p===">"||P(p)}function X(p,u){return p.test(u)}function Ce(p,u){return!X(p,u)}var y=0;t.STATE={BEGIN:y++,BEGIN_WHITESPACE:y++,TEXT:y++,TEXT_ENTITY:y++,OPEN_WAKA:y++,SGML_DECL:y++,SGML_DECL_QUOTED:y++,DOCTYPE:y++,DOCTYPE_QUOTED:y++,DOCTYPE_DTD:y++,DOCTYPE_DTD_QUOTED:y++,COMMENT_STARTING:y++,COMMENT:y++,COMMENT_ENDING:y++,COMMENT_ENDED:y++,CDATA:y++,CDATA_ENDING:y++,CDATA_ENDING_2:y++,PROC_INST:y++,PROC_INST_BODY:y++,PROC_INST_ENDING:y++,OPEN_TAG:y++,OPEN_TAG_SLASH:y++,ATTRIB:y++,ATTRIB_NAME:y++,ATTRIB_NAME_SAW_WHITE:y++,ATTRIB_VALUE:y++,ATTRIB_VALUE_QUOTED:y++,ATTRIB_VALUE_CLOSED:y++,ATTRIB_VALUE_UNQUOTED:y++,ATTRIB_VALUE_ENTITY_Q:y++,ATTRIB_VALUE_ENTITY_U:y++,CLOSE_TAG:y++,CLOSE_TAG_SAW_WHITE:y++,SCRIPT:y++,SCRIPT_ENDING:y++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(p){var u=t.ENTITIES[p],C=typeof u=="number"?String.fromCharCode(u):u;t.ENTITIES[p]=C});for(var q in t.STATE)t.STATE[t.STATE[q]]=q;y=t.STATE;function H(p,u,C){p[u]&&p[u](C)}function B(p,u,C){p.textNode&&Q(p),H(p,u,C)}function Q(p){p.textNode=I(p.opt,p.textNode),p.textNode&&H(p,"ontext",p.textNode),p.textNode=""}function I(p,u){return p.trim&&(u=u.trim()),p.normalize&&(u=u.replace(/\s+/g," ")),u}function b(p,u){return Q(p),p.trackPosition&&(u+=`
Line: `+p.line+`
Column: `+p.column+`
Char: `+p.c),u=new Error(u),p.error=u,H(p,"onerror",u),p}function F(p){return p.sawRoot&&!p.closedRoot&&N(p,"Unclosed root tag"),p.state!==y.BEGIN&&p.state!==y.BEGIN_WHITESPACE&&p.state!==y.TEXT&&b(p,"Unexpected end"),Q(p),p.c="",p.closed=!0,H(p,"onend"),n.call(p,p.strict,p.opt),p}function N(p,u){if(typeof p!="object"||!(p instanceof n))throw new Error("bad call to strictFail");p.strict&&b(p,u)}function L(p){p.strict||(p.tagName=p.tagName[p.looseCase]());var u=p.tags[p.tags.length-1]||p,C=p.tag={name:p.tagName,attributes:{}};p.opt.xmlns&&(C.ns=u.ns),p.attribList.length=0,B(p,"onopentagstart",C)}function O(p,u){var C=p.indexOf(":"),v=C<0?["",p]:p.split(":"),z=v[0],te=v[1];return u&&p==="xmlns"&&(z="xmlns",te=""),{prefix:z,local:te}}function M(p){if(p.strict||(p.attribName=p.attribName[p.looseCase]()),p.attribList.indexOf(p.attribName)!==-1||p.tag.attributes.hasOwnProperty(p.attribName)){p.attribName=p.attribValue="";return}if(p.opt.xmlns){var u=O(p.attribName,!0),C=u.prefix,v=u.local;if(C==="xmlns")if(v==="xml"&&p.attribValue!==m)N(p,"xml: prefix must be bound to "+m+`
Actual: `+p.attribValue);else if(v==="xmlns"&&p.attribValue!==w)N(p,"xmlns: prefix must be bound to "+w+`
Actual: `+p.attribValue);else{var z=p.tag,te=p.tags[p.tags.length-1]||p;z.ns===te.ns&&(z.ns=Object.create(te.ns)),z.ns[v]=p.attribValue}p.attribList.push([p.attribName,p.attribValue])}else p.tag.attributes[p.attribName]=p.attribValue,B(p,"onattribute",{name:p.attribName,value:p.attribValue});p.attribName=p.attribValue=""}function W(p,u){if(p.opt.xmlns){var C=p.tag,v=O(p.tagName);C.prefix=v.prefix,C.local=v.local,C.uri=C.ns[v.prefix]||"",C.prefix&&!C.uri&&(N(p,"Unbound namespace prefix: "+JSON.stringify(p.tagName)),C.uri=v.prefix);var z=p.tags[p.tags.length-1]||p;C.ns&&z.ns!==C.ns&&Object.keys(C.ns).forEach(function(cn){B(p,"onopennamespace",{prefix:cn,uri:C.ns[cn]})});for(var te=0,se=p.attribList.length;te<se;te++){var Ee=p.attribList[te],ve=Ee[0],lt=Ee[1],de=O(ve,!0),je=de.prefix,Ai=de.local,ln=je===""?"":C.ns[je]||"",wr={name:ve,value:lt,prefix:je,local:Ai,uri:ln};je&&je!=="xmlns"&&!ln&&(N(p,"Unbound namespace prefix: "+JSON.stringify(je)),wr.uri=je),p.tag.attributes[ve]=wr,B(p,"onattribute",wr)}p.attribList.length=0}p.tag.isSelfClosing=!!u,p.sawRoot=!0,p.tags.push(p.tag),B(p,"onopentag",p.tag),u||(!p.noscript&&p.tagName.toLowerCase()==="script"?p.state=y.SCRIPT:p.state=y.TEXT,p.tag=null,p.tagName=""),p.attribName=p.attribValue="",p.attribList.length=0}function j(p){if(!p.tagName){N(p,"Weird empty close tag."),p.textNode+="</>",p.state=y.TEXT;return}if(p.script){if(p.tagName!=="script"){p.script+="</"+p.tagName+">",p.tagName="",p.state=y.SCRIPT;return}B(p,"onscript",p.script),p.script=""}var u=p.tags.length,C=p.tagName;p.strict||(C=C[p.looseCase]());for(var v=C;u--;){var z=p.tags[u];if(z.name!==v)N(p,"Unexpected close tag");else break}if(u<0){N(p,"Unmatched closing tag: "+p.tagName),p.textNode+="</"+p.tagName+">",p.state=y.TEXT;return}p.tagName=C;for(var te=p.tags.length;te-- >u;){var se=p.tag=p.tags.pop();p.tagName=p.tag.name,B(p,"onclosetag",p.tagName);var Ee={};for(var ve in se.ns)Ee[ve]=se.ns[ve];var lt=p.tags[p.tags.length-1]||p;p.opt.xmlns&&se.ns!==lt.ns&&Object.keys(se.ns).forEach(function(de){var je=se.ns[de];B(p,"onclosenamespace",{prefix:de,uri:je})})}u===0&&(p.closedRoot=!0),p.tagName=p.attribValue=p.attribName="",p.attribList.length=0,p.state=y.TEXT}function Z(p){var u=p.entity,C=u.toLowerCase(),v,z="";return p.ENTITIES[u]?p.ENTITIES[u]:p.ENTITIES[C]?p.ENTITIES[C]:(u=C,u.charAt(0)==="#"&&(u.charAt(1)==="x"?(u=u.slice(2),v=parseInt(u,16),z=v.toString(16)):(u=u.slice(1),v=parseInt(u,10),z=v.toString(10))),u=u.replace(/^0+/,""),isNaN(v)||z.toLowerCase()!==u||v<0||v>1114111?(N(p,"Invalid character entity"),"&"+p.entity+";"):String.fromCodePoint(v))}function pe(p,u){u==="<"?(p.state=y.OPEN_WAKA,p.startTagPosition=p.position):P(u)||(N(p,"Non-whitespace before first tag."),p.textNode=u,p.state=y.TEXT)}function k(p,u){var C="";return u<p.length&&(C=p.charAt(u)),C}function Je(p){var u=this;if(this.error)throw this.error;if(u.closed)return b(u,"Cannot write after close. Assign an onready handler.");if(p===null)return F(u);typeof p=="object"&&(p=p.toString());for(var C=0,v="";v=k(p,C++),u.c=v,!!v;)switch(u.trackPosition&&(u.position++,v===`
`?(u.line++,u.column=0):u.column++),u.state){case y.BEGIN:if(u.state=y.BEGIN_WHITESPACE,v==="\uFEFF")continue;pe(u,v);continue;case y.BEGIN_WHITESPACE:pe(u,v);continue;case y.TEXT:if(u.sawRoot&&!u.closedRoot){for(var te=C-1;v&&v!=="<"&&v!=="&";)v=k(p,C++),v&&u.trackPosition&&(u.position++,v===`
`?(u.line++,u.column=0):u.column++);u.textNode+=p.substring(te,C-1)}v==="<"&&!(u.sawRoot&&u.closedRoot&&!u.strict)?(u.state=y.OPEN_WAKA,u.startTagPosition=u.position):(!P(v)&&(!u.sawRoot||u.closedRoot)&&N(u,"Text data outside of root node."),v==="&"?u.state=y.TEXT_ENTITY:u.textNode+=v);continue;case y.SCRIPT:v==="<"?u.state=y.SCRIPT_ENDING:u.script+=v;continue;case y.SCRIPT_ENDING:v==="/"?u.state=y.CLOSE_TAG:(u.script+="<"+v,u.state=y.SCRIPT);continue;case y.OPEN_WAKA:if(v==="!")u.state=y.SGML_DECL,u.sgmlDecl="";else if(!P(v))if(X(T,v))u.state=y.OPEN_TAG,u.tagName=v;else if(v==="/")u.state=y.CLOSE_TAG,u.tagName="";else if(v==="?")u.state=y.PROC_INST,u.procInstName=u.procInstBody="";else{if(N(u,"Unencoded <"),u.startTagPosition+1<u.position){var z=u.position-u.startTagPosition;v=new Array(z).join(" ")+v}u.textNode+="<"+v,u.state=y.TEXT}continue;case y.SGML_DECL:if(u.sgmlDecl+v==="--"){u.state=y.COMMENT,u.comment="",u.sgmlDecl="";continue}u.doctype&&u.doctype!==!0&&u.sgmlDecl?(u.state=y.DOCTYPE_DTD,u.doctype+="<!"+u.sgmlDecl+v,u.sgmlDecl=""):(u.sgmlDecl+v).toUpperCase()===f?(B(u,"onopencdata"),u.state=y.CDATA,u.sgmlDecl="",u.cdata=""):(u.sgmlDecl+v).toUpperCase()===d?(u.state=y.DOCTYPE,(u.doctype||u.sawRoot)&&N(u,"Inappropriately located doctype declaration"),u.doctype="",u.sgmlDecl=""):v===">"?(B(u,"onsgmldeclaration",u.sgmlDecl),u.sgmlDecl="",u.state=y.TEXT):(J(v)&&(u.state=y.SGML_DECL_QUOTED),u.sgmlDecl+=v);continue;case y.SGML_DECL_QUOTED:v===u.q&&(u.state=y.SGML_DECL,u.q=""),u.sgmlDecl+=v;continue;case y.DOCTYPE:v===">"?(u.state=y.TEXT,B(u,"ondoctype",u.doctype),u.doctype=!0):(u.doctype+=v,v==="["?u.state=y.DOCTYPE_DTD:J(v)&&(u.state=y.DOCTYPE_QUOTED,u.q=v));continue;case y.DOCTYPE_QUOTED:u.doctype+=v,v===u.q&&(u.q="",u.state=y.DOCTYPE);continue;case y.DOCTYPE_DTD:v==="]"?(u.doctype+=v,u.state=y.DOCTYPE):v==="<"?(u.state=y.OPEN_WAKA,u.startTagPosition=u.position):J(v)?(u.doctype+=v,u.state=y.DOCTYPE_DTD_QUOTED,u.q=v):u.doctype+=v;continue;case y.DOCTYPE_DTD_QUOTED:u.doctype+=v,v===u.q&&(u.state=y.DOCTYPE_DTD,u.q="");continue;case y.COMMENT:v==="-"?u.state=y.COMMENT_ENDING:u.comment+=v;continue;case y.COMMENT_ENDING:v==="-"?(u.state=y.COMMENT_ENDED,u.comment=I(u.opt,u.comment),u.comment&&B(u,"oncomment",u.comment),u.comment=""):(u.comment+="-"+v,u.state=y.COMMENT);continue;case y.COMMENT_ENDED:v!==">"?(N(u,"Malformed comment"),u.comment+="--"+v,u.state=y.COMMENT):u.doctype&&u.doctype!==!0?u.state=y.DOCTYPE_DTD:u.state=y.TEXT;continue;case y.CDATA:for(var te=C-1;v&&v!=="]";)v=k(p,C++),v&&u.trackPosition&&(u.position++,v===`
`?(u.line++,u.column=0):u.column++);u.cdata+=p.substring(te,C-1),v==="]"&&(u.state=y.CDATA_ENDING);continue;case y.CDATA_ENDING:v==="]"?u.state=y.CDATA_ENDING_2:(u.cdata+="]"+v,u.state=y.CDATA);continue;case y.CDATA_ENDING_2:v===">"?(u.cdata&&B(u,"oncdata",u.cdata),B(u,"onclosecdata"),u.cdata="",u.state=y.TEXT):v==="]"?u.cdata+="]":(u.cdata+="]]"+v,u.state=y.CDATA);continue;case y.PROC_INST:v==="?"?u.state=y.PROC_INST_ENDING:P(v)?u.state=y.PROC_INST_BODY:u.procInstName+=v;continue;case y.PROC_INST_BODY:if(!u.procInstBody&&P(v))continue;v==="?"?u.state=y.PROC_INST_ENDING:u.procInstBody+=v;continue;case y.PROC_INST_ENDING:v===">"?(B(u,"onprocessinginstruction",{name:u.procInstName,body:u.procInstBody}),u.procInstName=u.procInstBody="",u.state=y.TEXT):(u.procInstBody+="?"+v,u.state=y.PROC_INST_BODY);continue;case y.OPEN_TAG:X(S,v)?u.tagName+=v:(L(u),v===">"?W(u):v==="/"?u.state=y.OPEN_TAG_SLASH:(P(v)||N(u,"Invalid character in tag name"),u.state=y.ATTRIB));continue;case y.OPEN_TAG_SLASH:v===">"?(W(u,!0),j(u)):(N(u,"Forward-slash in opening tag not followed by >"),u.state=y.ATTRIB);continue;case y.ATTRIB:if(P(v))continue;v===">"?W(u):v==="/"?u.state=y.OPEN_TAG_SLASH:X(T,v)?(u.attribName=v,u.attribValue="",u.state=y.ATTRIB_NAME):N(u,"Invalid attribute name");continue;case y.ATTRIB_NAME:v==="="?u.state=y.ATTRIB_VALUE:v===">"?(N(u,"Attribute without value"),u.attribValue=u.attribName,M(u),W(u)):P(v)?u.state=y.ATTRIB_NAME_SAW_WHITE:X(S,v)?u.attribName+=v:N(u,"Invalid attribute name");continue;case y.ATTRIB_NAME_SAW_WHITE:if(v==="=")u.state=y.ATTRIB_VALUE;else{if(P(v))continue;N(u,"Attribute without value"),u.tag.attributes[u.attribName]="",u.attribValue="",B(u,"onattribute",{name:u.attribName,value:""}),u.attribName="",v===">"?W(u):X(T,v)?(u.attribName=v,u.state=y.ATTRIB_NAME):(N(u,"Invalid attribute name"),u.state=y.ATTRIB)}continue;case y.ATTRIB_VALUE:if(P(v))continue;J(v)?(u.q=v,u.state=y.ATTRIB_VALUE_QUOTED):(u.opt.unquotedAttributeValues||b(u,"Unquoted attribute value"),u.state=y.ATTRIB_VALUE_UNQUOTED,u.attribValue=v);continue;case y.ATTRIB_VALUE_QUOTED:if(v!==u.q){v==="&"?u.state=y.ATTRIB_VALUE_ENTITY_Q:u.attribValue+=v;continue}M(u),u.q="",u.state=y.ATTRIB_VALUE_CLOSED;continue;case y.ATTRIB_VALUE_CLOSED:P(v)?u.state=y.ATTRIB:v===">"?W(u):v==="/"?u.state=y.OPEN_TAG_SLASH:X(T,v)?(N(u,"No whitespace between attributes"),u.attribName=v,u.attribValue="",u.state=y.ATTRIB_NAME):N(u,"Invalid attribute name");continue;case y.ATTRIB_VALUE_UNQUOTED:if(!ne(v)){v==="&"?u.state=y.ATTRIB_VALUE_ENTITY_U:u.attribValue+=v;continue}M(u),v===">"?W(u):u.state=y.ATTRIB;continue;case y.CLOSE_TAG:if(u.tagName)v===">"?j(u):X(S,v)?u.tagName+=v:u.script?(u.script+="</"+u.tagName+v,u.tagName="",u.state=y.SCRIPT):(P(v)||N(u,"Invalid tagname in closing tag"),u.state=y.CLOSE_TAG_SAW_WHITE);else{if(P(v))continue;Ce(T,v)?u.script?(u.script+="</"+v,u.state=y.SCRIPT):N(u,"Invalid tagname in closing tag."):u.tagName=v}continue;case y.CLOSE_TAG_SAW_WHITE:if(P(v))continue;v===">"?j(u):N(u,"Invalid characters in closing tag");continue;case y.TEXT_ENTITY:case y.ATTRIB_VALUE_ENTITY_Q:case y.ATTRIB_VALUE_ENTITY_U:var se,Ee;switch(u.state){case y.TEXT_ENTITY:se=y.TEXT,Ee="textNode";break;case y.ATTRIB_VALUE_ENTITY_Q:se=y.ATTRIB_VALUE_QUOTED,Ee="attribValue";break;case y.ATTRIB_VALUE_ENTITY_U:se=y.ATTRIB_VALUE_UNQUOTED,Ee="attribValue";break}if(v===";"){var ve=Z(u);u.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(ve)?(u.entity="",u.state=se,u.write(ve)):(u[Ee]+=ve,u.entity="",u.state=se)}else X(u.entity.length?$:A,v)?u.entity+=v:(N(u,"Invalid character in entity name"),u[Ee]+="&"+u.entity+v,u.entity="",u.state=se);continue;default:throw new Error(u,"Unknown state: "+u.state)}return u.position>=u.bufferCheckPosition&&i(u),u}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var p=String.fromCharCode,u=Math.floor,C=function(){var v=16384,z=[],te,se,Ee=-1,ve=arguments.length;if(!ve)return"";for(var lt="";++Ee<ve;){var de=Number(arguments[Ee]);if(!isFinite(de)||de<0||de>1114111||u(de)!==de)throw RangeError("Invalid code point: "+de);de<=65535?z.push(de):(de-=65536,te=(de>>10)+55296,se=de%1024+56320,z.push(te,se)),(Ee+1===ve||z.length>v)&&(lt+=p.apply(null,z),z.length=0)}return lt};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C}()})(e)})(Uc);Object.defineProperty(Zr,"__esModule",{value:!0});Zr.XElement=void 0;Zr.parseXml=zm;const Wm=Uc,An=mr;class kc{constructor(t){if(this.name=t,this.value="",this.attributes=null,this.isCData=!1,this.elements=null,!t)throw(0,An.newError)("Element name cannot be empty","ERR_XML_ELEMENT_NAME_EMPTY");if(!Ym(t))throw(0,An.newError)(`Invalid element name: ${t}`,"ERR_XML_ELEMENT_INVALID_NAME")}attribute(t){const r=this.attributes===null?null:this.attributes[t];if(r==null)throw(0,An.newError)(`No attribute "${t}"`,"ERR_XML_MISSED_ATTRIBUTE");return r}removeAttribute(t){this.attributes!==null&&delete this.attributes[t]}element(t,r=!1,n=null){const i=this.elementOrNull(t,r);if(i===null)throw(0,An.newError)(n||`No element "${t}"`,"ERR_XML_MISSED_ELEMENT");return i}elementOrNull(t,r=!1){if(this.elements===null)return null;for(const n of this.elements)if(cs(n,t,r))return n;return null}getElements(t,r=!1){return this.elements===null?[]:this.elements.filter(n=>cs(n,t,r))}elementValueOrEmpty(t,r=!1){const n=this.elementOrNull(t,r);return n===null?"":n.value}}Zr.XElement=kc;const Xm=new RegExp(/^[A-Za-z_][:A-Za-z0-9_-]*$/i);function Ym(e){return Xm.test(e)}function cs(e,t,r){const n=e.name;return n===t||r===!0&&n.length===t.length&&n.toLowerCase()===t.toLowerCase()}function zm(e){let t=null;const r=Wm.parser(!0,{}),n=[];return r.onopentag=i=>{const a=new kc(i.name);if(a.attributes=i.attributes,t===null)t=a;else{const o=n[n.length-1];o.elements==null&&(o.elements=[]),o.elements.push(a)}n.push(a)},r.onclosetag=()=>{n.pop()},r.ontext=i=>{n.length>0&&(n[n.length-1].value=i)},r.oncdata=i=>{const a=n[n.length-1];a.value=i,a.isCData=!0},r.onerror=i=>{throw i},r.write(e),t}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CURRENT_APP_PACKAGE_FILE_NAME=e.CURRENT_APP_INSTALLER_FILE_NAME=e.XElement=e.parseXml=e.UUID=e.parseDn=e.retry=e.githubTagPrefix=e.githubUrl=e.getS3LikeProviderBaseUrl=e.ProgressCallbackTransform=e.MemoLazy=e.safeStringifyJson=e.safeGetHeader=e.parseJson=e.HttpExecutor=e.HttpError=e.DigestTransform=e.createHttpError=e.configureRequestUrl=e.configureRequestOptionsFromUrl=e.configureRequestOptions=e.newError=e.CancellationToken=e.CancellationError=void 0,e.asArray=f;var t=wt;Object.defineProperty(e,"CancellationError",{enumerable:!0,get:function(){return t.CancellationError}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return t.CancellationToken}});var r=mr;Object.defineProperty(e,"newError",{enumerable:!0,get:function(){return r.newError}});var n=Ie;Object.defineProperty(e,"configureRequestOptions",{enumerable:!0,get:function(){return n.configureRequestOptions}}),Object.defineProperty(e,"configureRequestOptionsFromUrl",{enumerable:!0,get:function(){return n.configureRequestOptionsFromUrl}}),Object.defineProperty(e,"configureRequestUrl",{enumerable:!0,get:function(){return n.configureRequestUrl}}),Object.defineProperty(e,"createHttpError",{enumerable:!0,get:function(){return n.createHttpError}}),Object.defineProperty(e,"DigestTransform",{enumerable:!0,get:function(){return n.DigestTransform}}),Object.defineProperty(e,"HttpError",{enumerable:!0,get:function(){return n.HttpError}}),Object.defineProperty(e,"HttpExecutor",{enumerable:!0,get:function(){return n.HttpExecutor}}),Object.defineProperty(e,"parseJson",{enumerable:!0,get:function(){return n.parseJson}}),Object.defineProperty(e,"safeGetHeader",{enumerable:!0,get:function(){return n.safeGetHeader}}),Object.defineProperty(e,"safeStringifyJson",{enumerable:!0,get:function(){return n.safeStringifyJson}});var i=ai;Object.defineProperty(e,"MemoLazy",{enumerable:!0,get:function(){return i.MemoLazy}});var a=Jr;Object.defineProperty(e,"ProgressCallbackTransform",{enumerable:!0,get:function(){return a.ProgressCallbackTransform}});var o=Qr;Object.defineProperty(e,"getS3LikeProviderBaseUrl",{enumerable:!0,get:function(){return o.getS3LikeProviderBaseUrl}}),Object.defineProperty(e,"githubUrl",{enumerable:!0,get:function(){return o.githubUrl}}),Object.defineProperty(e,"githubTagPrefix",{enumerable:!0,get:function(){return o.githubTagPrefix}});var s=Ga;Object.defineProperty(e,"retry",{enumerable:!0,get:function(){return s.retry}});var l=qa;Object.defineProperty(e,"parseDn",{enumerable:!0,get:function(){return l.parseDn}});var h=fr;Object.defineProperty(e,"UUID",{enumerable:!0,get:function(){return h.UUID}});var c=Zr;Object.defineProperty(e,"parseXml",{enumerable:!0,get:function(){return c.parseXml}}),Object.defineProperty(e,"XElement",{enumerable:!0,get:function(){return c.XElement}}),e.CURRENT_APP_INSTALLER_FILE_NAME="installer.exe",e.CURRENT_APP_PACKAGE_FILE_NAME="package.7z";function f(d){return d==null?[]:Array.isArray(d)?d:[d]}})(he);var _e={},Va={},Xe={};function Mc(e){return typeof e>"u"||e===null}function Km(e){return typeof e=="object"&&e!==null}function Jm(e){return Array.isArray(e)?e:Mc(e)?[]:[e]}function Qm(e,t){var r,n,i,a;if(t)for(a=Object.keys(t),r=0,n=a.length;r<n;r+=1)i=a[r],e[i]=t[i];return e}function Zm(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function eg(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}Xe.isNothing=Mc;Xe.isObject=Km;Xe.toArray=Jm;Xe.repeat=Zm;Xe.isNegativeZero=eg;Xe.extend=Qm;function Bc(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function Mr(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Bc(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Mr.prototype=Object.create(Error.prototype);Mr.prototype.constructor=Mr;Mr.prototype.toString=function(t){return this.name+": "+Bc(this,t)};var en=Mr,Rr=Xe;function Hi(e,t,r,n,i){var a="",o="",s=Math.floor(i/2)-1;return n-t>s&&(a=" ... ",t=n-s+a.length),r-n>s&&(o=" ...",r=n+s-o.length),{str:a+e.slice(t,r).replace(/\t/g,"→")+o,pos:n-t+a.length}}function ji(e,t){return Rr.repeat(" ",t-e.length)+e}function tg(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],a,o=-1;a=r.exec(e.buffer);)i.push(a.index),n.push(a.index+a[0].length),e.position<=a.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var s="",l,h,c=Math.min(e.line+t.linesAfter,i.length).toString().length,f=t.maxLength-(t.indent+c+3);for(l=1;l<=t.linesBefore&&!(o-l<0);l++)h=Hi(e.buffer,n[o-l],i[o-l],e.position-(n[o]-n[o-l]),f),s=Rr.repeat(" ",t.indent)+ji((e.line-l+1).toString(),c)+" | "+h.str+`
`+s;for(h=Hi(e.buffer,n[o],i[o],e.position,f),s+=Rr.repeat(" ",t.indent)+ji((e.line+1).toString(),c)+" | "+h.str+`
`,s+=Rr.repeat("-",t.indent+c+3+h.pos)+`^
`,l=1;l<=t.linesAfter&&!(o+l>=i.length);l++)h=Hi(e.buffer,n[o+l],i[o+l],e.position-(n[o]-n[o+l]),f),s+=Rr.repeat(" ",t.indent)+ji((e.line+l+1).toString(),c)+" | "+h.str+`
`;return s.replace(/\n$/,"")}var rg=tg,us=en,ng=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],ig=["scalar","sequence","mapping"];function ag(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function og(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(ng.indexOf(r)===-1)throw new us('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=ag(t.styleAliases||null),ig.indexOf(this.kind)===-1)throw new us('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Fe=og,Sr=en,Gi=Fe;function fs(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(a,o){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(i=o)}),r[i]=n}),r}function sg(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function va(e){return this.extend(e)}va.prototype.extend=function(t){var r=[],n=[];if(t instanceof Gi)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new Sr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof Gi))throw new Sr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new Sr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new Sr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof Gi))throw new Sr("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(va.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=fs(i,"implicit"),i.compiledExplicit=fs(i,"explicit"),i.compiledTypeMap=sg(i.compiledImplicit,i.compiledExplicit),i};var Hc=va,lg=Fe,jc=new lg("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),cg=Fe,Gc=new cg("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),ug=Fe,qc=new ug("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),fg=Hc,Vc=new fg({explicit:[jc,Gc,qc]}),dg=Fe;function hg(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function pg(){return null}function mg(e){return e===null}var Wc=new dg("tag:yaml.org,2002:null",{kind:"scalar",resolve:hg,construct:pg,predicate:mg,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),gg=Fe;function Eg(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function yg(e){return e==="true"||e==="True"||e==="TRUE"}function wg(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Xc=new gg("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Eg,construct:yg,predicate:wg,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"}),_g=Xe,vg=Fe;function Tg(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Ag(e){return 48<=e&&e<=55}function Sg(e){return 48<=e&&e<=57}function Cg(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!Tg(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!Ag(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!Sg(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function Ng(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function bg(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!_g.isNegativeZero(e)}var Yc=new vg("tag:yaml.org,2002:int",{kind:"scalar",resolve:Cg,construct:Ng,predicate:bg,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),zc=Xe,Rg=Fe,Ig=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Og(e){return!(e===null||!Ig.test(e)||e[e.length-1]==="_")}function Dg(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var Pg=/^[-+]?[0-9]+e/;function Fg(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(zc.isNegativeZero(e))return"-0.0";return r=e.toString(10),Pg.test(r)?r.replace("e",".e"):r}function $g(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||zc.isNegativeZero(e))}var Kc=new Rg("tag:yaml.org,2002:float",{kind:"scalar",resolve:Og,construct:Dg,predicate:$g,represent:Fg,defaultStyle:"lowercase"}),Jc=Vc.extend({implicit:[Wc,Xc,Yc,Kc]}),Qc=Jc,Lg=Fe,Zc=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),eu=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function xg(e){return e===null?!1:Zc.exec(e)!==null||eu.exec(e)!==null}function Ug(e){var t,r,n,i,a,o,s,l=0,h=null,c,f,d;if(t=Zc.exec(e),t===null&&(t=eu.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(a=+t[4],o=+t[5],s=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(c=+t[10],f=+(t[11]||0),h=(c*60+f)*6e4,t[9]==="-"&&(h=-h)),d=new Date(Date.UTC(r,n,i,a,o,s,l)),h&&d.setTime(d.getTime()-h),d}function kg(e){return e.toISOString()}var tu=new Lg("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:xg,construct:Ug,instanceOf:Date,represent:kg}),Mg=Fe;function Bg(e){return e==="<<"||e===null}var ru=new Mg("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Bg}),Hg=Fe,Wa=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function jg(e){if(e===null)return!1;var t,r,n=0,i=e.length,a=Wa;for(r=0;r<i;r++)if(t=a.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function Gg(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,a=Wa,o=0,s=[];for(t=0;t<i;t++)t%4===0&&t&&(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)),o=o<<6|a.indexOf(n.charAt(t));return r=i%4*6,r===0?(s.push(o>>16&255),s.push(o>>8&255),s.push(o&255)):r===18?(s.push(o>>10&255),s.push(o>>2&255)):r===12&&s.push(o>>4&255),new Uint8Array(s)}function qg(e){var t="",r=0,n,i,a=e.length,o=Wa;for(n=0;n<a;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=a%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function Vg(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var nu=new Hg("tag:yaml.org,2002:binary",{kind:"scalar",resolve:jg,construct:Gg,predicate:Vg,represent:qg}),Wg=Fe,Xg=Object.prototype.hasOwnProperty,Yg=Object.prototype.toString;function zg(e){if(e===null)return!0;var t=[],r,n,i,a,o,s=e;for(r=0,n=s.length;r<n;r+=1){if(i=s[r],o=!1,Yg.call(i)!=="[object Object]")return!1;for(a in i)if(Xg.call(i,a))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(a)===-1)t.push(a);else return!1}return!0}function Kg(e){return e!==null?e:[]}var iu=new Wg("tag:yaml.org,2002:omap",{kind:"sequence",resolve:zg,construct:Kg}),Jg=Fe,Qg=Object.prototype.toString;function Zg(e){if(e===null)return!0;var t,r,n,i,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],Qg.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;a[t]=[i[0],n[i[0]]]}return!0}function e0(e){if(e===null)return[];var t,r,n,i,a,o=e;for(a=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),a[t]=[i[0],n[i[0]]];return a}var au=new Jg("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Zg,construct:e0}),t0=Fe,r0=Object.prototype.hasOwnProperty;function n0(e){if(e===null)return!0;var t,r=e;for(t in r)if(r0.call(r,t)&&r[t]!==null)return!1;return!0}function i0(e){return e!==null?e:{}}var ou=new t0("tag:yaml.org,2002:set",{kind:"mapping",resolve:n0,construct:i0}),Xa=Qc.extend({implicit:[tu,ru],explicit:[nu,iu,au,ou]}),$t=Xe,su=en,a0=rg,o0=Xa,_t=Object.prototype.hasOwnProperty,qn=1,lu=2,cu=3,Vn=4,qi=1,s0=2,ds=3,l0=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c0=/[\x85\u2028\u2029]/,u0=/[,\[\]\{\}]/,uu=/^(?:!|!!|![a-z\-]+!)$/i,fu=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function hs(e){return Object.prototype.toString.call(e)}function tt(e){return e===10||e===13}function Ut(e){return e===9||e===32}function Ue(e){return e===9||e===32||e===10||e===13}function er(e){return e===44||e===91||e===93||e===123||e===125}function f0(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function d0(e){return e===120?2:e===117?4:e===85?8:0}function h0(e){return 48<=e&&e<=57?e-48:-1}function ps(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function p0(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function du(e,t,r){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:r}):e[t]=r}var hu=new Array(256),pu=new Array(256);for(var Xt=0;Xt<256;Xt++)hu[Xt]=ps(Xt)?1:0,pu[Xt]=ps(Xt);function m0(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||o0,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function mu(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=a0(r),new su(t,r)}function U(e,t){throw mu(e,t)}function Wn(e,t){e.onWarning&&e.onWarning.call(null,mu(e,t))}var ms={YAML:function(t,r,n){var i,a,o;t.version!==null&&U(t,"duplication of %YAML directive"),n.length!==1&&U(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&U(t,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),o=parseInt(i[2],10),a!==1&&U(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&Wn(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,a;n.length!==2&&U(t,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],uu.test(i)||U(t,"ill-formed tag handle (first argument) of the TAG directive"),_t.call(t.tagMap,i)&&U(t,'there is a previously declared suffix for "'+i+'" tag handle'),fu.test(a)||U(t,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{U(t,"tag prefix is malformed: "+a)}t.tagMap[i]=a}};function Et(e,t,r,n){var i,a,o,s;if(t<r){if(s=e.input.slice(t,r),n)for(i=0,a=s.length;i<a;i+=1)o=s.charCodeAt(i),o===9||32<=o&&o<=1114111||U(e,"expected valid JSON character");else l0.test(s)&&U(e,"the stream contains non-printable characters");e.result+=s}}function gs(e,t,r,n){var i,a,o,s;for($t.isObject(r)||U(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,s=i.length;o<s;o+=1)a=i[o],_t.call(t,a)||(du(t,a,r[a]),n[a]=!0)}function tr(e,t,r,n,i,a,o,s,l){var h,c;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),h=0,c=i.length;h<c;h+=1)Array.isArray(i[h])&&U(e,"nested arrays are not supported inside keys"),typeof i=="object"&&hs(i[h])==="[object Object]"&&(i[h]="[object Object]");if(typeof i=="object"&&hs(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(h=0,c=a.length;h<c;h+=1)gs(e,t,a[h],r);else gs(e,t,a,r);else!e.json&&!_t.call(r,i)&&_t.call(t,i)&&(e.line=o||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,U(e,"duplicated mapping key")),du(t,i,a),delete r[i];return t}function Ya(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):U(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ce(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;Ut(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(tt(i))for(Ya(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&Wn(e,"deficient indentation"),n}function oi(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Ue(r)))}function za(e,t){t===1?e.result+=" ":t>1&&(e.result+=$t.repeat(`
`,t-1))}function g0(e,t,r){var n,i,a,o,s,l,h,c,f=e.kind,d=e.result,m;if(m=e.input.charCodeAt(e.position),Ue(m)||er(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(i=e.input.charCodeAt(e.position+1),Ue(i)||r&&er(i)))return!1;for(e.kind="scalar",e.result="",a=o=e.position,s=!1;m!==0;){if(m===58){if(i=e.input.charCodeAt(e.position+1),Ue(i)||r&&er(i))break}else if(m===35){if(n=e.input.charCodeAt(e.position-1),Ue(n))break}else{if(e.position===e.lineStart&&oi(e)||r&&er(m))break;if(tt(m))if(l=e.line,h=e.lineStart,c=e.lineIndent,ce(e,!1,-1),e.lineIndent>=t){s=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=l,e.lineStart=h,e.lineIndent=c;break}}s&&(Et(e,a,o,!1),za(e,e.line-l),a=o=e.position,s=!1),Ut(m)||(o=e.position+1),m=e.input.charCodeAt(++e.position)}return Et(e,a,o,!1),e.result?!0:(e.kind=f,e.result=d,!1)}function E0(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(Et(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else tt(r)?(Et(e,n,i,!0),za(e,ce(e,!1,t)),n=i=e.position):e.position===e.lineStart&&oi(e)?U(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);U(e,"unexpected end of the stream within a single quoted scalar")}function y0(e,t){var r,n,i,a,o,s;if(s=e.input.charCodeAt(e.position),s!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(s=e.input.charCodeAt(e.position))!==0;){if(s===34)return Et(e,r,e.position,!0),e.position++,!0;if(s===92){if(Et(e,r,e.position,!0),s=e.input.charCodeAt(++e.position),tt(s))ce(e,!1,t);else if(s<256&&hu[s])e.result+=pu[s],e.position++;else if((o=d0(s))>0){for(i=o,a=0;i>0;i--)s=e.input.charCodeAt(++e.position),(o=f0(s))>=0?a=(a<<4)+o:U(e,"expected hexadecimal character");e.result+=p0(a),e.position++}else U(e,"unknown escape sequence");r=n=e.position}else tt(s)?(Et(e,r,n,!0),za(e,ce(e,!1,t)),r=n=e.position):e.position===e.lineStart&&oi(e)?U(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}U(e,"unexpected end of the stream within a double quoted scalar")}function w0(e,t){var r=!0,n,i,a,o=e.tag,s,l=e.anchor,h,c,f,d,m,w=Object.create(null),E,T,S,A;if(A=e.input.charCodeAt(e.position),A===91)c=93,m=!1,s=[];else if(A===123)c=125,m=!0,s={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),A=e.input.charCodeAt(++e.position);A!==0;){if(ce(e,!0,t),A=e.input.charCodeAt(e.position),A===c)return e.position++,e.tag=o,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=s,!0;r?A===44&&U(e,"expected the node content, but found ','"):U(e,"missed comma between flow collection entries"),T=E=S=null,f=d=!1,A===63&&(h=e.input.charCodeAt(e.position+1),Ue(h)&&(f=d=!0,e.position++,ce(e,!0,t))),n=e.line,i=e.lineStart,a=e.position,dr(e,t,qn,!1,!0),T=e.tag,E=e.result,ce(e,!0,t),A=e.input.charCodeAt(e.position),(d||e.line===n)&&A===58&&(f=!0,A=e.input.charCodeAt(++e.position),ce(e,!0,t),dr(e,t,qn,!1,!0),S=e.result),m?tr(e,s,w,T,E,S,n,i,a):f?s.push(tr(e,null,w,T,E,S,n,i,a)):s.push(E),ce(e,!0,t),A=e.input.charCodeAt(e.position),A===44?(r=!0,A=e.input.charCodeAt(++e.position)):r=!1}U(e,"unexpected end of the stream within a flow collection")}function _0(e,t){var r,n,i=qi,a=!1,o=!1,s=t,l=0,h=!1,c,f;if(f=e.input.charCodeAt(e.position),f===124)n=!1;else if(f===62)n=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)qi===i?i=f===43?ds:s0:U(e,"repeat of a chomping mode identifier");else if((c=h0(f))>=0)c===0?U(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?U(e,"repeat of an indentation width identifier"):(s=t+c-1,o=!0);else break;if(Ut(f)){do f=e.input.charCodeAt(++e.position);while(Ut(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!tt(f)&&f!==0)}for(;f!==0;){for(Ya(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<s)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>s&&(s=e.lineIndent),tt(f)){l++;continue}if(e.lineIndent<s){i===ds?e.result+=$t.repeat(`
`,a?1+l:l):i===qi&&a&&(e.result+=`
`);break}for(n?Ut(f)?(h=!0,e.result+=$t.repeat(`
`,a?1+l:l)):h?(h=!1,e.result+=$t.repeat(`
`,l+1)):l===0?a&&(e.result+=" "):e.result+=$t.repeat(`
`,l):e.result+=$t.repeat(`
`,a?1+l:l),a=!0,o=!0,l=0,r=e.position;!tt(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Et(e,r,e.position,!1)}return!0}function Es(e,t){var r,n=e.tag,i=e.anchor,a=[],o,s=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,U(e,"tab characters must not be used in indentation")),!(l!==45||(o=e.input.charCodeAt(e.position+1),!Ue(o))));){if(s=!0,e.position++,ce(e,!0,-1)&&e.lineIndent<=t){a.push(null),l=e.input.charCodeAt(e.position);continue}if(r=e.line,dr(e,t,cu,!1,!0),a.push(e.result),ce(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&l!==0)U(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return s?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=a,!0):!1}function v0(e,t,r){var n,i,a,o,s,l,h=e.tag,c=e.anchor,f={},d=Object.create(null),m=null,w=null,E=null,T=!1,S=!1,A;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),A=e.input.charCodeAt(e.position);A!==0;){if(!T&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,U(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),a=e.line,(A===63||A===58)&&Ue(n))A===63?(T&&(tr(e,f,d,m,w,null,o,s,l),m=w=E=null),S=!0,T=!0,i=!0):T?(T=!1,i=!0):U(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,A=n;else{if(o=e.line,s=e.lineStart,l=e.position,!dr(e,r,lu,!1,!0))break;if(e.line===a){for(A=e.input.charCodeAt(e.position);Ut(A);)A=e.input.charCodeAt(++e.position);if(A===58)A=e.input.charCodeAt(++e.position),Ue(A)||U(e,"a whitespace character is expected after the key-value separator within a block mapping"),T&&(tr(e,f,d,m,w,null,o,s,l),m=w=E=null),S=!0,T=!1,i=!1,m=e.tag,w=e.result;else if(S)U(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=h,e.anchor=c,!0}else if(S)U(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=h,e.anchor=c,!0}if((e.line===a||e.lineIndent>t)&&(T&&(o=e.line,s=e.lineStart,l=e.position),dr(e,t,Vn,!0,i)&&(T?w=e.result:E=e.result),T||(tr(e,f,d,m,w,E,o,s,l),m=w=E=null),ce(e,!0,-1),A=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>t)&&A!==0)U(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return T&&tr(e,f,d,m,w,null,o,s,l),S&&(e.tag=h,e.anchor=c,e.kind="mapping",e.result=f),S}function T0(e){var t,r=!1,n=!1,i,a,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&U(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(a=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):U(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Ue(o);)o===33&&(n?U(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),uu.test(i)||U(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),u0.test(a)&&U(e,"tag suffix cannot contain flow indicator characters")}a&&!fu.test(a)&&U(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{U(e,"tag name is malformed: "+a)}return r?e.tag=a:_t.call(e.tagMap,i)?e.tag=e.tagMap[i]+a:i==="!"?e.tag="!"+a:i==="!!"?e.tag="tag:yaml.org,2002:"+a:U(e,'undeclared tag handle "'+i+'"'),!0}function A0(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&U(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ue(r)&&!er(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&U(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function S0(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ue(n)&&!er(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&U(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),_t.call(e.anchorMap,r)||U(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],ce(e,!0,-1),!0}function dr(e,t,r,n,i){var a,o,s,l=1,h=!1,c=!1,f,d,m,w,E,T;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=o=s=Vn===r||cu===r,n&&ce(e,!0,-1)&&(h=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;T0(e)||A0(e);)ce(e,!0,-1)?(h=!0,s=a,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):s=!1;if(s&&(s=h||i),(l===1||Vn===r)&&(qn===r||lu===r?E=t:E=t+1,T=e.position-e.lineStart,l===1?s&&(Es(e,T)||v0(e,T,E))||w0(e,E)?c=!0:(o&&_0(e,E)||E0(e,E)||y0(e,E)?c=!0:S0(e)?(c=!0,(e.tag!==null||e.anchor!==null)&&U(e,"alias node should not have any properties")):g0(e,E,qn===r)&&(c=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(c=s&&Es(e,T))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&U(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,d=e.implicitTypes.length;f<d;f+=1)if(w=e.implicitTypes[f],w.resolve(e.result)){e.result=w.construct(e.result),e.tag=w.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(_t.call(e.typeMap[e.kind||"fallback"],e.tag))w=e.typeMap[e.kind||"fallback"][e.tag];else for(w=null,m=e.typeMap.multi[e.kind||"fallback"],f=0,d=m.length;f<d;f+=1)if(e.tag.slice(0,m[f].tag.length)===m[f].tag){w=m[f];break}w||U(e,"unknown tag !<"+e.tag+">"),e.result!==null&&w.kind!==e.kind&&U(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+w.kind+'", not "'+e.kind+'"'),w.resolve(e.result,e.tag)?(e.result=w.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):U(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||c}function C0(e){var t=e.position,r,n,i,a=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(ce(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(a=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Ue(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&U(e,"directive name must not be less than one character in length");o!==0;){for(;Ut(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!tt(o));break}if(tt(o))break;for(r=e.position;o!==0&&!Ue(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&Ya(e),_t.call(ms,n)?ms[n](e,n,i):Wn(e,'unknown document directive "'+n+'"')}if(ce(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ce(e,!0,-1)):a&&U(e,"directives end mark is expected"),dr(e,e.lineIndent-1,Vn,!1,!0),ce(e,!0,-1),e.checkLineBreaks&&c0.test(e.input.slice(t,e.position))&&Wn(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&oi(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ce(e,!0,-1));return}if(e.position<e.length-1)U(e,"end of the stream or a document separator is expected");else return}function gu(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new m0(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,U(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)C0(r);return r.documents}function N0(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=gu(e,r);if(typeof t!="function")return n;for(var i=0,a=n.length;i<a;i+=1)t(n[i])}function b0(e,t){var r=gu(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new su("expected a single document in the stream, but found more")}}Va.loadAll=N0;Va.load=b0;var Eu={},si=Xe,tn=en,R0=Xa,yu=Object.prototype.toString,wu=Object.prototype.hasOwnProperty,Ka=65279,I0=9,Br=10,O0=13,D0=32,P0=33,F0=34,Ta=35,$0=37,L0=38,x0=39,U0=42,_u=44,k0=45,Xn=58,M0=61,B0=62,H0=63,j0=64,vu=91,Tu=93,G0=96,Au=123,q0=124,Su=125,Se={};Se[0]="\\0";Se[7]="\\a";Se[8]="\\b";Se[9]="\\t";Se[10]="\\n";Se[11]="\\v";Se[12]="\\f";Se[13]="\\r";Se[27]="\\e";Se[34]='\\"';Se[92]="\\\\";Se[133]="\\N";Se[160]="\\_";Se[8232]="\\L";Se[8233]="\\P";var V0=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],W0=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function X0(e,t){var r,n,i,a,o,s,l;if(t===null)return{};for(r={},n=Object.keys(t),i=0,a=n.length;i<a;i+=1)o=n[i],s=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=e.compiledTypeMap.fallback[o],l&&wu.call(l.styleAliases,s)&&(s=l.styleAliases[s]),r[o]=s;return r}function Y0(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new tn("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+si.repeat("0",n-t.length)+t}var z0=1,Hr=2;function K0(e){this.schema=e.schema||R0,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=si.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=X0(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Hr:z0,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function ys(e,t){for(var r=si.repeat(" ",t),n=0,i=-1,a="",o,s=e.length;n<s;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=s):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(a+=r),a+=o;return a}function Aa(e,t){return`
`+si.repeat(" ",e.indent*t)}function J0(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function Yn(e){return e===D0||e===I0}function jr(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Ka||65536<=e&&e<=1114111}function ws(e){return jr(e)&&e!==Ka&&e!==O0&&e!==Br}function _s(e,t,r){var n=ws(e),i=n&&!Yn(e);return(r?n:n&&e!==_u&&e!==vu&&e!==Tu&&e!==Au&&e!==Su)&&e!==Ta&&!(t===Xn&&!i)||ws(t)&&!Yn(t)&&e===Ta||t===Xn&&i}function Q0(e){return jr(e)&&e!==Ka&&!Yn(e)&&e!==k0&&e!==H0&&e!==Xn&&e!==_u&&e!==vu&&e!==Tu&&e!==Au&&e!==Su&&e!==Ta&&e!==L0&&e!==U0&&e!==P0&&e!==q0&&e!==M0&&e!==B0&&e!==x0&&e!==F0&&e!==$0&&e!==j0&&e!==G0}function Z0(e){return!Yn(e)&&e!==Xn}function Ir(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function Cu(e){var t=/^\n* /;return t.test(e)}var Nu=1,Sa=2,bu=3,Ru=4,Qt=5;function eE(e,t,r,n,i,a,o,s){var l,h=0,c=null,f=!1,d=!1,m=n!==-1,w=-1,E=Q0(Ir(e,0))&&Z0(Ir(e,e.length-1));if(t||o)for(l=0;l<e.length;h>=65536?l+=2:l++){if(h=Ir(e,l),!jr(h))return Qt;E=E&&_s(h,c,s),c=h}else{for(l=0;l<e.length;h>=65536?l+=2:l++){if(h=Ir(e,l),h===Br)f=!0,m&&(d=d||l-w-1>n&&e[w+1]!==" ",w=l);else if(!jr(h))return Qt;E=E&&_s(h,c,s),c=h}d=d||m&&l-w-1>n&&e[w+1]!==" "}return!f&&!d?E&&!o&&!i(e)?Nu:a===Hr?Qt:Sa:r>9&&Cu(e)?Qt:o?a===Hr?Qt:Sa:d?Ru:bu}function tE(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===Hr?'""':"''";if(!e.noCompatMode&&(V0.indexOf(t)!==-1||W0.test(t)))return e.quotingType===Hr?'"'+t+'"':"'"+t+"'";var a=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),s=n||e.flowLevel>-1&&r>=e.flowLevel;function l(h){return J0(e,h)}switch(eE(t,s,e.indent,o,l,e.quotingType,e.forceQuotes&&!n,i)){case Nu:return t;case Sa:return"'"+t.replace(/'/g,"''")+"'";case bu:return"|"+vs(t,e.indent)+Ts(ys(t,a));case Ru:return">"+vs(t,e.indent)+Ts(ys(rE(t,o),a));case Qt:return'"'+nE(t)+'"';default:throw new tn("impossible error: invalid scalar style")}}()}function vs(e,t){var r=Cu(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),a=i?"+":n?"":"-";return r+a+`
`}function Ts(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function rE(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var h=e.indexOf(`
`);return h=h!==-1?h:e.length,r.lastIndex=h,As(e.slice(0,h),t)}(),i=e[0]===`
`||e[0]===" ",a,o;o=r.exec(e);){var s=o[1],l=o[2];a=l[0]===" ",n+=s+(!i&&!a&&l!==""?`
`:"")+As(l,t),i=a}return n}function As(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,a,o=0,s=0,l="";n=r.exec(e);)s=n.index,s-i>t&&(a=o>i?o:s,l+=`
`+e.slice(i,a),i=a+1),o=s;return l+=`
`,e.length-i>t&&o>i?l+=e.slice(i,o)+`
`+e.slice(o+1):l+=e.slice(i),l.slice(1)}function nE(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=Ir(e,i),n=Se[r],!n&&jr(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||Y0(r);return t}function iE(e,t,r){var n="",i=e.tag,a,o,s;for(a=0,o=r.length;a<o;a+=1)s=r[a],e.replacer&&(s=e.replacer.call(r,String(a),s)),(ot(e,t,s,!1,!1)||typeof s>"u"&&ot(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function Ss(e,t,r,n){var i="",a=e.tag,o,s,l;for(o=0,s=r.length;o<s;o+=1)l=r[o],e.replacer&&(l=e.replacer.call(r,String(o),l)),(ot(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&ot(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=Aa(e,t)),e.dump&&Br===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=a,e.dump=i||"[]"}function aE(e,t,r){var n="",i=e.tag,a=Object.keys(r),o,s,l,h,c;for(o=0,s=a.length;o<s;o+=1)c="",n!==""&&(c+=", "),e.condenseFlow&&(c+='"'),l=a[o],h=r[l],e.replacer&&(h=e.replacer.call(r,l,h)),ot(e,t,l,!1,!1)&&(e.dump.length>1024&&(c+="? "),c+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),ot(e,t,h,!1,!1)&&(c+=e.dump,n+=c));e.tag=i,e.dump="{"+n+"}"}function oE(e,t,r,n){var i="",a=e.tag,o=Object.keys(r),s,l,h,c,f,d;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new tn("sortKeys must be a boolean or a function");for(s=0,l=o.length;s<l;s+=1)d="",(!n||i!=="")&&(d+=Aa(e,t)),h=o[s],c=r[h],e.replacer&&(c=e.replacer.call(r,h,c)),ot(e,t+1,h,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&Br===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,f&&(d+=Aa(e,t)),ot(e,t+1,c,!0,f)&&(e.dump&&Br===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,i+=d));e.tag=a,e.dump=i||"{}"}function Cs(e,t,r){var n,i,a,o,s,l;for(i=r?e.explicitTypes:e.implicitTypes,a=0,o=i.length;a<o;a+=1)if(s=i[a],(s.instanceOf||s.predicate)&&(!s.instanceOf||typeof t=="object"&&t instanceof s.instanceOf)&&(!s.predicate||s.predicate(t))){if(r?s.multi&&s.representName?e.tag=s.representName(t):e.tag=s.tag:e.tag="?",s.represent){if(l=e.styleMap[s.tag]||s.defaultStyle,yu.call(s.represent)==="[object Function]")n=s.represent(t,l);else if(wu.call(s.represent,l))n=s.represent[l](t,l);else throw new tn("!<"+s.tag+'> tag resolver accepts not "'+l+'" style');e.dump=n}return!0}return!1}function ot(e,t,r,n,i,a,o){e.tag=null,e.dump=r,Cs(e,r,!1)||Cs(e,r,!0);var s=yu.call(e.dump),l=n,h;n&&(n=e.flowLevel<0||e.flowLevel>t);var c=s==="[object Object]"||s==="[object Array]",f,d;if(c&&(f=e.duplicates.indexOf(r),d=f!==-1),(e.tag!==null&&e.tag!=="?"||d||e.indent!==2&&t>0)&&(i=!1),d&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(c&&d&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),s==="[object Object]")n&&Object.keys(e.dump).length!==0?(oE(e,t,e.dump,i),d&&(e.dump="&ref_"+f+e.dump)):(aE(e,t,e.dump),d&&(e.dump="&ref_"+f+" "+e.dump));else if(s==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?Ss(e,t-1,e.dump,i):Ss(e,t,e.dump,i),d&&(e.dump="&ref_"+f+e.dump)):(iE(e,t,e.dump),d&&(e.dump="&ref_"+f+" "+e.dump));else if(s==="[object String]")e.tag!=="?"&&tE(e,e.dump,t,a,l);else{if(s==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new tn("unacceptable kind of an object to dump "+s)}e.tag!==null&&e.tag!=="?"&&(h=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?h="!"+h:h.slice(0,18)==="tag:yaml.org,2002:"?h="!!"+h.slice(18):h="!<"+h+">",e.dump=h+" "+e.dump)}return!0}function sE(e,t){var r=[],n=[],i,a;for(Ca(e,r,n),i=0,a=n.length;i<a;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(a)}function Ca(e,t,r){var n,i,a;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,a=e.length;i<a;i+=1)Ca(e[i],t,r);else for(n=Object.keys(e),i=0,a=n.length;i<a;i+=1)Ca(e[n[i]],t,r)}function lE(e,t){t=t||{};var r=new K0(t);r.noRefs||sE(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),ot(r,0,n,!0,!0)?r.dump+`
`:""}Eu.dump=lE;var Iu=Va,cE=Eu;function Ja(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}_e.Type=Fe;_e.Schema=Hc;_e.FAILSAFE_SCHEMA=Vc;_e.JSON_SCHEMA=Jc;_e.CORE_SCHEMA=Qc;_e.DEFAULT_SCHEMA=Xa;_e.load=Iu.load;_e.loadAll=Iu.loadAll;_e.dump=cE.dump;_e.YAMLException=en;_e.types={binary:nu,float:Kc,map:qc,null:Wc,pairs:au,set:ou,timestamp:tu,bool:Xc,int:Yc,merge:ru,omap:iu,seq:Gc,str:jc};_e.safeLoad=Ja("safeLoad","load");_e.safeLoadAll=Ja("safeLoadAll","loadAll");_e.safeDump=Ja("safeDump","dump");var li={};Object.defineProperty(li,"__esModule",{value:!0});li.Lazy=void 0;class uE{constructor(t){this._value=null,this.creator=t}get hasValue(){return this.creator==null}get value(){if(this.creator==null)return this._value;const t=this.creator();return this.value=t,t}set value(t){this._value=t,this.creator=null}}li.Lazy=uE;var Na={exports:{}};const fE="2.0.0",Ou=256,dE=Number.MAX_SAFE_INTEGER||9007199254740991,hE=16,pE=Ou-6,mE=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ci={MAX_LENGTH:Ou,MAX_SAFE_COMPONENT_LENGTH:hE,MAX_SAFE_BUILD_LENGTH:pE,MAX_SAFE_INTEGER:dE,RELEASE_TYPES:mE,SEMVER_SPEC_VERSION:fE,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const gE=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var ui=gE;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=ci,a=ui;t=e.exports={};const o=t.re=[],s=t.safeRe=[],l=t.src=[],h=t.safeSrc=[],c=t.t={};let f=0;const d="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",i],[d,n]],w=T=>{for(const[S,A]of m)T=T.split(`${S}*`).join(`${S}{0,${A}}`).split(`${S}+`).join(`${S}{1,${A}}`);return T},E=(T,S,A)=>{const $=w(S),P=f++;a(T,P,S),c[T]=P,l[P]=S,h[P]=$,o[P]=new RegExp(S,A?"g":void 0),s[P]=new RegExp($,A?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),E("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${l[c.NONNUMERICIDENTIFIER]}|${l[c.NUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NONNUMERICIDENTIFIER]}|${l[c.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${d}+`),E("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),E("FULL",`^${l[c.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),E("LOOSE",`^${l[c.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),E("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),E("COERCE",`${l[c.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",l[c.COERCEPLAIN]+`(?:${l[c.PRERELEASE]})?(?:${l[c.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",l[c.COERCE],!0),E("COERCERTLFULL",l[c.COERCEFULL],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",E("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",E("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Na,Na.exports);var rn=Na.exports;const EE=Object.freeze({loose:!0}),yE=Object.freeze({}),wE=e=>e?typeof e!="object"?EE:e:yE;var Qa=wE;const Ns=/^[0-9]+$/,Du=(e,t)=>{if(typeof e=="number"&&typeof t=="number")return e===t?0:e<t?-1:1;const r=Ns.test(e),n=Ns.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},_E=(e,t)=>Du(t,e);var Pu={compareIdentifiers:Du,rcompareIdentifiers:_E};const Sn=ui,{MAX_LENGTH:bs,MAX_SAFE_INTEGER:Cn}=ci,{safeRe:Nn,t:bn}=rn,vE=Qa,{compareIdentifiers:Vi}=Pu;let TE=class Ze{constructor(t,r){if(r=vE(r),t instanceof Ze){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>bs)throw new TypeError(`version is longer than ${bs} characters`);Sn("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?Nn[bn.LOOSE]:Nn[bn.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Cn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Cn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Cn||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<Cn)return a}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Sn("SemVer.compare",this.version,this.options,t),!(t instanceof Ze)){if(typeof t=="string"&&t===this.version)return 0;t=new Ze(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Ze||(t=new Ze(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof Ze||(t=new Ze(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],i=t.prerelease[r];if(Sn("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Vi(n,i)}while(++r)}compareBuild(t){t instanceof Ze||(t=new Ze(t,this.options));let r=0;do{const n=this.build[r],i=t.build[r];if(Sn("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Vi(n,i)}while(++r)}inc(t,r,n){if(t.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){const i=`-${r}`.match(this.options.loose?Nn[bn.PRERELEASELOOSE]:Nn[bn.PRERELEASE]);if(!i||i[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let a=[r,i];n===!1&&(a=[r]),Vi(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var $e=TE;const Rs=$e,AE=(e,t,r=!1)=>{if(e instanceof Rs)return e;try{return new Rs(e,t)}catch(n){if(!r)return null;throw n}};var gr=AE;const SE=gr,CE=(e,t)=>{const r=SE(e,t);return r?r.version:null};var NE=CE;const bE=gr,RE=(e,t)=>{const r=bE(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};var IE=RE;const Is=$e,OE=(e,t,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new Is(e instanceof Is?e.version:e,r).inc(t,n,i).version}catch{return null}};var DE=OE;const Os=gr,PE=(e,t)=>{const r=Os(e,null,!0),n=Os(t,null,!0),i=r.compare(n);if(i===0)return null;const a=i>0,o=a?r:n,s=a?n:r,l=!!o.prerelease.length;if(!!s.prerelease.length&&!l){if(!s.patch&&!s.minor)return"major";if(s.compareMain(o)===0)return s.minor&&!s.patch?"minor":"patch"}const c=l?"pre":"";return r.major!==n.major?c+"major":r.minor!==n.minor?c+"minor":r.patch!==n.patch?c+"patch":"prerelease"};var FE=PE;const $E=$e,LE=(e,t)=>new $E(e,t).major;var xE=LE;const UE=$e,kE=(e,t)=>new UE(e,t).minor;var ME=kE;const BE=$e,HE=(e,t)=>new BE(e,t).patch;var jE=HE;const GE=gr,qE=(e,t)=>{const r=GE(e,t);return r&&r.prerelease.length?r.prerelease:null};var VE=qE;const Ds=$e,WE=(e,t,r)=>new Ds(e,r).compare(new Ds(t,r));var Ye=WE;const XE=Ye,YE=(e,t,r)=>XE(t,e,r);var zE=YE;const KE=Ye,JE=(e,t)=>KE(e,t,!0);var QE=JE;const Ps=$e,ZE=(e,t,r)=>{const n=new Ps(e,r),i=new Ps(t,r);return n.compare(i)||n.compareBuild(i)};var Za=ZE;const ey=Za,ty=(e,t)=>e.sort((r,n)=>ey(r,n,t));var ry=ty;const ny=Za,iy=(e,t)=>e.sort((r,n)=>ny(n,r,t));var ay=iy;const oy=Ye,sy=(e,t,r)=>oy(e,t,r)>0;var fi=sy;const ly=Ye,cy=(e,t,r)=>ly(e,t,r)<0;var eo=cy;const uy=Ye,fy=(e,t,r)=>uy(e,t,r)===0;var Fu=fy;const dy=Ye,hy=(e,t,r)=>dy(e,t,r)!==0;var $u=hy;const py=Ye,my=(e,t,r)=>py(e,t,r)>=0;var to=my;const gy=Ye,Ey=(e,t,r)=>gy(e,t,r)<=0;var ro=Ey;const yy=Fu,wy=$u,_y=fi,vy=to,Ty=eo,Ay=ro,Sy=(e,t,r,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return yy(e,r,n);case"!=":return wy(e,r,n);case">":return _y(e,r,n);case">=":return vy(e,r,n);case"<":return Ty(e,r,n);case"<=":return Ay(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var Lu=Sy;const Cy=$e,Ny=gr,{safeRe:Rn,t:In}=rn,by=(e,t)=>{if(e instanceof Cy)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(t.includePrerelease?Rn[In.COERCEFULL]:Rn[In.COERCE]);else{const l=t.includePrerelease?Rn[In.COERCERTLFULL]:Rn[In.COERCERTL];let h;for(;(h=l.exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||h.index+h[0].length!==r.index+r[0].length)&&(r=h),l.lastIndex=h.index+h[1].length+h[2].length;l.lastIndex=-1}if(r===null)return null;const n=r[2],i=r[3]||"0",a=r[4]||"0",o=t.includePrerelease&&r[5]?`-${r[5]}`:"",s=t.includePrerelease&&r[6]?`+${r[6]}`:"";return Ny(`${n}.${i}.${a}${o}${s}`,t)};var Ry=by;class Iy{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(t,r)}return this}}var Oy=Iy,Wi,Fs;function ze(){if(Fs)return Wi;Fs=1;const e=/\s+/g;class t{constructor(b,F){if(F=i(F),b instanceof t)return b.loose===!!F.loose&&b.includePrerelease===!!F.includePrerelease?b:new t(b.raw,F);if(b instanceof a)return this.raw=b.value,this.set=[[b]],this.formatted=void 0,this;if(this.options=F,this.loose=!!F.loose,this.includePrerelease=!!F.includePrerelease,this.raw=b.trim().replace(e," "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const N=this.set[0];if(this.set=this.set.filter(L=>!E(L[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(const L of this.set)if(L.length===1&&T(L[0])){this.set=[L];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let b=0;b<this.set.length;b++){b>0&&(this.formatted+="||");const F=this.set[b];for(let N=0;N<F.length;N++)N>0&&(this.formatted+=" "),this.formatted+=F[N].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(b){const N=((this.options.includePrerelease&&m)|(this.options.loose&&w))+":"+b,L=n.get(N);if(L)return L;const O=this.options.loose,M=O?l[h.HYPHENRANGELOOSE]:l[h.HYPHENRANGE];b=b.replace(M,B(this.options.includePrerelease)),o("hyphen replace",b),b=b.replace(l[h.COMPARATORTRIM],c),o("comparator trim",b),b=b.replace(l[h.TILDETRIM],f),o("tilde trim",b),b=b.replace(l[h.CARETTRIM],d),o("caret trim",b);let W=b.split(" ").map(k=>A(k,this.options)).join(" ").split(/\s+/).map(k=>H(k,this.options));O&&(W=W.filter(k=>(o("loose invalid filter",k,this.options),!!k.match(l[h.COMPARATORLOOSE])))),o("range list",W);const j=new Map,Z=W.map(k=>new a(k,this.options));for(const k of Z){if(E(k))return[k];j.set(k.value,k)}j.size>1&&j.has("")&&j.delete("");const pe=[...j.values()];return n.set(N,pe),pe}intersects(b,F){if(!(b instanceof t))throw new TypeError("a Range is required");return this.set.some(N=>S(N,F)&&b.set.some(L=>S(L,F)&&N.every(O=>L.every(M=>O.intersects(M,F)))))}test(b){if(!b)return!1;if(typeof b=="string")try{b=new s(b,this.options)}catch{return!1}for(let F=0;F<this.set.length;F++)if(Q(this.set[F],b,this.options))return!0;return!1}}Wi=t;const r=Oy,n=new r,i=Qa,a=di(),o=ui,s=$e,{safeRe:l,t:h,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=rn,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:w}=ci,E=I=>I.value==="<0.0.0-0",T=I=>I.value==="",S=(I,b)=>{let F=!0;const N=I.slice();let L=N.pop();for(;F&&N.length;)F=N.every(O=>L.intersects(O,b)),L=N.pop();return F},A=(I,b)=>(I=I.replace(l[h.BUILD],""),o("comp",I,b),I=ne(I,b),o("caret",I),I=P(I,b),o("tildes",I),I=Ce(I,b),o("xrange",I),I=q(I,b),o("stars",I),I),$=I=>!I||I.toLowerCase()==="x"||I==="*",P=(I,b)=>I.trim().split(/\s+/).map(F=>J(F,b)).join(" "),J=(I,b)=>{const F=b.loose?l[h.TILDELOOSE]:l[h.TILDE];return I.replace(F,(N,L,O,M,W)=>{o("tilde",I,N,L,O,M,W);let j;return $(L)?j="":$(O)?j=`>=${L}.0.0 <${+L+1}.0.0-0`:$(M)?j=`>=${L}.${O}.0 <${L}.${+O+1}.0-0`:W?(o("replaceTilde pr",W),j=`>=${L}.${O}.${M}-${W} <${L}.${+O+1}.0-0`):j=`>=${L}.${O}.${M} <${L}.${+O+1}.0-0`,o("tilde return",j),j})},ne=(I,b)=>I.trim().split(/\s+/).map(F=>X(F,b)).join(" "),X=(I,b)=>{o("caret",I,b);const F=b.loose?l[h.CARETLOOSE]:l[h.CARET],N=b.includePrerelease?"-0":"";return I.replace(F,(L,O,M,W,j)=>{o("caret",I,L,O,M,W,j);let Z;return $(O)?Z="":$(M)?Z=`>=${O}.0.0${N} <${+O+1}.0.0-0`:$(W)?O==="0"?Z=`>=${O}.${M}.0${N} <${O}.${+M+1}.0-0`:Z=`>=${O}.${M}.0${N} <${+O+1}.0.0-0`:j?(o("replaceCaret pr",j),O==="0"?M==="0"?Z=`>=${O}.${M}.${W}-${j} <${O}.${M}.${+W+1}-0`:Z=`>=${O}.${M}.${W}-${j} <${O}.${+M+1}.0-0`:Z=`>=${O}.${M}.${W}-${j} <${+O+1}.0.0-0`):(o("no pr"),O==="0"?M==="0"?Z=`>=${O}.${M}.${W}${N} <${O}.${M}.${+W+1}-0`:Z=`>=${O}.${M}.${W}${N} <${O}.${+M+1}.0-0`:Z=`>=${O}.${M}.${W} <${+O+1}.0.0-0`),o("caret return",Z),Z})},Ce=(I,b)=>(o("replaceXRanges",I,b),I.split(/\s+/).map(F=>y(F,b)).join(" ")),y=(I,b)=>{I=I.trim();const F=b.loose?l[h.XRANGELOOSE]:l[h.XRANGE];return I.replace(F,(N,L,O,M,W,j)=>{o("xRange",I,N,L,O,M,W,j);const Z=$(O),pe=Z||$(M),k=pe||$(W),Je=k;return L==="="&&Je&&(L=""),j=b.includePrerelease?"-0":"",Z?L===">"||L==="<"?N="<0.0.0-0":N="*":L&&Je?(pe&&(M=0),W=0,L===">"?(L=">=",pe?(O=+O+1,M=0,W=0):(M=+M+1,W=0)):L==="<="&&(L="<",pe?O=+O+1:M=+M+1),L==="<"&&(j="-0"),N=`${L+O}.${M}.${W}${j}`):pe?N=`>=${O}.0.0${j} <${+O+1}.0.0-0`:k&&(N=`>=${O}.${M}.0${j} <${O}.${+M+1}.0-0`),o("xRange return",N),N})},q=(I,b)=>(o("replaceStars",I,b),I.trim().replace(l[h.STAR],"")),H=(I,b)=>(o("replaceGTE0",I,b),I.trim().replace(l[b.includePrerelease?h.GTE0PRE:h.GTE0],"")),B=I=>(b,F,N,L,O,M,W,j,Z,pe,k,Je)=>($(N)?F="":$(L)?F=`>=${N}.0.0${I?"-0":""}`:$(O)?F=`>=${N}.${L}.0${I?"-0":""}`:M?F=`>=${F}`:F=`>=${F}${I?"-0":""}`,$(Z)?j="":$(pe)?j=`<${+Z+1}.0.0-0`:$(k)?j=`<${Z}.${+pe+1}.0-0`:Je?j=`<=${Z}.${pe}.${k}-${Je}`:I?j=`<${Z}.${pe}.${+k+1}-0`:j=`<=${j}`,`${F} ${j}`.trim()),Q=(I,b,F)=>{for(let N=0;N<I.length;N++)if(!I[N].test(b))return!1;if(b.prerelease.length&&!F.includePrerelease){for(let N=0;N<I.length;N++)if(o(I[N].semver),I[N].semver!==a.ANY&&I[N].semver.prerelease.length>0){const L=I[N].semver;if(L.major===b.major&&L.minor===b.minor&&L.patch===b.patch)return!0}return!1}return!0};return Wi}var Xi,$s;function di(){if($s)return Xi;$s=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=r(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const f=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new s(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new s(c,this.options)}catch{return!1}return a(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,f).test(c.semver):(f=r(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||a(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||a(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}Xi=t;const r=Qa,{safeRe:n,t:i}=rn,a=Lu,o=ui,s=$e,l=ze();return Xi}const Dy=ze(),Py=(e,t,r)=>{try{t=new Dy(t,r)}catch{return!1}return t.test(e)};var hi=Py;const Fy=ze(),$y=(e,t)=>new Fy(e,t).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));var Ly=$y;const xy=$e,Uy=ze(),ky=(e,t,r)=>{let n=null,i=null,a=null;try{a=new Uy(t,r)}catch{return null}return e.forEach(o=>{a.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new xy(n,r))}),n};var My=ky;const By=$e,Hy=ze(),jy=(e,t,r)=>{let n=null,i=null,a=null;try{a=new Hy(t,r)}catch{return null}return e.forEach(o=>{a.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new By(n,r))}),n};var Gy=jy;const Yi=$e,qy=ze(),Ls=fi,Vy=(e,t)=>{e=new qy(e,t);let r=new Yi("0.0.0");if(e.test(r)||(r=new Yi("0.0.0-0"),e.test(r)))return r;r=null;for(let n=0;n<e.set.length;++n){const i=e.set[n];let a=null;i.forEach(o=>{const s=new Yi(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||Ls(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!r||Ls(r,a))&&(r=a)}return r&&e.test(r)?r:null};var Wy=Vy;const Xy=ze(),Yy=(e,t)=>{try{return new Xy(e,t).range||"*"}catch{return null}};var zy=Yy;const Ky=$e,xu=di(),{ANY:Jy}=xu,Qy=ze(),Zy=hi,xs=fi,Us=eo,ew=ro,tw=to,rw=(e,t,r,n)=>{e=new Ky(e,n),t=new Qy(t,n);let i,a,o,s,l;switch(r){case">":i=xs,a=ew,o=Us,s=">",l=">=";break;case"<":i=Us,a=tw,o=xs,s="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Zy(e,t,n))return!1;for(let h=0;h<t.set.length;++h){const c=t.set[h];let f=null,d=null;if(c.forEach(m=>{m.semver===Jy&&(m=new xu(">=0.0.0")),f=f||m,d=d||m,i(m.semver,f.semver,n)?f=m:o(m.semver,d.semver,n)&&(d=m)}),f.operator===s||f.operator===l||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===l&&o(e,d.semver))return!1}return!0};var no=rw;const nw=no,iw=(e,t,r)=>nw(e,t,">",r);var aw=iw;const ow=no,sw=(e,t,r)=>ow(e,t,"<",r);var lw=sw;const ks=ze(),cw=(e,t,r)=>(e=new ks(e,r),t=new ks(t,r),e.intersects(t,r));var uw=cw;const fw=hi,dw=Ye;var hw=(e,t,r)=>{const n=[];let i=null,a=null;const o=e.sort((c,f)=>dw(c,f,r));for(const c of o)fw(c,t,r)?(a=c,i||(i=c)):(a&&n.push([i,a]),a=null,i=null);i&&n.push([i,null]);const s=[];for(const[c,f]of n)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const l=s.join(" || "),h=typeof t.raw=="string"?t.raw:String(t);return l.length<h.length?l:t};const Ms=ze(),io=di(),{ANY:zi}=io,Cr=hi,ao=Ye,pw=(e,t,r={})=>{if(e===t)return!0;e=new Ms(e,r),t=new Ms(t,r);let n=!1;e:for(const i of e.set){for(const a of t.set){const o=gw(i,a,r);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},mw=[new io(">=0.0.0-0")],Bs=[new io(">=0.0.0")],gw=(e,t,r)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===zi){if(t.length===1&&t[0].semver===zi)return!0;r.includePrerelease?e=mw:e=Bs}if(t.length===1&&t[0].semver===zi){if(r.includePrerelease)return!0;t=Bs}const n=new Set;let i,a;for(const m of e)m.operator===">"||m.operator===">="?i=Hs(i,m,r):m.operator==="<"||m.operator==="<="?a=js(a,m,r):n.add(m.semver);if(n.size>1)return null;let o;if(i&&a){if(o=ao(i.semver,a.semver,r),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const m of n){if(i&&!Cr(m,String(i),r)||a&&!Cr(m,String(a),r))return null;for(const w of t)if(!Cr(m,String(w),r))return!1;return!0}let s,l,h,c,f=a&&!r.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const m of t){if(c=c||m.operator===">"||m.operator===">=",h=h||m.operator==="<"||m.operator==="<=",i){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator===">"||m.operator===">="){if(s=Hs(i,m,r),s===m&&s!==i)return!1}else if(i.operator===">="&&!Cr(i.semver,String(m),r))return!1}if(a){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator==="<"||m.operator==="<="){if(l=js(a,m,r),l===m&&l!==a)return!1}else if(a.operator==="<="&&!Cr(a.semver,String(m),r))return!1}if(!m.operator&&(a||i)&&o!==0)return!1}return!(i&&h&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},Hs=(e,t,r)=>{if(!e)return t;const n=ao(e.semver,t.semver,r);return n>0?e:n<0||t.operator===">"&&e.operator===">="?t:e},js=(e,t,r)=>{if(!e)return t;const n=ao(e.semver,t.semver,r);return n<0?e:n>0||t.operator==="<"&&e.operator==="<="?t:e};var Ew=pw;const Ki=rn,Gs=ci,yw=$e,qs=Pu,ww=gr,_w=NE,vw=IE,Tw=DE,Aw=FE,Sw=xE,Cw=ME,Nw=jE,bw=VE,Rw=Ye,Iw=zE,Ow=QE,Dw=Za,Pw=ry,Fw=ay,$w=fi,Lw=eo,xw=Fu,Uw=$u,kw=to,Mw=ro,Bw=Lu,Hw=Ry,jw=di(),Gw=ze(),qw=hi,Vw=Ly,Ww=My,Xw=Gy,Yw=Wy,zw=zy,Kw=no,Jw=aw,Qw=lw,Zw=uw,e_=hw,t_=Ew;var Uu={parse:ww,valid:_w,clean:vw,inc:Tw,diff:Aw,major:Sw,minor:Cw,patch:Nw,prerelease:bw,compare:Rw,rcompare:Iw,compareLoose:Ow,compareBuild:Dw,sort:Pw,rsort:Fw,gt:$w,lt:Lw,eq:xw,neq:Uw,gte:kw,lte:Mw,cmp:Bw,coerce:Hw,Comparator:jw,Range:Gw,satisfies:qw,toComparators:Vw,maxSatisfying:Ww,minSatisfying:Xw,minVersion:Yw,validRange:zw,outside:Kw,gtr:Jw,ltr:Qw,intersects:Zw,simplifyRange:e_,subset:t_,SemVer:yw,re:Ki.re,src:Ki.src,tokens:Ki.t,SEMVER_SPEC_VERSION:Gs.SEMVER_SPEC_VERSION,RELEASE_TYPES:Gs.RELEASE_TYPES,compareIdentifiers:qs.compareIdentifiers,rcompareIdentifiers:qs.rcompareIdentifiers},nn={},zn={exports:{}};zn.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,s="[object Arguments]",l="[object Array]",h="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",m="[object Function]",w="[object GeneratorFunction]",E="[object Map]",T="[object Number]",S="[object Null]",A="[object Object]",$="[object Promise]",P="[object Proxy]",J="[object RegExp]",ne="[object Set]",X="[object String]",Ce="[object Symbol]",y="[object Undefined]",q="[object WeakMap]",H="[object ArrayBuffer]",B="[object DataView]",Q="[object Float32Array]",I="[object Float64Array]",b="[object Int8Array]",F="[object Int16Array]",N="[object Int32Array]",L="[object Uint8Array]",O="[object Uint8ClampedArray]",M="[object Uint16Array]",W="[object Uint32Array]",j=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,pe=/^(?:0|[1-9]\d*)$/,k={};k[Q]=k[I]=k[b]=k[F]=k[N]=k[L]=k[O]=k[M]=k[W]=!0,k[s]=k[l]=k[H]=k[c]=k[B]=k[f]=k[d]=k[m]=k[E]=k[T]=k[A]=k[J]=k[ne]=k[X]=k[q]=!1;var Je=typeof Re=="object"&&Re&&Re.Object===Object&&Re,p=typeof self=="object"&&self&&self.Object===Object&&self,u=Je||p||Function("return this")(),C=t&&!t.nodeType&&t,v=C&&!0&&e&&!e.nodeType&&e,z=v&&v.exports===C,te=z&&Je.process,se=function(){try{return te&&te.binding&&te.binding("util")}catch{}}(),Ee=se&&se.isTypedArray;function ve(g,_){for(var R=-1,x=g==null?0:g.length,re=0,G=[];++R<x;){var le=g[R];_(le,R,g)&&(G[re++]=le)}return G}function lt(g,_){for(var R=-1,x=_.length,re=g.length;++R<x;)g[re+R]=_[R];return g}function de(g,_){for(var R=-1,x=g==null?0:g.length;++R<x;)if(_(g[R],R,g))return!0;return!1}function je(g,_){for(var R=-1,x=Array(g);++R<g;)x[R]=_(R);return x}function Ai(g){return function(_){return g(_)}}function ln(g,_){return g.has(_)}function wr(g,_){return g==null?void 0:g[_]}function cn(g){var _=-1,R=Array(g.size);return g.forEach(function(x,re){R[++_]=[re,x]}),R}function rf(g,_){return function(R){return g(_(R))}}function nf(g){var _=-1,R=Array(g.size);return g.forEach(function(x){R[++_]=x}),R}var af=Array.prototype,of=Function.prototype,un=Object.prototype,Si=u["__core-js_shared__"],ho=of.toString,Qe=un.hasOwnProperty,po=function(){var g=/[^.]+$/.exec(Si&&Si.keys&&Si.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),mo=un.toString,sf=RegExp("^"+ho.call(Qe).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),go=z?u.Buffer:void 0,fn=u.Symbol,Eo=u.Uint8Array,yo=un.propertyIsEnumerable,lf=af.splice,Nt=fn?fn.toStringTag:void 0,wo=Object.getOwnPropertySymbols,cf=go?go.isBuffer:void 0,uf=rf(Object.keys,Object),Ci=Vt(u,"DataView"),_r=Vt(u,"Map"),Ni=Vt(u,"Promise"),bi=Vt(u,"Set"),Ri=Vt(u,"WeakMap"),vr=Vt(Object,"create"),ff=It(Ci),df=It(_r),hf=It(Ni),pf=It(bi),mf=It(Ri),_o=fn?fn.prototype:void 0,Ii=_o?_o.valueOf:void 0;function bt(g){var _=-1,R=g==null?0:g.length;for(this.clear();++_<R;){var x=g[_];this.set(x[0],x[1])}}function gf(){this.__data__=vr?vr(null):{},this.size=0}function Ef(g){var _=this.has(g)&&delete this.__data__[g];return this.size-=_?1:0,_}function yf(g){var _=this.__data__;if(vr){var R=_[g];return R===n?void 0:R}return Qe.call(_,g)?_[g]:void 0}function wf(g){var _=this.__data__;return vr?_[g]!==void 0:Qe.call(_,g)}function _f(g,_){var R=this.__data__;return this.size+=this.has(g)?0:1,R[g]=vr&&_===void 0?n:_,this}bt.prototype.clear=gf,bt.prototype.delete=Ef,bt.prototype.get=yf,bt.prototype.has=wf,bt.prototype.set=_f;function nt(g){var _=-1,R=g==null?0:g.length;for(this.clear();++_<R;){var x=g[_];this.set(x[0],x[1])}}function vf(){this.__data__=[],this.size=0}function Tf(g){var _=this.__data__,R=hn(_,g);if(R<0)return!1;var x=_.length-1;return R==x?_.pop():lf.call(_,R,1),--this.size,!0}function Af(g){var _=this.__data__,R=hn(_,g);return R<0?void 0:_[R][1]}function Sf(g){return hn(this.__data__,g)>-1}function Cf(g,_){var R=this.__data__,x=hn(R,g);return x<0?(++this.size,R.push([g,_])):R[x][1]=_,this}nt.prototype.clear=vf,nt.prototype.delete=Tf,nt.prototype.get=Af,nt.prototype.has=Sf,nt.prototype.set=Cf;function Rt(g){var _=-1,R=g==null?0:g.length;for(this.clear();++_<R;){var x=g[_];this.set(x[0],x[1])}}function Nf(){this.size=0,this.__data__={hash:new bt,map:new(_r||nt),string:new bt}}function bf(g){var _=pn(this,g).delete(g);return this.size-=_?1:0,_}function Rf(g){return pn(this,g).get(g)}function If(g){return pn(this,g).has(g)}function Of(g,_){var R=pn(this,g),x=R.size;return R.set(g,_),this.size+=R.size==x?0:1,this}Rt.prototype.clear=Nf,Rt.prototype.delete=bf,Rt.prototype.get=Rf,Rt.prototype.has=If,Rt.prototype.set=Of;function dn(g){var _=-1,R=g==null?0:g.length;for(this.__data__=new Rt;++_<R;)this.add(g[_])}function Df(g){return this.__data__.set(g,n),this}function Pf(g){return this.__data__.has(g)}dn.prototype.add=dn.prototype.push=Df,dn.prototype.has=Pf;function ct(g){var _=this.__data__=new nt(g);this.size=_.size}function Ff(){this.__data__=new nt,this.size=0}function $f(g){var _=this.__data__,R=_.delete(g);return this.size=_.size,R}function Lf(g){return this.__data__.get(g)}function xf(g){return this.__data__.has(g)}function Uf(g,_){var R=this.__data__;if(R instanceof nt){var x=R.__data__;if(!_r||x.length<r-1)return x.push([g,_]),this.size=++R.size,this;R=this.__data__=new Rt(x)}return R.set(g,_),this.size=R.size,this}ct.prototype.clear=Ff,ct.prototype.delete=$f,ct.prototype.get=Lf,ct.prototype.has=xf,ct.prototype.set=Uf;function kf(g,_){var R=mn(g),x=!R&&Zf(g),re=!R&&!x&&Oi(g),G=!R&&!x&&!re&&Io(g),le=R||x||re||G,me=le?je(g.length,String):[],ye=me.length;for(var ie in g)Qe.call(g,ie)&&!(le&&(ie=="length"||re&&(ie=="offset"||ie=="parent")||G&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||Yf(ie,ye)))&&me.push(ie);return me}function hn(g,_){for(var R=g.length;R--;)if(Co(g[R][0],_))return R;return-1}function Mf(g,_,R){var x=_(g);return mn(g)?x:lt(x,R(g))}function Tr(g){return g==null?g===void 0?y:S:Nt&&Nt in Object(g)?Wf(g):Qf(g)}function vo(g){return Ar(g)&&Tr(g)==s}function To(g,_,R,x,re){return g===_?!0:g==null||_==null||!Ar(g)&&!Ar(_)?g!==g&&_!==_:Bf(g,_,R,x,To,re)}function Bf(g,_,R,x,re,G){var le=mn(g),me=mn(_),ye=le?l:ut(g),ie=me?l:ut(_);ye=ye==s?A:ye,ie=ie==s?A:ie;var ke=ye==A,Ge=ie==A,Te=ye==ie;if(Te&&Oi(g)){if(!Oi(_))return!1;le=!0,ke=!1}if(Te&&!ke)return G||(G=new ct),le||Io(g)?Ao(g,_,R,x,re,G):qf(g,_,ye,R,x,re,G);if(!(R&i)){var Be=ke&&Qe.call(g,"__wrapped__"),He=Ge&&Qe.call(_,"__wrapped__");if(Be||He){var ft=Be?g.value():g,it=He?_.value():_;return G||(G=new ct),re(ft,it,R,x,G)}}return Te?(G||(G=new ct),Vf(g,_,R,x,re,G)):!1}function Hf(g){if(!Ro(g)||Kf(g))return!1;var _=No(g)?sf:Z;return _.test(It(g))}function jf(g){return Ar(g)&&bo(g.length)&&!!k[Tr(g)]}function Gf(g){if(!Jf(g))return uf(g);var _=[];for(var R in Object(g))Qe.call(g,R)&&R!="constructor"&&_.push(R);return _}function Ao(g,_,R,x,re,G){var le=R&i,me=g.length,ye=_.length;if(me!=ye&&!(le&&ye>me))return!1;var ie=G.get(g);if(ie&&G.get(_))return ie==_;var ke=-1,Ge=!0,Te=R&a?new dn:void 0;for(G.set(g,_),G.set(_,g);++ke<me;){var Be=g[ke],He=_[ke];if(x)var ft=le?x(He,Be,ke,_,g,G):x(Be,He,ke,g,_,G);if(ft!==void 0){if(ft)continue;Ge=!1;break}if(Te){if(!de(_,function(it,Ot){if(!ln(Te,Ot)&&(Be===it||re(Be,it,R,x,G)))return Te.push(Ot)})){Ge=!1;break}}else if(!(Be===He||re(Be,He,R,x,G))){Ge=!1;break}}return G.delete(g),G.delete(_),Ge}function qf(g,_,R,x,re,G,le){switch(R){case B:if(g.byteLength!=_.byteLength||g.byteOffset!=_.byteOffset)return!1;g=g.buffer,_=_.buffer;case H:return!(g.byteLength!=_.byteLength||!G(new Eo(g),new Eo(_)));case c:case f:case T:return Co(+g,+_);case d:return g.name==_.name&&g.message==_.message;case J:case X:return g==_+"";case E:var me=cn;case ne:var ye=x&i;if(me||(me=nf),g.size!=_.size&&!ye)return!1;var ie=le.get(g);if(ie)return ie==_;x|=a,le.set(g,_);var ke=Ao(me(g),me(_),x,re,G,le);return le.delete(g),ke;case Ce:if(Ii)return Ii.call(g)==Ii.call(_)}return!1}function Vf(g,_,R,x,re,G){var le=R&i,me=So(g),ye=me.length,ie=So(_),ke=ie.length;if(ye!=ke&&!le)return!1;for(var Ge=ye;Ge--;){var Te=me[Ge];if(!(le?Te in _:Qe.call(_,Te)))return!1}var Be=G.get(g);if(Be&&G.get(_))return Be==_;var He=!0;G.set(g,_),G.set(_,g);for(var ft=le;++Ge<ye;){Te=me[Ge];var it=g[Te],Ot=_[Te];if(x)var Oo=le?x(Ot,it,Te,_,g,G):x(it,Ot,Te,g,_,G);if(!(Oo===void 0?it===Ot||re(it,Ot,R,x,G):Oo)){He=!1;break}ft||(ft=Te=="constructor")}if(He&&!ft){var gn=g.constructor,En=_.constructor;gn!=En&&"constructor"in g&&"constructor"in _&&!(typeof gn=="function"&&gn instanceof gn&&typeof En=="function"&&En instanceof En)&&(He=!1)}return G.delete(g),G.delete(_),He}function So(g){return Mf(g,rd,Xf)}function pn(g,_){var R=g.__data__;return zf(_)?R[typeof _=="string"?"string":"hash"]:R.map}function Vt(g,_){var R=wr(g,_);return Hf(R)?R:void 0}function Wf(g){var _=Qe.call(g,Nt),R=g[Nt];try{g[Nt]=void 0;var x=!0}catch{}var re=mo.call(g);return x&&(_?g[Nt]=R:delete g[Nt]),re}var Xf=wo?function(g){return g==null?[]:(g=Object(g),ve(wo(g),function(_){return yo.call(g,_)}))}:nd,ut=Tr;(Ci&&ut(new Ci(new ArrayBuffer(1)))!=B||_r&&ut(new _r)!=E||Ni&&ut(Ni.resolve())!=$||bi&&ut(new bi)!=ne||Ri&&ut(new Ri)!=q)&&(ut=function(g){var _=Tr(g),R=_==A?g.constructor:void 0,x=R?It(R):"";if(x)switch(x){case ff:return B;case df:return E;case hf:return $;case pf:return ne;case mf:return q}return _});function Yf(g,_){return _=_??o,!!_&&(typeof g=="number"||pe.test(g))&&g>-1&&g%1==0&&g<_}function zf(g){var _=typeof g;return _=="string"||_=="number"||_=="symbol"||_=="boolean"?g!=="__proto__":g===null}function Kf(g){return!!po&&po in g}function Jf(g){var _=g&&g.constructor,R=typeof _=="function"&&_.prototype||un;return g===R}function Qf(g){return mo.call(g)}function It(g){if(g!=null){try{return ho.call(g)}catch{}try{return g+""}catch{}}return""}function Co(g,_){return g===_||g!==g&&_!==_}var Zf=vo(function(){return arguments}())?vo:function(g){return Ar(g)&&Qe.call(g,"callee")&&!yo.call(g,"callee")},mn=Array.isArray;function ed(g){return g!=null&&bo(g.length)&&!No(g)}var Oi=cf||id;function td(g,_){return To(g,_)}function No(g){if(!Ro(g))return!1;var _=Tr(g);return _==m||_==w||_==h||_==P}function bo(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=o}function Ro(g){var _=typeof g;return g!=null&&(_=="object"||_=="function")}function Ar(g){return g!=null&&typeof g=="object"}var Io=Ee?Ai(Ee):jf;function rd(g){return ed(g)?kf(g):Gf(g)}function nd(){return[]}function id(){return!1}e.exports=td})(zn,zn.exports);var r_=zn.exports;Object.defineProperty(nn,"__esModule",{value:!0});nn.DownloadedUpdateHelper=void 0;nn.createTempUpdateFile=s_;const n_=hr,i_=ue,Vs=r_,Pt=St,Fr=V;class a_{constructor(t){this.cacheDir=t,this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,this._downloadedFileInfo=null}get downloadedFileInfo(){return this._downloadedFileInfo}get file(){return this._file}get packageFile(){return this._packageFile}get cacheDirForPendingUpdate(){return Fr.join(this.cacheDir,"pending")}async validateDownloadedPath(t,r,n,i){if(this.versionInfo!=null&&this.file===t&&this.fileInfo!=null)return Vs(this.versionInfo,r)&&Vs(this.fileInfo.info,n.info)&&await(0,Pt.pathExists)(t)?t:null;const a=await this.getValidCachedUpdateFile(n,i);return a===null?null:(i.info(`Update has already been downloaded to ${t}).`),this._file=a,a)}async setDownloadedFile(t,r,n,i,a,o){this._file=t,this._packageFile=r,this.versionInfo=n,this.fileInfo=i,this._downloadedFileInfo={fileName:a,sha512:i.info.sha512,isAdminRightsRequired:i.info.isAdminRightsRequired===!0},o&&await(0,Pt.outputJson)(this.getUpdateInfoFile(),this._downloadedFileInfo)}async clear(){this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,await this.cleanCacheDirForPendingUpdate()}async cleanCacheDirForPendingUpdate(){try{await(0,Pt.emptyDir)(this.cacheDirForPendingUpdate)}catch{}}async getValidCachedUpdateFile(t,r){const n=this.getUpdateInfoFile();if(!await(0,Pt.pathExists)(n))return null;let a;try{a=await(0,Pt.readJson)(n)}catch(h){let c="No cached update info available";return h.code!=="ENOENT"&&(await this.cleanCacheDirForPendingUpdate(),c+=` (error on read: ${h.message})`),r.info(c),null}if(!((a==null?void 0:a.fileName)!==null))return r.warn("Cached update info is corrupted: no fileName, directory for cached update will be cleaned"),await this.cleanCacheDirForPendingUpdate(),null;if(t.info.sha512!==a.sha512)return r.info(`Cached update sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ${a.sha512}, expected: ${t.info.sha512}. Directory for cached update will be cleaned`),await this.cleanCacheDirForPendingUpdate(),null;const s=Fr.join(this.cacheDirForPendingUpdate,a.fileName);if(!await(0,Pt.pathExists)(s))return r.info("Cached update file doesn't exist"),null;const l=await o_(s);return t.info.sha512!==l?(r.warn(`Sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ${l}, expected: ${t.info.sha512}`),await this.cleanCacheDirForPendingUpdate(),null):(this._downloadedFileInfo=a,s)}getUpdateInfoFile(){return Fr.join(this.cacheDirForPendingUpdate,"update-info.json")}}nn.DownloadedUpdateHelper=a_;function o_(e,t="sha512",r="base64",n){return new Promise((i,a)=>{const o=(0,n_.createHash)(t);o.on("error",a).setEncoding(r),(0,i_.createReadStream)(e,{...n,highWaterMark:1024*1024}).on("error",a).on("end",()=>{o.end(),i(o.read())}).pipe(o,{end:!1})})}async function s_(e,t,r){let n=0,i=Fr.join(t,e);for(let a=0;a<3;a++)try{return await(0,Pt.unlink)(i),i}catch(o){if(o.code==="ENOENT")return i;r.warn(`Error on remove temp update file: ${o}`),i=Fr.join(t,`${n++}-${e}`)}return i}var pi={},oo={};Object.defineProperty(oo,"__esModule",{value:!0});oo.getAppCacheDir=c_;const Ji=V,l_=Qn;function c_(){const e=(0,l_.homedir)();let t;return process.platform==="win32"?t=process.env.LOCALAPPDATA||Ji.join(e,"AppData","Local"):process.platform==="darwin"?t=Ji.join(e,"Library","Caches"):t=process.env.XDG_CACHE_HOME||Ji.join(e,".cache"),t}Object.defineProperty(pi,"__esModule",{value:!0});pi.ElectronAppAdapter=void 0;const Ws=V,u_=oo;class f_{constructor(t=D.app){this.app=t}whenReady(){return this.app.whenReady()}get version(){return this.app.getVersion()}get name(){return this.app.getName()}get isPackaged(){return this.app.isPackaged===!0}get appUpdateConfigPath(){return this.isPackaged?Ws.join(process.resourcesPath,"app-update.yml"):Ws.join(this.app.getAppPath(),"dev-app-update.yml")}get userDataPath(){return this.app.getPath("userData")}get baseCachePath(){return(0,u_.getAppCacheDir)()}quit(){this.app.quit()}relaunch(){this.app.relaunch()}onQuit(t){this.app.once("quit",(r,n)=>t(n))}}pi.ElectronAppAdapter=f_;var ku={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ElectronHttpExecutor=e.NET_SESSION_NAME=void 0,e.getNetSession=r;const t=he;e.NET_SESSION_NAME="electron-updater";function r(){return D.session.fromPartition(e.NET_SESSION_NAME,{cache:!1})}class n extends t.HttpExecutor{constructor(a){super(),this.proxyLoginCallback=a,this.cachedSession=null}async download(a,o,s){return await s.cancellationToken.createPromise((l,h,c)=>{const f={headers:s.headers||void 0,redirect:"manual"};(0,t.configureRequestUrl)(a,f),(0,t.configureRequestOptions)(f),this.doDownload(f,{destination:o,options:s,onCancel:c,callback:d=>{d==null?l(o):h(d)},responseHandler:null},0)})}createRequest(a,o){a.headers&&a.headers.Host&&(a.host=a.headers.Host,delete a.headers.Host),this.cachedSession==null&&(this.cachedSession=r());const s=D.net.request({...a,session:this.cachedSession});return s.on("response",o),this.proxyLoginCallback!=null&&s.on("login",this.proxyLoginCallback),s}addRedirectHandlers(a,o,s,l,h){a.on("redirect",(c,f,d)=>{a.abort(),l>this.maxRedirects?s(this.createMaxRedirectError()):h(t.HttpExecutor.prepareRedirectUrlOptions(d,o))})}}e.ElectronHttpExecutor=n})(ku);var an={},Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.newBaseUrl=d_;Ke.newUrlFromBase=h_;Ke.getChannelFilename=p_;const Mu=st;function d_(e){const t=new Mu.URL(e);return t.pathname.endsWith("/")||(t.pathname+="/"),t}function h_(e,t,r=!1){const n=new Mu.URL(e,t),i=t.search;return i!=null&&i.length!==0?n.search=i:r&&(n.search=`noCache=${Date.now().toString(32)}`),n}function p_(e){return`${e}.yml`}var fe={},m_="[object Symbol]",Bu=/[\\^$.*+?()[\]{}|]/g,g_=RegExp(Bu.source),E_=typeof Re=="object"&&Re&&Re.Object===Object&&Re,y_=typeof self=="object"&&self&&self.Object===Object&&self,w_=E_||y_||Function("return this")(),__=Object.prototype,v_=__.toString,Xs=w_.Symbol,Ys=Xs?Xs.prototype:void 0,zs=Ys?Ys.toString:void 0;function T_(e){if(typeof e=="string")return e;if(S_(e))return zs?zs.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function A_(e){return!!e&&typeof e=="object"}function S_(e){return typeof e=="symbol"||A_(e)&&v_.call(e)==m_}function C_(e){return e==null?"":T_(e)}function N_(e){return e=C_(e),e&&g_.test(e)?e.replace(Bu,"\\$&"):e}var Hu=N_;Object.defineProperty(fe,"__esModule",{value:!0});fe.Provider=void 0;fe.findFile=D_;fe.parseUpdateInfo=P_;fe.getFileList=ju;fe.resolveFiles=F_;const vt=he,b_=_e,R_=st,Kn=Ke,I_=Hu;class O_{constructor(t){this.runtimeOptions=t,this.requestHeaders=null,this.executor=t.executor}getBlockMapFiles(t,r,n,i=null){const a=(0,Kn.newUrlFromBase)(`${t.pathname}.blockmap`,t);return[(0,Kn.newUrlFromBase)(`${t.pathname.replace(new RegExp(I_(n),"g"),r)}.blockmap`,i?new R_.URL(i):t),a]}get isUseMultipleRangeRequest(){return this.runtimeOptions.isUseMultipleRangeRequest!==!1}getChannelFilePrefix(){if(this.runtimeOptions.platform==="linux"){const t=process.env.TEST_UPDATER_ARCH||process.arch;return"-linux"+(t==="x64"?"":`-${t}`)}else return this.runtimeOptions.platform==="darwin"?"-mac":""}getDefaultChannelName(){return this.getCustomChannelName("latest")}getCustomChannelName(t){return`${t}${this.getChannelFilePrefix()}`}get fileExtraDownloadHeaders(){return null}setRequestHeaders(t){this.requestHeaders=t}httpRequest(t,r,n){return this.executor.request(this.createRequestOptions(t,r),n)}createRequestOptions(t,r){const n={};return this.requestHeaders==null?r!=null&&(n.headers=r):n.headers=r==null?this.requestHeaders:{...this.requestHeaders,...r},(0,vt.configureRequestUrl)(t,n),n}}fe.Provider=O_;function D_(e,t,r){var n;if(e.length===0)throw(0,vt.newError)("No files provided","ERR_UPDATER_NO_FILES_PROVIDED");const i=e.filter(o=>o.url.pathname.toLowerCase().endsWith(`.${t.toLowerCase()}`)),a=(n=i.find(o=>[o.url.pathname,o.info.url].some(s=>s.includes(process.arch))))!==null&&n!==void 0?n:i.shift();return a||(r==null?e[0]:e.find(o=>!r.some(s=>o.url.pathname.toLowerCase().endsWith(`.${s.toLowerCase()}`))))}function P_(e,t,r){if(e==null)throw(0,vt.newError)(`Cannot parse update info from ${t} in the latest release artifacts (${r}): rawData: null`,"ERR_UPDATER_INVALID_UPDATE_INFO");let n;try{n=(0,b_.load)(e)}catch(i){throw(0,vt.newError)(`Cannot parse update info from ${t} in the latest release artifacts (${r}): ${i.stack||i.message}, rawData: ${e}`,"ERR_UPDATER_INVALID_UPDATE_INFO")}return n}function ju(e){const t=e.files;if(t!=null&&t.length>0)return t;if(e.path!=null)return[{url:e.path,sha2:e.sha2,sha512:e.sha512}];throw(0,vt.newError)(`No files provided: ${(0,vt.safeStringifyJson)(e)}`,"ERR_UPDATER_NO_FILES_PROVIDED")}function F_(e,t,r=n=>n){const i=ju(e).map(s=>{if(s.sha2==null&&s.sha512==null)throw(0,vt.newError)(`Update info doesn't contain nor sha256 neither sha512 checksum: ${(0,vt.safeStringifyJson)(s)}`,"ERR_UPDATER_NO_CHECKSUM");return{url:(0,Kn.newUrlFromBase)(r(s.url),t),info:s}}),a=e.packages,o=a==null?null:a[process.arch]||a.ia32;return o!=null&&(i[0].packageInfo={...o,path:(0,Kn.newUrlFromBase)(r(o.path),t).href}),i}Object.defineProperty(an,"__esModule",{value:!0});an.GenericProvider=void 0;const Ks=he,Qi=Ke,Zi=fe;class $_ extends Zi.Provider{constructor(t,r,n){super(n),this.configuration=t,this.updater=r,this.baseUrl=(0,Qi.newBaseUrl)(this.configuration.url)}get channel(){const t=this.updater.channel||this.configuration.channel;return t==null?this.getDefaultChannelName():this.getCustomChannelName(t)}async getLatestVersion(){const t=(0,Qi.getChannelFilename)(this.channel),r=(0,Qi.newUrlFromBase)(t,this.baseUrl,this.updater.isAddNoCacheQuery);for(let n=0;;n++)try{return(0,Zi.parseUpdateInfo)(await this.httpRequest(r),t,r)}catch(i){if(i instanceof Ks.HttpError&&i.statusCode===404)throw(0,Ks.newError)(`Cannot find channel "${t}" update info: ${i.stack||i.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");if(i.code==="ECONNREFUSED"&&n<3){await new Promise((a,o)=>{try{setTimeout(a,1e3*n)}catch(s){o(s)}});continue}throw i}}resolveFiles(t){return(0,Zi.resolveFiles)(t,this.baseUrl)}}an.GenericProvider=$_;var mi={},gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.BitbucketProvider=void 0;const Js=he,ea=Ke,ta=fe;class L_ extends ta.Provider{constructor(t,r,n){super({...n,isUseMultipleRangeRequest:!1}),this.configuration=t,this.updater=r;const{owner:i,slug:a}=t;this.baseUrl=(0,ea.newBaseUrl)(`https://api.bitbucket.org/2.0/repositories/${i}/${a}/downloads`)}get channel(){return this.updater.channel||this.configuration.channel||"latest"}async getLatestVersion(){const t=new Js.CancellationToken,r=(0,ea.getChannelFilename)(this.getCustomChannelName(this.channel)),n=(0,ea.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{const i=await this.httpRequest(n,void 0,t);return(0,ta.parseUpdateInfo)(i,r,n)}catch(i){throw(0,Js.newError)(`Unable to find latest version on ${this.toString()}, please ensure release exists: ${i.stack||i.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(t){return(0,ta.resolveFiles)(t,this.baseUrl)}toString(){const{owner:t,slug:r}=this.configuration;return`Bitbucket (owner: ${t}, slug: ${r}, channel: ${this.channel})`}}gi.BitbucketProvider=L_;var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.GitHubProvider=Tt.BaseGitHubProvider=void 0;Tt.computeReleaseNotes=qu;const at=he,rr=Uu,x_=st,nr=Ke,ba=fe,ra=/\/tag\/([^/]+)$/;class Gu extends ba.Provider{constructor(t,r,n){super({...n,isUseMultipleRangeRequest:!1}),this.options=t,this.baseUrl=(0,nr.newBaseUrl)((0,at.githubUrl)(t,r));const i=r==="github.com"?"api.github.com":r;this.baseApiUrl=(0,nr.newBaseUrl)((0,at.githubUrl)(t,i))}computeGithubBasePath(t){const r=this.options.host;return r&&!["github.com","api.github.com"].includes(r)?`/api/v3${t}`:t}}Tt.BaseGitHubProvider=Gu;class U_ extends Gu{constructor(t,r,n){super(t,"github.com",n),this.options=t,this.updater=r}get channel(){const t=this.updater.channel||this.options.channel;return t==null?this.getDefaultChannelName():this.getCustomChannelName(t)}async getLatestVersion(){var t,r,n,i,a;const o=new at.CancellationToken,s=await this.httpRequest((0,nr.newUrlFromBase)(`${this.basePath}.atom`,this.baseUrl),{accept:"application/xml, application/atom+xml, text/xml, */*"},o),l=(0,at.parseXml)(s);let h=l.element("entry",!1,"No published versions on GitHub"),c=null;try{if(this.updater.allowPrerelease){const T=((t=this.updater)===null||t===void 0?void 0:t.channel)||((r=rr.prerelease(this.updater.currentVersion))===null||r===void 0?void 0:r[0])||null;if(T===null)c=ra.exec(h.element("link").attribute("href"))[1];else for(const S of l.getElements("entry")){const A=ra.exec(S.element("link").attribute("href"));if(A===null)continue;const $=A[1],P=((n=rr.prerelease($))===null||n===void 0?void 0:n[0])||null,J=!T||["alpha","beta"].includes(T),ne=P!==null&&!["alpha","beta"].includes(String(P));if(J&&!ne&&!(T==="beta"&&P==="alpha")){c=$;break}if(P&&P===T){c=$;break}}}else{c=await this.getLatestTagName(o);for(const T of l.getElements("entry"))if(ra.exec(T.element("link").attribute("href"))[1]===c){h=T;break}}}catch(T){throw(0,at.newError)(`Cannot parse releases feed: ${T.stack||T.message},
XML:
${s}`,"ERR_UPDATER_INVALID_RELEASE_FEED")}if(c==null)throw(0,at.newError)("No published versions on GitHub","ERR_UPDATER_NO_PUBLISHED_VERSIONS");let f,d="",m="";const w=async T=>{d=(0,nr.getChannelFilename)(T),m=(0,nr.newUrlFromBase)(this.getBaseDownloadPath(String(c),d),this.baseUrl);const S=this.createRequestOptions(m);try{return await this.executor.request(S,o)}catch(A){throw A instanceof at.HttpError&&A.statusCode===404?(0,at.newError)(`Cannot find ${d} in the latest release artifacts (${m}): ${A.stack||A.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):A}};try{let T=this.channel;this.updater.allowPrerelease&&(!((i=rr.prerelease(c))===null||i===void 0)&&i[0])&&(T=this.getCustomChannelName(String((a=rr.prerelease(c))===null||a===void 0?void 0:a[0]))),f=await w(T)}catch(T){if(this.updater.allowPrerelease)f=await w(this.getDefaultChannelName());else throw T}const E=(0,ba.parseUpdateInfo)(f,d,m);return E.releaseName==null&&(E.releaseName=h.elementValueOrEmpty("title")),E.releaseNotes==null&&(E.releaseNotes=qu(this.updater.currentVersion,this.updater.fullChangelog,l,h)),{tag:c,...E}}async getLatestTagName(t){const r=this.options,n=r.host==null||r.host==="github.com"?(0,nr.newUrlFromBase)(`${this.basePath}/latest`,this.baseUrl):new x_.URL(`${this.computeGithubBasePath(`/repos/${r.owner}/${r.repo}/releases`)}/latest`,this.baseApiUrl);try{const i=await this.httpRequest(n,{Accept:"application/json"},t);return i==null?null:JSON.parse(i).tag_name}catch(i){throw(0,at.newError)(`Unable to find latest version on GitHub (${n}), please ensure a production release exists: ${i.stack||i.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return`/${this.options.owner}/${this.options.repo}/releases`}resolveFiles(t){return(0,ba.resolveFiles)(t,this.baseUrl,r=>this.getBaseDownloadPath(t.tag,r.replace(/ /g,"-")))}getBaseDownloadPath(t,r){return`${this.basePath}/download/${t}/${r}`}}Tt.GitHubProvider=U_;function Qs(e){const t=e.elementValueOrEmpty("content");return t==="No content."?"":t}function qu(e,t,r,n){if(!t)return Qs(n);const i=[];for(const a of r.getElements("entry")){const o=/\/tag\/v?([^/]+)$/.exec(a.element("link").attribute("href"))[1];rr.lt(e,o)&&i.push({version:o,note:Qs(a)})}return i.sort((a,o)=>rr.rcompare(a.version,o.version))}var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.GitLabProvider=void 0;const Ne=he,na=st,k_=Hu,On=Ke,ia=fe;class M_ extends ia.Provider{normalizeFilename(t){return t.replace(/ |_/g,"-")}constructor(t,r,n){super({...n,isUseMultipleRangeRequest:!1}),this.options=t,this.updater=r,this.cachedLatestVersion=null;const a=t.host||"gitlab.com";this.baseApiUrl=(0,On.newBaseUrl)(`https://${a}/api/v4`)}get channel(){const t=this.updater.channel||this.options.channel;return t==null?this.getDefaultChannelName():this.getCustomChannelName(t)}async getLatestVersion(){const t=new Ne.CancellationToken,r=(0,On.newUrlFromBase)(`projects/${this.options.projectId}/releases/permalink/latest`,this.baseApiUrl);let n;try{const d={"Content-Type":"application/json",...this.setAuthHeaderForToken(this.options.token||null)},m=await this.httpRequest(r,d,t);if(!m)throw(0,Ne.newError)("No latest release found","ERR_UPDATER_NO_PUBLISHED_VERSIONS");n=JSON.parse(m)}catch(d){throw(0,Ne.newError)(`Unable to find latest release on GitLab (${r}): ${d.stack||d.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}const i=n.tag_name;let a=null,o="",s=null;const l=async d=>{o=(0,On.getChannelFilename)(d);const m=n.assets.links.find(E=>E.name===o);if(!m)throw(0,Ne.newError)(`Cannot find ${o} in the latest release assets`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");s=new na.URL(m.direct_asset_url);const w=this.options.token?{"PRIVATE-TOKEN":this.options.token}:void 0;try{const E=await this.httpRequest(s,w,t);if(!E)throw(0,Ne.newError)(`Empty response from ${s}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");return E}catch(E){throw E instanceof Ne.HttpError&&E.statusCode===404?(0,Ne.newError)(`Cannot find ${o} in the latest release artifacts (${s}): ${E.stack||E.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):E}};try{a=await l(this.channel)}catch(d){if(this.channel!==this.getDefaultChannelName())a=await l(this.getDefaultChannelName());else throw d}if(!a)throw(0,Ne.newError)(`Unable to parse channel data from ${o}`,"ERR_UPDATER_INVALID_UPDATE_INFO");const h=(0,ia.parseUpdateInfo)(a,o,s);h.releaseName==null&&(h.releaseName=n.name),h.releaseNotes==null&&(h.releaseNotes=n.description||null);const c=new Map;for(const d of n.assets.links)c.set(this.normalizeFilename(d.name),d.direct_asset_url);const f={tag:i,assets:c,...h};return this.cachedLatestVersion=f,f}convertAssetsToMap(t){const r=new Map;for(const n of t.links)r.set(this.normalizeFilename(n.name),n.direct_asset_url);return r}findBlockMapInAssets(t,r){const n=[`${r}.blockmap`,`${this.normalizeFilename(r)}.blockmap`];for(const i of n){const a=t.get(i);if(a)return new na.URL(a)}return null}async fetchReleaseInfoByVersion(t){const r=new Ne.CancellationToken,n=[`v${t}`,t];for(const i of n){const a=(0,On.newUrlFromBase)(`projects/${this.options.projectId}/releases/${encodeURIComponent(i)}`,this.baseApiUrl);try{const o={"Content-Type":"application/json",...this.setAuthHeaderForToken(this.options.token||null)},s=await this.httpRequest(a,o,r);if(s)return JSON.parse(s)}catch(o){if(o instanceof Ne.HttpError&&o.statusCode===404)continue;throw(0,Ne.newError)(`Unable to find release ${i} on GitLab (${a}): ${o.stack||o.message}`,"ERR_UPDATER_RELEASE_NOT_FOUND")}}throw(0,Ne.newError)(`Unable to find release with version ${t} (tried: ${n.join(", ")}) on GitLab`,"ERR_UPDATER_RELEASE_NOT_FOUND")}setAuthHeaderForToken(t){const r={};return t!=null&&(t.startsWith("Bearer")?r.authorization=t:r["PRIVATE-TOKEN"]=t),r}async getVersionInfoForBlockMap(t){if(this.cachedLatestVersion&&this.cachedLatestVersion.version===t)return this.cachedLatestVersion.assets;const r=await this.fetchReleaseInfoByVersion(t);return r&&r.assets?this.convertAssetsToMap(r.assets):null}async findBlockMapUrlsFromAssets(t,r,n){let i=null,a=null;const o=await this.getVersionInfoForBlockMap(r);o&&(i=this.findBlockMapInAssets(o,n));const s=await this.getVersionInfoForBlockMap(t);if(s){const l=n.replace(new RegExp(k_(r),"g"),t);a=this.findBlockMapInAssets(s,l)}return[a,i]}async getBlockMapFiles(t,r,n,i=null){if(this.options.uploadTarget==="project_upload"){const a=t.pathname.split("/").pop()||"",[o,s]=await this.findBlockMapUrlsFromAssets(r,n,a);if(!s)throw(0,Ne.newError)(`Cannot find blockmap file for ${n} in GitLab assets`,"ERR_UPDATER_BLOCKMAP_FILE_NOT_FOUND");if(!o)throw(0,Ne.newError)(`Cannot find blockmap file for ${r} in GitLab assets`,"ERR_UPDATER_BLOCKMAP_FILE_NOT_FOUND");return[o,s]}else return super.getBlockMapFiles(t,r,n,i)}resolveFiles(t){return(0,ia.getFileList)(t).map(r=>{const i=[r.url,this.normalizeFilename(r.url)].find(o=>t.assets.has(o)),a=i?t.assets.get(i):void 0;if(!a)throw(0,Ne.newError)(`Cannot find asset "${r.url}" in GitLab release assets. Available assets: ${Array.from(t.assets.keys()).join(", ")}`,"ERR_UPDATER_ASSET_NOT_FOUND");return{url:new na.URL(a),info:r}})}toString(){return`GitLab (projectId: ${this.options.projectId}, channel: ${this.channel})`}}Ei.GitLabProvider=M_;var yi={};Object.defineProperty(yi,"__esModule",{value:!0});yi.KeygenProvider=void 0;const Zs=he,aa=Ke,oa=fe;class B_ extends oa.Provider{constructor(t,r,n){super({...n,isUseMultipleRangeRequest:!1}),this.configuration=t,this.updater=r,this.defaultHostname="api.keygen.sh";const i=this.configuration.host||this.defaultHostname;this.baseUrl=(0,aa.newBaseUrl)(`https://${i}/v1/accounts/${this.configuration.account}/artifacts?product=${this.configuration.product}`)}get channel(){return this.updater.channel||this.configuration.channel||"stable"}async getLatestVersion(){const t=new Zs.CancellationToken,r=(0,aa.getChannelFilename)(this.getCustomChannelName(this.channel)),n=(0,aa.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{const i=await this.httpRequest(n,{Accept:"application/vnd.api+json","Keygen-Version":"1.1"},t);return(0,oa.parseUpdateInfo)(i,r,n)}catch(i){throw(0,Zs.newError)(`Unable to find latest version on ${this.toString()}, please ensure release exists: ${i.stack||i.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(t){return(0,oa.resolveFiles)(t,this.baseUrl)}toString(){const{account:t,product:r,platform:n}=this.configuration;return`Keygen (account: ${t}, product: ${r}, platform: ${n}, channel: ${this.channel})`}}yi.KeygenProvider=B_;var wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.PrivateGitHubProvider=void 0;const Yt=he,H_=_e,j_=V,el=st,tl=Ke,G_=Tt,q_=fe;class V_ extends G_.BaseGitHubProvider{constructor(t,r,n,i){super(t,"api.github.com",i),this.updater=r,this.token=n}createRequestOptions(t,r){const n=super.createRequestOptions(t,r);return n.redirect="manual",n}async getLatestVersion(){const t=new Yt.CancellationToken,r=(0,tl.getChannelFilename)(this.getDefaultChannelName()),n=await this.getLatestVersionInfo(t),i=n.assets.find(s=>s.name===r);if(i==null)throw(0,Yt.newError)(`Cannot find ${r} in the release ${n.html_url||n.name}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");const a=new el.URL(i.url);let o;try{o=(0,H_.load)(await this.httpRequest(a,this.configureHeaders("application/octet-stream"),t))}catch(s){throw s instanceof Yt.HttpError&&s.statusCode===404?(0,Yt.newError)(`Cannot find ${r} in the latest release artifacts (${a}): ${s.stack||s.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):s}return o.assets=n.assets,o}get fileExtraDownloadHeaders(){return this.configureHeaders("application/octet-stream")}configureHeaders(t){return{accept:t,authorization:`token ${this.token}`}}async getLatestVersionInfo(t){const r=this.updater.allowPrerelease;let n=this.basePath;r||(n=`${n}/latest`);const i=(0,tl.newUrlFromBase)(n,this.baseUrl);try{const a=JSON.parse(await this.httpRequest(i,this.configureHeaders("application/vnd.github.v3+json"),t));return r?a.find(o=>o.prerelease)||a[0]:a}catch(a){throw(0,Yt.newError)(`Unable to find latest version on GitHub (${i}), please ensure a production release exists: ${a.stack||a.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return this.computeGithubBasePath(`/repos/${this.options.owner}/${this.options.repo}/releases`)}resolveFiles(t){return(0,q_.getFileList)(t).map(r=>{const n=j_.posix.basename(r.url).replace(/ /g,"-"),i=t.assets.find(a=>a!=null&&a.name===n);if(i==null)throw(0,Yt.newError)(`Cannot find asset "${n}" in: ${JSON.stringify(t.assets,null,2)}`,"ERR_UPDATER_ASSET_NOT_FOUND");return{url:new el.URL(i.url),info:r}})}}wi.PrivateGitHubProvider=V_;Object.defineProperty(mi,"__esModule",{value:!0});mi.isUrlProbablySupportMultiRangeRequests=Vu;mi.createClient=J_;const Dn=he,W_=gi,rl=an,X_=Tt,Y_=Ei,z_=yi,K_=wi;function Vu(e){return!e.includes("s3.amazonaws.com")}function J_(e,t,r){if(typeof e=="string")throw(0,Dn.newError)("Please pass PublishConfiguration object","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");const n=e.provider;switch(n){case"github":{const i=e,a=(i.private?process.env.GH_TOKEN||process.env.GITHUB_TOKEN:null)||i.token;return a==null?new X_.GitHubProvider(i,t,r):new K_.PrivateGitHubProvider(i,t,a,r)}case"bitbucket":return new W_.BitbucketProvider(e,t,r);case"gitlab":return new Y_.GitLabProvider(e,t,r);case"keygen":return new z_.KeygenProvider(e,t,r);case"s3":case"spaces":return new rl.GenericProvider({provider:"generic",url:(0,Dn.getS3LikeProviderBaseUrl)(e),channel:e.channel||null},t,{...r,isUseMultipleRangeRequest:!1});case"generic":{const i=e;return new rl.GenericProvider(i,t,{...r,isUseMultipleRangeRequest:i.useMultipleRangeRequest!==!1&&Vu(i.url)})}case"custom":{const i=e,a=i.updateProvider;if(!a)throw(0,Dn.newError)("Custom provider not specified","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");return new a(i,t,r)}default:throw(0,Dn.newError)(`Unsupported provider: ${n}`,"ERR_UPDATER_UNSUPPORTED_PROVIDER")}}var _i={},on={},Er={},qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.OperationKind=void 0;qt.computeOperations=Q_;var Lt;(function(e){e[e.COPY=0]="COPY",e[e.DOWNLOAD=1]="DOWNLOAD"})(Lt||(qt.OperationKind=Lt={}));function Q_(e,t,r){const n=il(e.files),i=il(t.files);let a=null;const o=t.files[0],s=[],l=o.name,h=n.get(l);if(h==null)throw new Error(`no file ${l} in old blockmap`);const c=i.get(l);let f=0;const{checksumToOffset:d,checksumToOldSize:m}=ev(n.get(l),h.offset,r);let w=o.offset;for(let E=0;E<c.checksums.length;w+=c.sizes[E],E++){const T=c.sizes[E],S=c.checksums[E];let A=d.get(S);A!=null&&m.get(S)!==T&&(r.warn(`Checksum ("${S}") matches, but size differs (old: ${m.get(S)}, new: ${T})`),A=void 0),A===void 0?(f++,a!=null&&a.kind===Lt.DOWNLOAD&&a.end===w?a.end+=T:(a={kind:Lt.DOWNLOAD,start:w,end:w+T},nl(a,s,S,E))):a!=null&&a.kind===Lt.COPY&&a.end===A?a.end+=T:(a={kind:Lt.COPY,start:A,end:A+T},nl(a,s,S,E))}return f>0&&r.info(`File${o.name==="file"?"":" "+o.name} has ${f} changed blocks`),s}const Z_=process.env.DIFFERENTIAL_DOWNLOAD_PLAN_BUILDER_VALIDATE_RANGES==="true";function nl(e,t,r,n){if(Z_&&t.length!==0){const i=t[t.length-1];if(i.kind===e.kind&&e.start<i.end&&e.start>i.start){const a=[i.start,i.end,e.start,e.end].reduce((o,s)=>o<s?o:s);throw new Error(`operation (block index: ${n}, checksum: ${r}, kind: ${Lt[e.kind]}) overlaps previous operation (checksum: ${r}):
abs: ${i.start} until ${i.end} and ${e.start} until ${e.end}
rel: ${i.start-a} until ${i.end-a} and ${e.start-a} until ${e.end-a}`)}}t.push(e)}function ev(e,t,r){const n=new Map,i=new Map;let a=t;for(let o=0;o<e.checksums.length;o++){const s=e.checksums[o],l=e.sizes[o],h=i.get(s);if(h===void 0)n.set(s,a),i.set(s,l);else if(r.debug!=null){const c=h===l?"(same size)":`(size: ${h}, this size: ${l})`;r.debug(`${s} duplicated in blockmap ${c}, it doesn't lead to broken differential downloader, just corresponding block will be skipped)`)}a+=l}return{checksumToOffset:n,checksumToOldSize:i}}function il(e){const t=new Map;for(const r of e)t.set(r.name,r);return t}Object.defineProperty(Er,"__esModule",{value:!0});Er.DataSplitter=void 0;Er.copyData=Wu;const Pn=he,tv=ue,rv=zr,nv=qt,al=Buffer.from(`\r
\r
`);var ht;(function(e){e[e.INIT=0]="INIT",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"})(ht||(ht={}));function Wu(e,t,r,n,i){const a=(0,tv.createReadStream)("",{fd:r,autoClose:!1,start:e.start,end:e.end-1});a.on("error",n),a.once("end",i),a.pipe(t,{end:!1})}class iv extends rv.Writable{constructor(t,r,n,i,a,o){super(),this.out=t,this.options=r,this.partIndexToTaskIndex=n,this.partIndexToLength=a,this.finishHandler=o,this.partIndex=-1,this.headerListBuffer=null,this.readState=ht.INIT,this.ignoreByteCount=0,this.remainingPartDataCount=0,this.actualPartLength=0,this.boundaryLength=i.length+4,this.ignoreByteCount=this.boundaryLength-2}get isFinished(){return this.partIndex===this.partIndexToLength.length}_write(t,r,n){if(this.isFinished){console.error(`Trailing ignored data: ${t.length} bytes`);return}this.handleData(t).then(n).catch(n)}async handleData(t){let r=0;if(this.ignoreByteCount!==0&&this.remainingPartDataCount!==0)throw(0,Pn.newError)("Internal error","ERR_DATA_SPLITTER_BYTE_COUNT_MISMATCH");if(this.ignoreByteCount>0){const n=Math.min(this.ignoreByteCount,t.length);this.ignoreByteCount-=n,r=n}else if(this.remainingPartDataCount>0){const n=Math.min(this.remainingPartDataCount,t.length);this.remainingPartDataCount-=n,await this.processPartData(t,0,n),r=n}if(r!==t.length){if(this.readState===ht.HEADER){const n=this.searchHeaderListEnd(t,r);if(n===-1)return;r=n,this.readState=ht.BODY,this.headerListBuffer=null}for(;;){if(this.readState===ht.BODY)this.readState=ht.INIT;else{this.partIndex++;let o=this.partIndexToTaskIndex.get(this.partIndex);if(o==null)if(this.isFinished)o=this.options.end;else throw(0,Pn.newError)("taskIndex is null","ERR_DATA_SPLITTER_TASK_INDEX_IS_NULL");const s=this.partIndex===0?this.options.start:this.partIndexToTaskIndex.get(this.partIndex-1)+1;if(s<o)await this.copyExistingData(s,o);else if(s>o)throw(0,Pn.newError)("prevTaskIndex must be < taskIndex","ERR_DATA_SPLITTER_TASK_INDEX_ASSERT_FAILED");if(this.isFinished){this.onPartEnd(),this.finishHandler();return}if(r=this.searchHeaderListEnd(t,r),r===-1){this.readState=ht.HEADER;return}}const n=this.partIndexToLength[this.partIndex],i=r+n,a=Math.min(i,t.length);if(await this.processPartStarted(t,r,a),this.remainingPartDataCount=n-(a-r),this.remainingPartDataCount>0)return;if(r=i+this.boundaryLength,r>=t.length){this.ignoreByteCount=this.boundaryLength-(t.length-i);return}}}}copyExistingData(t,r){return new Promise((n,i)=>{const a=()=>{if(t===r){n();return}const o=this.options.tasks[t];if(o.kind!==nv.OperationKind.COPY){i(new Error("Task kind must be COPY"));return}Wu(o,this.out,this.options.oldFileFd,i,()=>{t++,a()})};a()})}searchHeaderListEnd(t,r){const n=t.indexOf(al,r);if(n!==-1)return n+al.length;const i=r===0?t:t.slice(r);return this.headerListBuffer==null?this.headerListBuffer=i:this.headerListBuffer=Buffer.concat([this.headerListBuffer,i]),-1}onPartEnd(){const t=this.partIndexToLength[this.partIndex-1];if(this.actualPartLength!==t)throw(0,Pn.newError)(`Expected length: ${t} differs from actual: ${this.actualPartLength}`,"ERR_DATA_SPLITTER_LENGTH_MISMATCH");this.actualPartLength=0}processPartStarted(t,r,n){return this.partIndex!==0&&this.onPartEnd(),this.processPartData(t,r,n)}processPartData(t,r,n){this.actualPartLength+=n-r;const i=this.out;return i.write(r===0&&t.length===n?t:t.slice(r,n))?Promise.resolve():new Promise((a,o)=>{i.on("error",o),i.once("drain",()=>{i.removeListener("error",o),a()})})}}Er.DataSplitter=iv;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.executeTasksUsingMultipleRangeRequests=av;vi.checkIsRangesSupported=Ia;const Ra=he,ol=Er,sl=qt;function av(e,t,r,n,i){const a=o=>{if(o>=t.length){e.fileMetadataBuffer!=null&&r.write(e.fileMetadataBuffer),r.end();return}const s=o+1e3;ov(e,{tasks:t,start:o,end:Math.min(t.length,s),oldFileFd:n},r,()=>a(s),i)};return a}function ov(e,t,r,n,i){let a="bytes=",o=0;const s=new Map,l=[];for(let f=t.start;f<t.end;f++){const d=t.tasks[f];d.kind===sl.OperationKind.DOWNLOAD&&(a+=`${d.start}-${d.end-1}, `,s.set(o,f),o++,l.push(d.end-d.start))}if(o<=1){const f=d=>{if(d>=t.end){n();return}const m=t.tasks[d++];if(m.kind===sl.OperationKind.COPY)(0,ol.copyData)(m,r,t.oldFileFd,i,()=>f(d));else{const w=e.createRequestOptions();w.headers.Range=`bytes=${m.start}-${m.end-1}`;const E=e.httpExecutor.createRequest(w,T=>{T.on("error",i),Ia(T,i)&&(T.pipe(r,{end:!1}),T.once("end",()=>f(d)))});e.httpExecutor.addErrorAndTimeoutHandlers(E,i),E.end()}};f(t.start);return}const h=e.createRequestOptions();h.headers.Range=a.substring(0,a.length-2);const c=e.httpExecutor.createRequest(h,f=>{if(!Ia(f,i))return;const d=(0,Ra.safeGetHeader)(f,"content-type"),m=/^multipart\/.+?\s*;\s*boundary=(?:"([^"]+)"|([^\s";]+))\s*$/i.exec(d);if(m==null){i(new Error(`Content-Type "multipart/byteranges" is expected, but got "${d}"`));return}const w=new ol.DataSplitter(r,t,s,m[1]||m[2],l,n);w.on("error",i),f.pipe(w),f.on("end",()=>{setTimeout(()=>{c.abort(),i(new Error("Response ends without calling any handlers"))},1e4)})});e.httpExecutor.addErrorAndTimeoutHandlers(c,i),c.end()}function Ia(e,t){if(e.statusCode>=400)return t((0,Ra.createHttpError)(e)),!1;if(e.statusCode!==206){const r=(0,Ra.safeGetHeader)(e,"accept-ranges");if(r==null||r==="none")return t(new Error(`Server doesn't support Accept-Ranges (response code ${e.statusCode})`)),!1}return!0}var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ProgressDifferentialDownloadCallbackTransform=void 0;const sv=zr;var ir;(function(e){e[e.COPY=0]="COPY",e[e.DOWNLOAD=1]="DOWNLOAD"})(ir||(ir={}));class lv extends sv.Transform{constructor(t,r,n){super(),this.progressDifferentialDownloadInfo=t,this.cancellationToken=r,this.onProgress=n,this.start=Date.now(),this.transferred=0,this.delta=0,this.expectedBytes=0,this.index=0,this.operationType=ir.COPY,this.nextUpdate=this.start+1e3}_transform(t,r,n){if(this.cancellationToken.cancelled){n(new Error("cancelled"),null);return}if(this.operationType==ir.COPY){n(null,t);return}this.transferred+=t.length,this.delta+=t.length;const i=Date.now();i>=this.nextUpdate&&this.transferred!==this.expectedBytes&&this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&(this.nextUpdate=i+1e3,this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((i-this.start)/1e3))}),this.delta=0),n(null,t)}beginFileCopy(){this.operationType=ir.COPY}beginRangeDownload(){this.operationType=ir.DOWNLOAD,this.expectedBytes+=this.progressDifferentialDownloadInfo.expectedByteCounts[this.index++]}endRangeDownload(){this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))})}_flush(t){if(this.cancellationToken.cancelled){t(new Error("cancelled"));return}this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,this.transferred=0,t(null)}}Ti.ProgressDifferentialDownloadCallbackTransform=lv;Object.defineProperty(on,"__esModule",{value:!0});on.DifferentialDownloader=void 0;const Nr=he,sa=St,cv=ue,uv=Er,fv=st,Fn=qt,ll=vi,dv=Ti;class hv{constructor(t,r,n){this.blockAwareFileInfo=t,this.httpExecutor=r,this.options=n,this.fileMetadataBuffer=null,this.logger=n.logger}createRequestOptions(){const t={headers:{...this.options.requestHeaders,accept:"*/*"}};return(0,Nr.configureRequestUrl)(this.options.newUrl,t),(0,Nr.configureRequestOptions)(t),t}doDownload(t,r){if(t.version!==r.version)throw new Error(`version is different (${t.version} - ${r.version}), full download is required`);const n=this.logger,i=(0,Fn.computeOperations)(t,r,n);n.debug!=null&&n.debug(JSON.stringify(i,null,2));let a=0,o=0;for(const l of i){const h=l.end-l.start;l.kind===Fn.OperationKind.DOWNLOAD?a+=h:o+=h}const s=this.blockAwareFileInfo.size;if(a+o+(this.fileMetadataBuffer==null?0:this.fileMetadataBuffer.length)!==s)throw new Error(`Internal error, size mismatch: downloadSize: ${a}, copySize: ${o}, newSize: ${s}`);return n.info(`Full: ${cl(s)}, To download: ${cl(a)} (${Math.round(a/(s/100))}%)`),this.downloadFile(i)}downloadFile(t){const r=[],n=()=>Promise.all(r.map(i=>(0,sa.close)(i.descriptor).catch(a=>{this.logger.error(`cannot close file "${i.path}": ${a}`)})));return this.doDownloadFile(t,r).then(n).catch(i=>n().catch(a=>{try{this.logger.error(`cannot close files: ${a}`)}catch(o){try{console.error(o)}catch{}}throw i}).then(()=>{throw i}))}async doDownloadFile(t,r){const n=await(0,sa.open)(this.options.oldFile,"r");r.push({descriptor:n,path:this.options.oldFile});const i=await(0,sa.open)(this.options.newFile,"w");r.push({descriptor:i,path:this.options.newFile});const a=(0,cv.createWriteStream)(this.options.newFile,{fd:i});await new Promise((o,s)=>{const l=[];let h;if(!this.options.isUseMultipleRangeRequest&&this.options.onProgress){const S=[];let A=0;for(const P of t)P.kind===Fn.OperationKind.DOWNLOAD&&(S.push(P.end-P.start),A+=P.end-P.start);const $={expectedByteCounts:S,grandTotal:A};h=new dv.ProgressDifferentialDownloadCallbackTransform($,this.options.cancellationToken,this.options.onProgress),l.push(h)}const c=new Nr.DigestTransform(this.blockAwareFileInfo.sha512);c.isValidateOnEnd=!1,l.push(c),a.on("finish",()=>{a.close(()=>{r.splice(1,1);try{c.validate()}catch(S){s(S);return}o(void 0)})}),l.push(a);let f=null;for(const S of l)S.on("error",s),f==null?f=S:f=f.pipe(S);const d=l[0];let m;if(this.options.isUseMultipleRangeRequest){m=(0,ll.executeTasksUsingMultipleRangeRequests)(this,t,d,n,s),m(0);return}let w=0,E=null;this.logger.info(`Differential download: ${this.options.newUrl}`);const T=this.createRequestOptions();T.redirect="manual",m=S=>{var A,$;if(S>=t.length){this.fileMetadataBuffer!=null&&d.write(this.fileMetadataBuffer),d.end();return}const P=t[S++];if(P.kind===Fn.OperationKind.COPY){h&&h.beginFileCopy(),(0,uv.copyData)(P,d,n,s,()=>m(S));return}const J=`bytes=${P.start}-${P.end-1}`;T.headers.range=J,($=(A=this.logger)===null||A===void 0?void 0:A.debug)===null||$===void 0||$.call(A,`download range: ${J}`),h&&h.beginRangeDownload();const ne=this.httpExecutor.createRequest(T,X=>{X.on("error",s),X.on("aborted",()=>{s(new Error("response has been aborted by the server"))}),X.statusCode>=400&&s((0,Nr.createHttpError)(X)),X.pipe(d,{end:!1}),X.once("end",()=>{h&&h.endRangeDownload(),++w===100?(w=0,setTimeout(()=>m(S),1e3)):m(S)})});ne.on("redirect",(X,Ce,y)=>{this.logger.info(`Redirect to ${pv(y)}`),E=y,(0,Nr.configureRequestUrl)(new fv.URL(E),T),ne.followRedirect()}),this.httpExecutor.addErrorAndTimeoutHandlers(ne,s),ne.end()},m(0)})}async readRemoteBytes(t,r){const n=Buffer.allocUnsafe(r+1-t),i=this.createRequestOptions();i.headers.range=`bytes=${t}-${r}`;let a=0;if(await this.request(i,o=>{o.copy(n,a),a+=o.length}),a!==n.length)throw new Error(`Received data length ${a} is not equal to expected ${n.length}`);return n}request(t,r){return new Promise((n,i)=>{const a=this.httpExecutor.createRequest(t,o=>{(0,ll.checkIsRangesSupported)(o,i)&&(o.on("error",i),o.on("aborted",()=>{i(new Error("response has been aborted by the server"))}),o.on("data",r),o.on("end",()=>n()))});this.httpExecutor.addErrorAndTimeoutHandlers(a,i),a.end()})}}on.DifferentialDownloader=hv;function cl(e,t=" KB"){return new Intl.NumberFormat("en").format((e/1024).toFixed(2))+t}function pv(e){const t=e.indexOf("?");return t<0?e:e.substring(0,t)}Object.defineProperty(_i,"__esModule",{value:!0});_i.GenericDifferentialDownloader=void 0;const mv=on;class gv extends mv.DifferentialDownloader{download(t,r){return this.doDownload(t,r)}}_i.GenericDifferentialDownloader=gv;var Ct={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.UpdaterSignal=e.UPDATE_DOWNLOADED=e.DOWNLOAD_PROGRESS=e.CancellationToken=void 0,e.addHandler=n;const t=he;Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return t.CancellationToken}}),e.DOWNLOAD_PROGRESS="download-progress",e.UPDATE_DOWNLOADED="update-downloaded";class r{constructor(a){this.emitter=a}login(a){n(this.emitter,"login",a)}progress(a){n(this.emitter,e.DOWNLOAD_PROGRESS,a)}updateDownloaded(a){n(this.emitter,e.UPDATE_DOWNLOADED,a)}updateCancelled(a){n(this.emitter,"update-cancelled",a)}}e.UpdaterSignal=r;function n(i,a,o){i.on(a,o)}})(Ct);Object.defineProperty(yt,"__esModule",{value:!0});yt.NoOpLogger=yt.AppUpdater=void 0;const be=he,Ev=hr,yv=Qn,wv=Dl,qe=St,_v=_e,la=li,Ve=V,Ft=Uu,ul=nn,vv=pi,fl=ku,Tv=an,ca=mi,ua=Fl,Av=_i,zt=Ct;class so extends wv.EventEmitter{get channel(){return this._channel}set channel(t){if(this._channel!=null){if(typeof t!="string")throw(0,be.newError)(`Channel must be a string, but got: ${t}`,"ERR_UPDATER_INVALID_CHANNEL");if(t.length===0)throw(0,be.newError)("Channel must be not an empty string","ERR_UPDATER_INVALID_CHANNEL")}this._channel=t,this.allowDowngrade=!0}addAuthHeader(t){this.requestHeaders=Object.assign({},this.requestHeaders,{authorization:t})}get netSession(){return(0,fl.getNetSession)()}get logger(){return this._logger}set logger(t){this._logger=t??new Xu}set updateConfigPath(t){this.clientPromise=null,this._appUpdateConfigPath=t,this.configOnDisk=new la.Lazy(()=>this.loadUpdateConfig())}get isUpdateSupported(){return this._isUpdateSupported}set isUpdateSupported(t){t&&(this._isUpdateSupported=t)}get isUserWithinRollout(){return this._isUserWithinRollout}set isUserWithinRollout(t){t&&(this._isUserWithinRollout=t)}constructor(t,r){super(),this.autoDownload=!0,this.autoInstallOnAppQuit=!0,this.autoRunAppAfterInstall=!0,this.allowPrerelease=!1,this.fullChangelog=!1,this.allowDowngrade=!1,this.disableWebInstaller=!1,this.disableDifferentialDownload=!1,this.forceDevUpdateConfig=!1,this.previousBlockmapBaseUrlOverride=null,this._channel=null,this.downloadedUpdateHelper=null,this.requestHeaders=null,this._logger=console,this.signals=new zt.UpdaterSignal(this),this._appUpdateConfigPath=null,this._isUpdateSupported=a=>this.checkIfUpdateSupported(a),this._isUserWithinRollout=a=>this.isStagingMatch(a),this.clientPromise=null,this.stagingUserIdPromise=new la.Lazy(()=>this.getOrCreateStagingUserId()),this.configOnDisk=new la.Lazy(()=>this.loadUpdateConfig()),this.checkForUpdatesPromise=null,this.downloadPromise=null,this.updateInfoAndProvider=null,this._testOnlyOptions=null,this.on("error",a=>{this._logger.error(`Error: ${a.stack||a.message}`)}),r==null?(this.app=new vv.ElectronAppAdapter,this.httpExecutor=new fl.ElectronHttpExecutor((a,o)=>this.emit("login",a,o))):(this.app=r,this.httpExecutor=null);const n=this.app.version,i=(0,Ft.parse)(n);if(i==null)throw(0,be.newError)(`App version is not a valid semver version: "${n}"`,"ERR_UPDATER_INVALID_VERSION");this.currentVersion=i,this.allowPrerelease=Sv(i),t!=null&&(this.setFeedURL(t),typeof t!="string"&&t.requestHeaders&&(this.requestHeaders=t.requestHeaders))}getFeedURL(){return"Deprecated. Do not use it."}setFeedURL(t){const r=this.createProviderRuntimeOptions();let n;typeof t=="string"?n=new Tv.GenericProvider({provider:"generic",url:t},this,{...r,isUseMultipleRangeRequest:(0,ca.isUrlProbablySupportMultiRangeRequests)(t)}):n=(0,ca.createClient)(t,this,r),this.clientPromise=Promise.resolve(n)}checkForUpdates(){if(!this.isUpdaterActive())return Promise.resolve(null);let t=this.checkForUpdatesPromise;if(t!=null)return this._logger.info("Checking for update (already in progress)"),t;const r=()=>this.checkForUpdatesPromise=null;return this._logger.info("Checking for update"),t=this.doCheckForUpdates().then(n=>(r(),n)).catch(n=>{throw r(),this.emit("error",n,`Cannot check for updates: ${(n.stack||n).toString()}`),n}),this.checkForUpdatesPromise=t,t}isUpdaterActive(){return this.app.isPackaged||this.forceDevUpdateConfig?!0:(this._logger.info("Skip checkForUpdates because application is not packed and dev update config is not forced"),!1)}checkForUpdatesAndNotify(t){return this.checkForUpdates().then(r=>r!=null&&r.downloadPromise?(r.downloadPromise.then(()=>{const n=so.formatDownloadNotification(r.updateInfo.version,this.app.name,t);new D.Notification(n).show()}),r):(this._logger.debug!=null&&this._logger.debug("checkForUpdatesAndNotify called, downloadPromise is null"),r))}static formatDownloadNotification(t,r,n){return n==null&&(n={title:"A new update is ready to install",body:"{appName} version {version} has been downloaded and will be automatically installed on exit"}),n={title:n.title.replace("{appName}",r).replace("{version}",t),body:n.body.replace("{appName}",r).replace("{version}",t)},n}async isStagingMatch(t){const r=t.stagingPercentage;let n=r;if(n==null)return!0;if(n=parseInt(n,10),isNaN(n))return this._logger.warn(`Staging percentage is NaN: ${r}`),!0;n=n/100;const i=await this.stagingUserIdPromise.value,o=be.UUID.parse(i).readUInt32BE(12)/4294967295;return this._logger.info(`Staging percentage: ${n}, percentage: ${o}, user id: ${i}`),o<n}computeFinalHeaders(t){return this.requestHeaders!=null&&Object.assign(t,this.requestHeaders),t}async isUpdateAvailable(t){const r=(0,Ft.parse)(t.version);if(r==null)throw(0,be.newError)(`This file could not be downloaded, or the latest version (from update server) does not have a valid semver version: "${t.version}"`,"ERR_UPDATER_INVALID_VERSION");const n=this.currentVersion;if((0,Ft.eq)(r,n)||!await Promise.resolve(this.isUpdateSupported(t))||!await Promise.resolve(this.isUserWithinRollout(t)))return!1;const a=(0,Ft.gt)(r,n),o=(0,Ft.lt)(r,n);return a?!0:this.allowDowngrade&&o}checkIfUpdateSupported(t){const r=t==null?void 0:t.minimumSystemVersion,n=(0,yv.release)();if(r)try{if((0,Ft.lt)(n,r))return this._logger.info(`Current OS version ${n} is less than the minimum OS version required ${r} for version ${n}`),!1}catch(i){this._logger.warn(`Failed to compare current OS version(${n}) with minimum OS version(${r}): ${(i.message||i).toString()}`)}return!0}async getUpdateInfoAndProvider(){await this.app.whenReady(),this.clientPromise==null&&(this.clientPromise=this.configOnDisk.value.then(n=>(0,ca.createClient)(n,this,this.createProviderRuntimeOptions())));const t=await this.clientPromise,r=await this.stagingUserIdPromise.value;return t.setRequestHeaders(this.computeFinalHeaders({"x-user-staging-id":r})),{info:await t.getLatestVersion(),provider:t}}createProviderRuntimeOptions(){return{isUseMultipleRangeRequest:!0,platform:this._testOnlyOptions==null?process.platform:this._testOnlyOptions.platform,executor:this.httpExecutor}}async doCheckForUpdates(){this.emit("checking-for-update");const t=await this.getUpdateInfoAndProvider(),r=t.info;if(!await this.isUpdateAvailable(r))return this._logger.info(`Update for version ${this.currentVersion.format()} is not available (latest version: ${r.version}, downgrade is ${this.allowDowngrade?"allowed":"disallowed"}).`),this.emit("update-not-available",r),{isUpdateAvailable:!1,versionInfo:r,updateInfo:r};this.updateInfoAndProvider=t,this.onUpdateAvailable(r);const n=new be.CancellationToken;return{isUpdateAvailable:!0,versionInfo:r,updateInfo:r,cancellationToken:n,downloadPromise:this.autoDownload?this.downloadUpdate(n):null}}onUpdateAvailable(t){this._logger.info(`Found version ${t.version} (url: ${(0,be.asArray)(t.files).map(r=>r.url).join(", ")})`),this.emit("update-available",t)}downloadUpdate(t=new be.CancellationToken){const r=this.updateInfoAndProvider;if(r==null){const i=new Error("Please check update first");return this.dispatchError(i),Promise.reject(i)}if(this.downloadPromise!=null)return this._logger.info("Downloading update (already in progress)"),this.downloadPromise;this._logger.info(`Downloading update from ${(0,be.asArray)(r.info.files).map(i=>i.url).join(", ")}`);const n=i=>{if(!(i instanceof be.CancellationError))try{this.dispatchError(i)}catch(a){this._logger.warn(`Cannot dispatch error event: ${a.stack||a}`)}return i};return this.downloadPromise=this.doDownloadUpdate({updateInfoAndProvider:r,requestHeaders:this.computeRequestHeaders(r.provider),cancellationToken:t,disableWebInstaller:this.disableWebInstaller,disableDifferentialDownload:this.disableDifferentialDownload}).catch(i=>{throw n(i)}).finally(()=>{this.downloadPromise=null}),this.downloadPromise}dispatchError(t){this.emit("error",t,(t.stack||t).toString())}dispatchUpdateDownloaded(t){this.emit(zt.UPDATE_DOWNLOADED,t)}async loadUpdateConfig(){return this._appUpdateConfigPath==null&&(this._appUpdateConfigPath=this.app.appUpdateConfigPath),(0,_v.load)(await(0,qe.readFile)(this._appUpdateConfigPath,"utf-8"))}computeRequestHeaders(t){const r=t.fileExtraDownloadHeaders;if(r!=null){const n=this.requestHeaders;return n==null?r:{...r,...n}}return this.computeFinalHeaders({accept:"*/*"})}async getOrCreateStagingUserId(){const t=Ve.join(this.app.userDataPath,".updaterId");try{const n=await(0,qe.readFile)(t,"utf-8");if(be.UUID.check(n))return n;this._logger.warn(`Staging user id file exists, but content was invalid: ${n}`)}catch(n){n.code!=="ENOENT"&&this._logger.warn(`Couldn't read staging user ID, creating a blank one: ${n}`)}const r=be.UUID.v5((0,Ev.randomBytes)(4096),be.UUID.OID);this._logger.info(`Generated new staging user ID: ${r}`);try{await(0,qe.outputFile)(t,r)}catch(n){this._logger.warn(`Couldn't write out staging user ID: ${n}`)}return r}get isAddNoCacheQuery(){const t=this.requestHeaders;if(t==null)return!0;for(const r of Object.keys(t)){const n=r.toLowerCase();if(n==="authorization"||n==="private-token")return!1}return!0}async getOrCreateDownloadHelper(){let t=this.downloadedUpdateHelper;if(t==null){const r=(await this.configOnDisk.value).updaterCacheDirName,n=this._logger;r==null&&n.error("updaterCacheDirName is not specified in app-update.yml Was app build using at least electron-builder 20.34.0?");const i=Ve.join(this.app.baseCachePath,r||this.app.name);n.debug!=null&&n.debug(`updater cache dir: ${i}`),t=new ul.DownloadedUpdateHelper(i),this.downloadedUpdateHelper=t}return t}async executeDownload(t){const r=t.fileInfo,n={headers:t.downloadUpdateOptions.requestHeaders,cancellationToken:t.downloadUpdateOptions.cancellationToken,sha2:r.info.sha2,sha512:r.info.sha512};this.listenerCount(zt.DOWNLOAD_PROGRESS)>0&&(n.onProgress=A=>this.emit(zt.DOWNLOAD_PROGRESS,A));const i=t.downloadUpdateOptions.updateInfoAndProvider.info,a=i.version,o=r.packageInfo;function s(){const A=decodeURIComponent(t.fileInfo.url.pathname);return A.toLowerCase().endsWith(`.${t.fileExtension.toLowerCase()}`)?Ve.basename(A):t.fileInfo.info.url}const l=await this.getOrCreateDownloadHelper(),h=l.cacheDirForPendingUpdate;await(0,qe.mkdir)(h,{recursive:!0});const c=s();let f=Ve.join(h,c);const d=o==null?null:Ve.join(h,`package-${a}${Ve.extname(o.path)||".7z"}`),m=async A=>{await l.setDownloadedFile(f,d,i,r,c,A),await t.done({...i,downloadedFile:f});const $=Ve.join(h,"current.blockmap");return await(0,qe.pathExists)($)&&await(0,qe.copyFile)($,Ve.join(l.cacheDir,"current.blockmap")),d==null?[f]:[f,d]},w=this._logger,E=await l.validateDownloadedPath(f,i,r,w);if(E!=null)return f=E,await m(!1);const T=async()=>(await l.clear().catch(()=>{}),await(0,qe.unlink)(f).catch(()=>{})),S=await(0,ul.createTempUpdateFile)(`temp-${c}`,h,w);try{await t.task(S,n,d,T),await(0,be.retry)(()=>(0,qe.rename)(S,f),{retries:60,interval:500,shouldRetry:A=>A instanceof Error&&/^EBUSY:/.test(A.message)?!0:(w.warn(`Cannot rename temp file to final file: ${A.message||A.stack}`),!1)})}catch(A){throw await T(),A instanceof be.CancellationError&&(w.info("cancelled"),this.emit("update-cancelled",i)),A}return w.info(`New version ${a} has been downloaded to ${f}`),await m(!0)}async differentialDownloadInstaller(t,r,n,i,a){try{if(this._testOnlyOptions!=null&&!this._testOnlyOptions.isUseDifferentialDownload)return!0;const o=r.updateInfoAndProvider.provider,s=await o.getBlockMapFiles(t.url,this.app.version,r.updateInfoAndProvider.info.version,this.previousBlockmapBaseUrlOverride);this._logger.info(`Download block maps (old: "${s[0]}", new: ${s[1]})`);const l=async w=>{const E=await this.httpExecutor.downloadToBuffer(w,{headers:r.requestHeaders,cancellationToken:r.cancellationToken});if(E==null||E.length===0)throw new Error(`Blockmap "${w.href}" is empty`);try{return JSON.parse((0,ua.gunzipSync)(E).toString())}catch(T){throw new Error(`Cannot parse blockmap "${w.href}", error: ${T}`)}},h={newUrl:t.url,oldFile:Ve.join(this.downloadedUpdateHelper.cacheDir,a),logger:this._logger,newFile:n,isUseMultipleRangeRequest:o.isUseMultipleRangeRequest,requestHeaders:r.requestHeaders,cancellationToken:r.cancellationToken};this.listenerCount(zt.DOWNLOAD_PROGRESS)>0&&(h.onProgress=w=>this.emit(zt.DOWNLOAD_PROGRESS,w));const c=async(w,E)=>{const T=Ve.join(E,"current.blockmap");await(0,qe.outputFile)(T,(0,ua.gzipSync)(JSON.stringify(w)))},f=async w=>{const E=Ve.join(w,"current.blockmap");try{if(await(0,qe.pathExists)(E))return JSON.parse((0,ua.gunzipSync)(await(0,qe.readFile)(E)).toString())}catch(T){this._logger.warn(`Cannot parse blockmap "${E}", error: ${T}`)}return null},d=await l(s[1]);await c(d,this.downloadedUpdateHelper.cacheDirForPendingUpdate);let m=await f(this.downloadedUpdateHelper.cacheDir);return m==null&&(m=await l(s[0])),await new Av.GenericDifferentialDownloader(t.info,this.httpExecutor,h).download(m,d),!1}catch(o){if(this._logger.error(`Cannot download differentially, fallback to full download: ${o.stack||o}`),this._testOnlyOptions!=null)throw o;return!0}}}yt.AppUpdater=so;function Sv(e){const t=(0,Ft.prerelease)(e);return t!=null&&t.length>0}class Xu{info(t){}warn(t){}error(t){}}yt.NoOpLogger=Xu;Object.defineProperty(Gt,"__esModule",{value:!0});Gt.BaseUpdater=void 0;const dl=Jn,Cv=yt;class Nv extends Cv.AppUpdater{constructor(t,r){super(t,r),this.quitAndInstallCalled=!1,this.quitHandlerAdded=!1}quitAndInstall(t=!1,r=!1){this._logger.info("Install on explicit quitAndInstall"),this.install(t,t?r:this.autoRunAppAfterInstall)?setImmediate(()=>{D.autoUpdater.emit("before-quit-for-update"),this.app.quit()}):this.quitAndInstallCalled=!1}executeDownload(t){return super.executeDownload({...t,done:r=>(this.dispatchUpdateDownloaded(r),this.addQuitHandler(),Promise.resolve())})}get installerPath(){return this.downloadedUpdateHelper==null?null:this.downloadedUpdateHelper.file}install(t=!1,r=!1){if(this.quitAndInstallCalled)return this._logger.warn("install call ignored: quitAndInstallCalled is set to true"),!1;const n=this.downloadedUpdateHelper,i=this.installerPath,a=n==null?null:n.downloadedFileInfo;if(i==null||a==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;this.quitAndInstallCalled=!0;try{return this._logger.info(`Install: isSilent: ${t}, isForceRunAfter: ${r}`),this.doInstall({isSilent:t,isForceRunAfter:r,isAdminRightsRequired:a.isAdminRightsRequired})}catch(o){return this.dispatchError(o),!1}}addQuitHandler(){this.quitHandlerAdded||!this.autoInstallOnAppQuit||(this.quitHandlerAdded=!0,this.app.onQuit(t=>{if(this.quitAndInstallCalled){this._logger.info("Update installer has already been triggered. Quitting application.");return}if(!this.autoInstallOnAppQuit){this._logger.info("Update will not be installed on quit because autoInstallOnAppQuit is set to false.");return}if(t!==0){this._logger.info(`Update will be not installed on quit because application is quitting with exit code ${t}`);return}this._logger.info("Auto install update on quit"),this.install(!0,!1)}))}spawnSyncLog(t,r=[],n={}){this._logger.info(`Executing: ${t} with args: ${r}`);const i=(0,dl.spawnSync)(t,r,{env:{...process.env,...n},encoding:"utf-8",shell:!0}),{error:a,status:o,stdout:s,stderr:l}=i;if(a!=null)throw this._logger.error(l),a;if(o!=null&&o!==0)throw this._logger.error(l),new Error(`Command ${t} exited with code ${o}`);return s.trim()}async spawnLog(t,r=[],n=void 0,i="ignore"){return this._logger.info(`Executing: ${t} with args: ${r}`),new Promise((a,o)=>{try{const s={stdio:i,env:n,detached:!0},l=(0,dl.spawn)(t,r,s);l.on("error",h=>{o(h)}),l.unref(),l.pid!==void 0&&a(!0)}catch(s){o(s)}})}}Gt.BaseUpdater=Nv;var Gr={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});sn.FileWithEmbeddedBlockMapDifferentialDownloader=void 0;const Kt=St,bv=on,Rv=Fl;class Iv extends bv.DifferentialDownloader{async download(){const t=this.blockAwareFileInfo,r=t.size,n=r-(t.blockMapSize+4);this.fileMetadataBuffer=await this.readRemoteBytes(n,r-1);const i=Yu(this.fileMetadataBuffer.slice(0,this.fileMetadataBuffer.length-4));await this.doDownload(await Ov(this.options.oldFile),i)}}sn.FileWithEmbeddedBlockMapDifferentialDownloader=Iv;function Yu(e){return JSON.parse((0,Rv.inflateRawSync)(e).toString())}async function Ov(e){const t=await(0,Kt.open)(e,"r");try{const r=(await(0,Kt.fstat)(t)).size,n=Buffer.allocUnsafe(4);await(0,Kt.read)(t,n,0,n.length,r-n.length);const i=Buffer.allocUnsafe(n.readUInt32BE(0));return await(0,Kt.read)(t,i,0,i.length,r-n.length-i.length),await(0,Kt.close)(t),Yu(i)}catch(r){throw await(0,Kt.close)(t),r}}Object.defineProperty(Gr,"__esModule",{value:!0});Gr.AppImageUpdater=void 0;const hl=he,pl=Jn,Dv=St,Pv=ue,br=V,Fv=Gt,$v=sn,Lv=fe,ml=Ct;class xv extends Fv.BaseUpdater{constructor(t,r){super(t,r)}isUpdaterActive(){return process.env.APPIMAGE==null&&!this.forceDevUpdateConfig?(process.env.SNAP==null?this._logger.warn("APPIMAGE env is not defined, current application is not an AppImage"):this._logger.info("SNAP env is defined, updater is disabled"),!1):super.isUpdaterActive()}doDownloadUpdate(t){const r=t.updateInfoAndProvider.provider,n=(0,Lv.findFile)(r.resolveFiles(t.updateInfoAndProvider.info),"AppImage",["rpm","deb","pacman"]);return this.executeDownload({fileExtension:"AppImage",fileInfo:n,downloadUpdateOptions:t,task:async(i,a)=>{const o=process.env.APPIMAGE;if(o==null)throw(0,hl.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");(t.disableDifferentialDownload||await this.downloadDifferential(n,o,i,r,t))&&await this.httpExecutor.download(n.url,i,a),await(0,Dv.chmod)(i,493)}})}async downloadDifferential(t,r,n,i,a){try{const o={newUrl:t.url,oldFile:r,logger:this._logger,newFile:n,isUseMultipleRangeRequest:i.isUseMultipleRangeRequest,requestHeaders:a.requestHeaders,cancellationToken:a.cancellationToken};return this.listenerCount(ml.DOWNLOAD_PROGRESS)>0&&(o.onProgress=s=>this.emit(ml.DOWNLOAD_PROGRESS,s)),await new $v.FileWithEmbeddedBlockMapDifferentialDownloader(t.info,this.httpExecutor,o).download(),!1}catch(o){return this._logger.error(`Cannot download differentially, fallback to full download: ${o.stack||o}`),process.platform==="linux"}}doInstall(t){const r=process.env.APPIMAGE;if(r==null)throw(0,hl.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");(0,Pv.unlinkSync)(r);let n;const i=br.basename(r),a=this.installerPath;if(a==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;br.basename(a)===i||!/\d+\.\d+\.\d+/.test(i)?n=r:n=br.join(br.dirname(r),br.basename(a)),(0,pl.execFileSync)("mv",["-f",a,n]),n!==r&&this.emit("appimage-filename-updated",n);const o={...process.env,APPIMAGE_SILENT_INSTALL:"true"};return t.isForceRunAfter?this.spawnLog(n,[],o):(o.APPIMAGE_EXIT_AFTER_INSTALL="true",(0,pl.execFileSync)(n,[],{env:o})),!0}}Gr.AppImageUpdater=xv;var qr={},yr={};Object.defineProperty(yr,"__esModule",{value:!0});yr.LinuxUpdater=void 0;const Uv=Gt;class kv extends Uv.BaseUpdater{constructor(t,r){super(t,r)}isRunningAsRoot(){var t;return((t=process.getuid)===null||t===void 0?void 0:t.call(process))===0}get installerPath(){var t,r;return(r=(t=super.installerPath)===null||t===void 0?void 0:t.replace(/\\/g,"\\\\").replace(/ /g,"\\ "))!==null&&r!==void 0?r:null}runCommandWithSudoIfNeeded(t){if(this.isRunningAsRoot())return this._logger.info("Running as root, no need to use sudo"),this.spawnSyncLog(t[0],t.slice(1));const{name:r}=this.app,n=`"${r} would like to update"`,i=this.sudoWithArgs(n);this._logger.info(`Running as non-root user, using sudo to install: ${i}`);let a='"';return(/pkexec/i.test(i[0])||i[0]==="sudo")&&(a=""),this.spawnSyncLog(i[0],[...i.length>1?i.slice(1):[],`${a}/bin/bash`,"-c",`'${t.join(" ")}'${a}`])}sudoWithArgs(t){const r=this.determineSudoCommand(),n=[r];return/kdesudo/i.test(r)?(n.push("--comment",t),n.push("-c")):/gksudo/i.test(r)?n.push("--message",t):/pkexec/i.test(r)&&n.push("--disable-internal-agent"),n}hasCommand(t){try{return this.spawnSyncLog("command",["-v",t]),!0}catch{return!1}}determineSudoCommand(){const t=["gksudo","kdesudo","pkexec","beesu"];for(const r of t)if(this.hasCommand(r))return r;return"sudo"}detectPackageManager(t){var r;const n=(r=process.env.ELECTRON_BUILDER_LINUX_PACKAGE_MANAGER)===null||r===void 0?void 0:r.trim();if(n)return n;for(const i of t)if(this.hasCommand(i))return i;return this._logger.warn(`No package manager found in the list: ${t.join(", ")}. Defaulting to the first one: ${t[0]}`),t[0]}}yr.LinuxUpdater=kv;Object.defineProperty(qr,"__esModule",{value:!0});qr.DebUpdater=void 0;const Mv=fe,gl=Ct,Bv=yr;class lo extends Bv.LinuxUpdater{constructor(t,r){super(t,r)}doDownloadUpdate(t){const r=t.updateInfoAndProvider.provider,n=(0,Mv.findFile)(r.resolveFiles(t.updateInfoAndProvider.info),"deb",["AppImage","rpm","pacman"]);return this.executeDownload({fileExtension:"deb",fileInfo:n,downloadUpdateOptions:t,task:async(i,a)=>{this.listenerCount(gl.DOWNLOAD_PROGRESS)>0&&(a.onProgress=o=>this.emit(gl.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(n.url,i,a)}})}doInstall(t){const r=this.installerPath;if(r==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;if(!this.hasCommand("dpkg")&&!this.hasCommand("apt"))return this.dispatchError(new Error("Neither dpkg nor apt command found. Cannot install .deb package.")),!1;const n=["dpkg","apt"],i=this.detectPackageManager(n);try{lo.installWithCommandRunner(i,r,this.runCommandWithSudoIfNeeded.bind(this),this._logger)}catch(a){return this.dispatchError(a),!1}return t.isForceRunAfter&&this.app.relaunch(),!0}static installWithCommandRunner(t,r,n,i){var a;if(t==="dpkg")try{n(["dpkg","-i",r])}catch(o){i.warn((a=o.message)!==null&&a!==void 0?a:o),i.warn("dpkg installation failed, trying to fix broken dependencies with apt-get"),n(["apt-get","install","-f","-y"])}else if(t==="apt")i.warn("Using apt to install a local .deb. This may fail for unsigned packages unless properly configured."),n(["apt","install","-y","--allow-unauthenticated","--allow-downgrades","--allow-change-held-packages",r]);else throw new Error(`Package manager ${t} not supported`)}}qr.DebUpdater=lo;var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0});Vr.PacmanUpdater=void 0;const El=Ct,Hv=fe,jv=yr;class co extends jv.LinuxUpdater{constructor(t,r){super(t,r)}doDownloadUpdate(t){const r=t.updateInfoAndProvider.provider,n=(0,Hv.findFile)(r.resolveFiles(t.updateInfoAndProvider.info),"pacman",["AppImage","deb","rpm"]);return this.executeDownload({fileExtension:"pacman",fileInfo:n,downloadUpdateOptions:t,task:async(i,a)=>{this.listenerCount(El.DOWNLOAD_PROGRESS)>0&&(a.onProgress=o=>this.emit(El.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(n.url,i,a)}})}doInstall(t){const r=this.installerPath;if(r==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;try{co.installWithCommandRunner(r,this.runCommandWithSudoIfNeeded.bind(this),this._logger)}catch(n){return this.dispatchError(n),!1}return t.isForceRunAfter&&this.app.relaunch(),!0}static installWithCommandRunner(t,r,n){var i;try{r(["pacman","-U","--noconfirm",t])}catch(a){n.warn((i=a.message)!==null&&i!==void 0?i:a),n.warn("pacman installation failed, attempting to update package database and retry");try{r(["pacman","-Sy","--noconfirm"]),r(["pacman","-U","--noconfirm",t])}catch(o){throw n.error("Retry after pacman -Sy failed"),o}}}}Vr.PacmanUpdater=co;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.RpmUpdater=void 0;const yl=Ct,Gv=fe,qv=yr;class uo extends qv.LinuxUpdater{constructor(t,r){super(t,r)}doDownloadUpdate(t){const r=t.updateInfoAndProvider.provider,n=(0,Gv.findFile)(r.resolveFiles(t.updateInfoAndProvider.info),"rpm",["AppImage","deb","pacman"]);return this.executeDownload({fileExtension:"rpm",fileInfo:n,downloadUpdateOptions:t,task:async(i,a)=>{this.listenerCount(yl.DOWNLOAD_PROGRESS)>0&&(a.onProgress=o=>this.emit(yl.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(n.url,i,a)}})}doInstall(t){const r=this.installerPath;if(r==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;const n=["zypper","dnf","yum","rpm"],i=this.detectPackageManager(n);try{uo.installWithCommandRunner(i,r,this.runCommandWithSudoIfNeeded.bind(this),this._logger)}catch(a){return this.dispatchError(a),!1}return t.isForceRunAfter&&this.app.relaunch(),!0}static installWithCommandRunner(t,r,n,i){if(t==="zypper")return n(["zypper","--non-interactive","--no-refresh","install","--allow-unsigned-rpm","-f",r]);if(t==="dnf")return n(["dnf","install","--nogpgcheck","-y",r]);if(t==="yum")return n(["yum","install","--nogpgcheck","-y",r]);if(t==="rpm")return i.warn("Installing with rpm only (no dependency resolution)."),n(["rpm","-Uvh","--replacepkgs","--replacefiles","--nodeps",r]);throw new Error(`Package manager ${t} not supported`)}}Wr.RpmUpdater=uo;var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.MacUpdater=void 0;const wl=he,fa=St,Vv=ue,_l=V,Wv=hd,Xv=yt,Yv=fe,vl=Jn,Tl=hr;class zv extends Xv.AppUpdater{constructor(t,r){super(t,r),this.nativeUpdater=D.autoUpdater,this.squirrelDownloadedUpdate=!1,this.nativeUpdater.on("error",n=>{this._logger.warn(n),this.emit("error",n)}),this.nativeUpdater.on("update-downloaded",()=>{this.squirrelDownloadedUpdate=!0,this.debug("nativeUpdater.update-downloaded")})}debug(t){this._logger.debug!=null&&this._logger.debug(t)}closeServerIfExists(){this.server&&(this.debug("Closing proxy server"),this.server.close(t=>{t&&this.debug("proxy server wasn't already open, probably attempted closing again as a safety check before quit")}))}async doDownloadUpdate(t){let r=t.updateInfoAndProvider.provider.resolveFiles(t.updateInfoAndProvider.info);const n=this._logger,i="sysctl.proc_translated";let a=!1;try{this.debug("Checking for macOS Rosetta environment"),a=(0,vl.execFileSync)("sysctl",[i],{encoding:"utf8"}).includes(`${i}: 1`),n.info(`Checked for macOS Rosetta environment (isRosetta=${a})`)}catch(f){n.warn(`sysctl shell command to check for macOS Rosetta environment failed: ${f}`)}let o=!1;try{this.debug("Checking for arm64 in uname");const d=(0,vl.execFileSync)("uname",["-a"],{encoding:"utf8"}).includes("ARM");n.info(`Checked 'uname -a': arm64=${d}`),o=o||d}catch(f){n.warn(`uname shell command to check for arm64 failed: ${f}`)}o=o||process.arch==="arm64"||a;const s=f=>{var d;return f.url.pathname.includes("arm64")||((d=f.info.url)===null||d===void 0?void 0:d.includes("arm64"))};o&&r.some(s)?r=r.filter(f=>o===s(f)):r=r.filter(f=>!s(f));const l=(0,Yv.findFile)(r,"zip",["pkg","dmg"]);if(l==null)throw(0,wl.newError)(`ZIP file not provided: ${(0,wl.safeStringifyJson)(r)}`,"ERR_UPDATER_ZIP_FILE_NOT_FOUND");const h=t.updateInfoAndProvider.provider,c="update.zip";return this.executeDownload({fileExtension:"zip",fileInfo:l,downloadUpdateOptions:t,task:async(f,d)=>{const m=_l.join(this.downloadedUpdateHelper.cacheDir,c),w=()=>(0,fa.pathExistsSync)(m)?!t.disableDifferentialDownload:(n.info("Unable to locate previous update.zip for differential download (is this first install?), falling back to full download"),!1);let E=!0;w()&&(E=await this.differentialDownloadInstaller(l,t,f,h,c)),E&&await this.httpExecutor.download(l.url,f,d)},done:async f=>{if(!t.disableDifferentialDownload)try{const d=_l.join(this.downloadedUpdateHelper.cacheDir,c);await(0,fa.copyFile)(f.downloadedFile,d)}catch(d){this._logger.warn(`Unable to copy file for caching for future differential downloads: ${d.message}`)}return this.updateDownloaded(l,f)}})}async updateDownloaded(t,r){var n;const i=r.downloadedFile,a=(n=t.info.size)!==null&&n!==void 0?n:(await(0,fa.stat)(i)).size,o=this._logger,s=`fileToProxy=${t.url.href}`;this.closeServerIfExists(),this.debug(`Creating proxy server for native Squirrel.Mac (${s})`),this.server=(0,Wv.createServer)(),this.debug(`Proxy server for native Squirrel.Mac is created (${s})`),this.server.on("close",()=>{o.info(`Proxy server for native Squirrel.Mac is closed (${s})`)});const l=h=>{const c=h.address();return typeof c=="string"?c:`http://127.0.0.1:${c==null?void 0:c.port}`};return await new Promise((h,c)=>{const f=(0,Tl.randomBytes)(64).toString("base64").replace(/\//g,"_").replace(/\+/g,"-"),d=Buffer.from(`autoupdater:${f}`,"ascii"),m=`/${(0,Tl.randomBytes)(64).toString("hex")}.zip`;this.server.on("request",(w,E)=>{const T=w.url;if(o.info(`${T} requested`),T==="/"){if(!w.headers.authorization||w.headers.authorization.indexOf("Basic ")===-1){E.statusCode=401,E.statusMessage="Invalid Authentication Credentials",E.end(),o.warn("No authenthication info");return}const $=w.headers.authorization.split(" ")[1],P=Buffer.from($,"base64").toString("ascii"),[J,ne]=P.split(":");if(J!=="autoupdater"||ne!==f){E.statusCode=401,E.statusMessage="Invalid Authentication Credentials",E.end(),o.warn("Invalid authenthication credentials");return}const X=Buffer.from(`{ "url": "${l(this.server)}${m}" }`);E.writeHead(200,{"Content-Type":"application/json","Content-Length":X.length}),E.end(X);return}if(!T.startsWith(m)){o.warn(`${T} requested, but not supported`),E.writeHead(404),E.end();return}o.info(`${m} requested by Squirrel.Mac, pipe ${i}`);let S=!1;E.on("finish",()=>{S||(this.nativeUpdater.removeListener("error",c),h([]))});const A=(0,Vv.createReadStream)(i);A.on("error",$=>{try{E.end()}catch(P){o.warn(`cannot end response: ${P}`)}S=!0,this.nativeUpdater.removeListener("error",c),c(new Error(`Cannot pipe "${i}": ${$}`))}),E.writeHead(200,{"Content-Type":"application/zip","Content-Length":a}),A.pipe(E)}),this.debug(`Proxy server for native Squirrel.Mac is starting to listen (${s})`),this.server.listen(0,"127.0.0.1",()=>{this.debug(`Proxy server for native Squirrel.Mac is listening (address=${l(this.server)}, ${s})`),this.nativeUpdater.setFeedURL({url:l(this.server),headers:{"Cache-Control":"no-cache",Authorization:`Basic ${d.toString("base64")}`}}),this.dispatchUpdateDownloaded(r),this.autoInstallOnAppQuit?(this.nativeUpdater.once("error",c),this.nativeUpdater.checkForUpdates()):h([])})})}handleUpdateDownloaded(){this.autoRunAppAfterInstall?this.nativeUpdater.quitAndInstall():this.app.quit(),this.closeServerIfExists()}quitAndInstall(){this.squirrelDownloadedUpdate?this.handleUpdateDownloaded():(this.nativeUpdater.on("update-downloaded",()=>this.handleUpdateDownloaded()),this.autoInstallOnAppQuit||this.nativeUpdater.checkForUpdates())}}Xr.MacUpdater=zv;var Yr={},fo={};Object.defineProperty(fo,"__esModule",{value:!0});fo.verifySignature=Jv;const Al=he,zu=Jn,Kv=Qn,Sl=V;function Ku(e,t){return['set "PSModulePath=" & chcp 65001 >NUL & powershell.exe',["-NoProfile","-NonInteractive","-InputFormat","None","-Command",e],{shell:!0,timeout:t}]}function Jv(e,t,r){return new Promise((n,i)=>{const a=t.replace(/'/g,"''");r.info(`Verifying signature ${a}`),(0,zu.execFile)(...Ku(`"Get-AuthenticodeSignature -LiteralPath '${a}' | ConvertTo-Json -Compress"`,20*1e3),(o,s,l)=>{var h;try{if(o!=null||l){da(r,o,l,i),n(null);return}const c=Qv(s);if(c.Status===0){try{const w=Sl.normalize(c.Path),E=Sl.normalize(t);if(r.info(`LiteralPath: ${w}. Update Path: ${E}`),w!==E){da(r,new Error(`LiteralPath of ${w} is different than ${E}`),l,i),n(null);return}}catch(w){r.warn(`Unable to verify LiteralPath of update asset due to missing data.Path. Skipping this step of validation. Message: ${(h=w.message)!==null&&h!==void 0?h:w.stack}`)}const d=(0,Al.parseDn)(c.SignerCertificate.Subject);let m=!1;for(const w of e){const E=(0,Al.parseDn)(w);if(E.size?m=Array.from(E.keys()).every(S=>E.get(S)===d.get(S)):w===d.get("CN")&&(r.warn(`Signature validated using only CN ${w}. Please add your full Distinguished Name (DN) to publisherNames configuration`),m=!0),m){n(null);return}}}const f=`publisherNames: ${e.join(" | ")}, raw info: `+JSON.stringify(c,(d,m)=>d==="RawData"?void 0:m,2);r.warn(`Sign verification failed, installer signed with incorrect certificate: ${f}`),n(f)}catch(c){da(r,c,null,i),n(null);return}})})}function Qv(e){const t=JSON.parse(e);delete t.PrivateKey,delete t.IsOSBinary,delete t.SignatureType;const r=t.SignerCertificate;return r!=null&&(delete r.Archived,delete r.Extensions,delete r.Handle,delete r.HasPrivateKey,delete r.SubjectName),t}function da(e,t,r,n){if(Zv()){e.warn(`Cannot execute Get-AuthenticodeSignature: ${t||r}. Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher.`);return}try{(0,zu.execFileSync)(...Ku("ConvertTo-Json test",10*1e3))}catch(i){e.warn(`Cannot execute ConvertTo-Json: ${i.message}. Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher.`);return}t!=null&&n(t),r&&n(new Error(`Cannot execute Get-AuthenticodeSignature, stderr: ${r}. Failing signature validation due to unknown stderr.`))}function Zv(){const e=Kv.release();return e.startsWith("6.")&&!e.startsWith("6.3")}Object.defineProperty(Yr,"__esModule",{value:!0});Yr.NsisUpdater=void 0;const $n=he,Cl=V,eT=Gt,tT=sn,Nl=Ct,rT=fe,nT=St,iT=fo,bl=st;class aT extends eT.BaseUpdater{constructor(t,r){super(t,r),this._verifyUpdateCodeSignature=(n,i)=>(0,iT.verifySignature)(n,i,this._logger)}get verifyUpdateCodeSignature(){return this._verifyUpdateCodeSignature}set verifyUpdateCodeSignature(t){t&&(this._verifyUpdateCodeSignature=t)}doDownloadUpdate(t){const r=t.updateInfoAndProvider.provider,n=(0,rT.findFile)(r.resolveFiles(t.updateInfoAndProvider.info),"exe");return this.executeDownload({fileExtension:"exe",downloadUpdateOptions:t,fileInfo:n,task:async(i,a,o,s)=>{const l=n.packageInfo,h=l!=null&&o!=null;if(h&&t.disableWebInstaller)throw(0,$n.newError)(`Unable to download new version ${t.updateInfoAndProvider.info.version}. Web Installers are disabled`,"ERR_UPDATER_WEB_INSTALLER_DISABLED");!h&&!t.disableWebInstaller&&this._logger.warn("disableWebInstaller is set to false, you should set it to true if you do not plan on using a web installer. This will default to true in a future version."),(h||t.disableDifferentialDownload||await this.differentialDownloadInstaller(n,t,i,r,$n.CURRENT_APP_INSTALLER_FILE_NAME))&&await this.httpExecutor.download(n.url,i,a);const c=await this.verifySignature(i);if(c!=null)throw await s(),(0,$n.newError)(`New version ${t.updateInfoAndProvider.info.version} is not signed by the application owner: ${c}`,"ERR_UPDATER_INVALID_SIGNATURE");if(h&&await this.differentialDownloadWebPackage(t,l,o,r))try{await this.httpExecutor.download(new bl.URL(l.path),o,{headers:t.requestHeaders,cancellationToken:t.cancellationToken,sha512:l.sha512})}catch(f){try{await(0,nT.unlink)(o)}catch{}throw f}}})}async verifySignature(t){let r;try{if(r=(await this.configOnDisk.value).publisherName,r==null)return null}catch(n){if(n.code==="ENOENT")return null;throw n}return await this._verifyUpdateCodeSignature(Array.isArray(r)?r:[r],t)}doInstall(t){const r=this.installerPath;if(r==null)return this.dispatchError(new Error("No update filepath provided, can't quit and install")),!1;const n=["--updated"];t.isSilent&&n.push("/S"),t.isForceRunAfter&&n.push("--force-run"),this.installDirectory&&n.push(`/D=${this.installDirectory}`);const i=this.downloadedUpdateHelper==null?null:this.downloadedUpdateHelper.packageFile;i!=null&&n.push(`--package-file=${i}`);const a=()=>{this.spawnLog(Cl.join(process.resourcesPath,"elevate.exe"),[r].concat(n)).catch(o=>this.dispatchError(o))};return t.isAdminRightsRequired?(this._logger.info("isAdminRightsRequired is set to true, run installer using elevate.exe"),a(),!0):(this.spawnLog(r,n).catch(o=>{const s=o.code;this._logger.info(`Cannot run installer: error code: ${s}, error message: "${o.message}", will be executed again using elevate if EACCES, and will try to use electron.shell.openItem if ENOENT`),s==="UNKNOWN"||s==="EACCES"?a():s==="ENOENT"?D.shell.openPath(r).catch(l=>this.dispatchError(l)):this.dispatchError(o)}),!0)}async differentialDownloadWebPackage(t,r,n,i){if(r.blockMapSize==null)return!0;try{const a={newUrl:new bl.URL(r.path),oldFile:Cl.join(this.downloadedUpdateHelper.cacheDir,$n.CURRENT_APP_PACKAGE_FILE_NAME),logger:this._logger,newFile:n,requestHeaders:this.requestHeaders,isUseMultipleRangeRequest:i.isUseMultipleRangeRequest,cancellationToken:t.cancellationToken};this.listenerCount(Nl.DOWNLOAD_PROGRESS)>0&&(a.onProgress=o=>this.emit(Nl.DOWNLOAD_PROGRESS,o)),await new tT.FileWithEmbeddedBlockMapDifferentialDownloader(r,this.httpExecutor,a).download()}catch(a){return this._logger.error(`Cannot download differentially, fallback to full download: ${a.stack||a}`),process.platform==="win32"}return!1}}Yr.NsisUpdater=aT;(function(e){var t=Re&&Re.__createBinding||(Object.create?function(T,S,A,$){$===void 0&&($=A);var P=Object.getOwnPropertyDescriptor(S,A);(!P||("get"in P?!S.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return S[A]}}),Object.defineProperty(T,$,P)}:function(T,S,A,$){$===void 0&&($=A),T[$]=S[A]}),r=Re&&Re.__exportStar||function(T,S){for(var A in T)A!=="default"&&!Object.prototype.hasOwnProperty.call(S,A)&&t(S,T,A)};Object.defineProperty(e,"__esModule",{value:!0}),e.NsisUpdater=e.MacUpdater=e.RpmUpdater=e.PacmanUpdater=e.DebUpdater=e.AppImageUpdater=e.Provider=e.NoOpLogger=e.AppUpdater=e.BaseUpdater=void 0;const n=St,i=V;var a=Gt;Object.defineProperty(e,"BaseUpdater",{enumerable:!0,get:function(){return a.BaseUpdater}});var o=yt;Object.defineProperty(e,"AppUpdater",{enumerable:!0,get:function(){return o.AppUpdater}}),Object.defineProperty(e,"NoOpLogger",{enumerable:!0,get:function(){return o.NoOpLogger}});var s=fe;Object.defineProperty(e,"Provider",{enumerable:!0,get:function(){return s.Provider}});var l=Gr;Object.defineProperty(e,"AppImageUpdater",{enumerable:!0,get:function(){return l.AppImageUpdater}});var h=qr;Object.defineProperty(e,"DebUpdater",{enumerable:!0,get:function(){return h.DebUpdater}});var c=Vr;Object.defineProperty(e,"PacmanUpdater",{enumerable:!0,get:function(){return c.PacmanUpdater}});var f=Wr;Object.defineProperty(e,"RpmUpdater",{enumerable:!0,get:function(){return f.RpmUpdater}});var d=Xr;Object.defineProperty(e,"MacUpdater",{enumerable:!0,get:function(){return d.MacUpdater}});var m=Yr;Object.defineProperty(e,"NsisUpdater",{enumerable:!0,get:function(){return m.NsisUpdater}}),r(Ct,e);let w;function E(){if(process.platform==="win32")w=new Yr.NsisUpdater;else if(process.platform==="darwin")w=new Xr.MacUpdater;else{w=new Gr.AppImageUpdater;try{const T=i.join(process.resourcesPath,"package-type");if(!(0,n.existsSync)(T))return w;console.info("Checking for beta autoupdate feature for deb/rpm distributions");const S=(0,n.readFileSync)(T).toString().trim();switch(console.info("Found package-type:",S),S){case"deb":w=new qr.DebUpdater;break;case"rpm":w=new Wr.RpmUpdater;break;case"pacman":w=new Vr.PacmanUpdater;break;default:break}}catch(T){console.warn("Unable to detect 'package-type' for autoUpdater (rpm/deb/pacman support). If you'd like to expand support, please consider contributing to electron-builder",T.message)}}return w}Object.defineProperty(e,"autoUpdater",{enumerable:!0,get:()=>w||E()})})(Le);let sr=null;function oT(e){sr=e,Le.autoUpdater.autoDownload=!1,Le.autoUpdater.autoInstallOnAppQuit=!0,Le.autoUpdater.setFeedURL({provider:"generic",url:"https://hardwavestudios.com/downloads/updates"}),Le.autoUpdater.on("checking-for-update",()=>{console.log("Checking for updates..."),Jt("update:checking")}),Le.autoUpdater.on("update-available",t=>{console.log("Update available:",t.version),Jt("update:available",{version:t.version,releaseDate:t.releaseDate,releaseNotes:t.releaseNotes})}),Le.autoUpdater.on("update-not-available",()=>{console.log("No updates available"),Jt("update:not-available")}),Le.autoUpdater.on("download-progress",t=>{console.log(`Download progress: ${t.percent.toFixed(1)}%`),Jt("update:progress",{percent:t.percent,bytesPerSecond:t.bytesPerSecond,transferred:t.transferred,total:t.total})}),Le.autoUpdater.on("update-downloaded",t=>{console.log("Update downloaded:",t.version),Jt("update:downloaded",{version:t.version})}),Le.autoUpdater.on("error",t=>{console.error("Update error:",t),Jt("update:error",{message:t.message})})}function Jt(e,t){sr&&!sr.isDestroyed()&&sr.webContents.send(e,t)}function Ju(){Le.autoUpdater.checkForUpdates().catch(e=>{console.error("Failed to check for updates:",e)})}function Qu(){Le.autoUpdater.downloadUpdate().catch(e=>{console.error("Failed to download update:",e)})}function sT(){Le.autoUpdater.quitAndInstall(!1,!0)}async function lT(){try{const e=await Le.autoUpdater.checkForUpdates();e&&e.updateInfo?(await D.dialog.showMessageBox(sr,{type:"info",title:"Update Available",message:`A new version (${e.updateInfo.version}) is available!`,detail:"Would you like to download and install it now?",buttons:["Download","Later"],defaultId:0})).response===0&&Qu():await D.dialog.showMessageBox(sr,{type:"info",title:"No Updates",message:"You are running the latest version!",buttons:["OK"]})}catch(e){console.error("Manual update check failed:",e)}}const Zu="https://hardwavestudios.com/api/cloud",ef=[".wav",".mp3",".flac",".ogg",".aiff"];function cT(e){const t=V.extname(e).toLowerCase();return ef.includes(t)}function uT(e){const t=V.extname(e).toLowerCase();return{".wav":"audio/wav",".mp3":"audio/mpeg",".flac":"audio/flac",".ogg":"audio/ogg",".aiff":"audio/aiff"}[t]||"application/octet-stream"}function fT(){return"----ElectronUpload"+Math.random().toString(36).substring(2)}async function tf(e,t={}){const r=ei();if(!r)return{success:!1,error:"Not authenticated"};if(!cT(e))return{success:!1,error:`File type not allowed. Allowed: ${ef.join(", ")}`};const n=V.basename(e),a=ue.statSync(e).size,o=uT(e),s=fT(),l=t.metadata?JSON.stringify({[n]:t.metadata}):"{}",h=`--${s}\r
Content-Disposition: form-data; name="metadata"\r
Content-Type: application/json\r
\r
${l}\r
`,c=`--${s}\r
Content-Disposition: form-data; name="files"; filename="${n}"\r
Content-Type: ${o}\r
\r
`,f=`\r
--${s}--\r
`,d=Buffer.from(h+c),m=Buffer.from(f),w=d.length+a+m.length;return new Promise(E=>{const T=D.net.request({method:"POST",url:`${Zu}/upload`});T.setHeader("Authorization",`Bearer ${r}`),T.setHeader("Content-Type",`multipart/form-data; boundary=${s}`),T.setHeader("Content-Length",String(w));let S="",A=0;t.onProgress&&t.onProgress({filename:n,loaded:0,total:a,percent:0,status:"uploading"}),T.on("response",P=>{P.on("data",J=>{S+=J.toString()}),P.on("end",()=>{var J,ne;try{const X=JSON.parse(S);if(P.statusCode&&P.statusCode>=400)t.onProgress&&t.onProgress({filename:n,loaded:A,total:a,percent:100,status:"error",error:X.error||`HTTP ${P.statusCode}`}),E({success:!1,error:X.error||`Upload failed with status ${P.statusCode}`});else{t.onProgress&&t.onProgress({filename:n,loaded:a,total:a,percent:100,status:"complete"});const Ce=(ne=(J=X.data)==null?void 0:J.uploaded)==null?void 0:ne[0];E({success:!0,file:Ce})}}catch{t.onProgress&&t.onProgress({filename:n,loaded:A,total:a,percent:100,status:"error",error:"Failed to parse response"}),E({success:!1,error:"Failed to parse server response"})}})}),T.on("error",P=>{t.onProgress&&t.onProgress({filename:n,loaded:A,total:a,percent:Math.round(A/a*100),status:"error",error:P.message}),E({success:!1,error:P.message})}),T.write(d);const $=ue.createReadStream(e);$.on("data",P=>{T.write(P),A+=P.length,t.onProgress&&t.onProgress({filename:n,loaded:A,total:a,percent:Math.round(A/a*100),status:"uploading"})}),$.on("end",()=>{T.write(m),T.end()}),$.on("error",P=>{t.onProgress&&t.onProgress({filename:n,loaded:A,total:a,percent:Math.round(A/a*100),status:"error",error:P.message}),E({success:!1,error:P.message})})})}async function dT(e,t){const r={current:0,total:e.length,currentFile:null,completed:[],failed:[]};for(let n=0;n<e.length;n++){const i=e[n],a=V.basename(i);r.current=n+1;try{const o=await tf(i,{onProgress:s=>{r.currentFile=s,t==null||t(r)}});o.success?r.completed.push(o):r.failed.push({filename:a,error:o.error||"Unknown error"})}catch(o){r.failed.push({filename:a,error:o instanceof Error?o.message:"Upload failed"})}t==null||t(r)}return r.currentFile=null,r}async function hT(e,t,r){const n=ei();return n?new Promise(i=>{const a=D.net.request({method:"GET",url:`${Zu}/download/${e}`});a.setHeader("Authorization",`Bearer ${n}`);const{createWriteStream:o}=require("fs");let s=null,l=0,h=0;a.on("response",c=>{if(c.statusCode&&c.statusCode>=400){let d="";c.on("data",m=>{d+=m.toString()}),c.on("end",()=>{try{const m=JSON.parse(d);i({success:!1,error:m.error||`HTTP ${c.statusCode}`})}catch{i({success:!1,error:`Download failed with status ${c.statusCode}`})}});return}const f=c.headers["content-length"];f&&(l=parseInt(Array.isArray(f)?f[0]:f)),s=o(t),c.on("data",d=>{s==null||s.write(d),h+=d.length,r==null||r(h,l)}),c.on("end",()=>{s==null||s.end(),i({success:!0})})}),a.on("error",c=>{s==null||s.destroy(),i({success:!1,error:c.message})}),a.end()}):{success:!1,error:"Not authenticated"}}const Rl=V.dirname(st.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:Di&&Di.tagName.toUpperCase()==="SCRIPT"&&Di.src||new URL("main.js",document.baseURI).href));process.platform==="win32"&&D.app.disableHardwareAcceleration();let K=null;function Il(){K=new D.BrowserWindow({width:1200,height:800,minWidth:800,minHeight:600,backgroundColor:"#08080c",frame:!0,webPreferences:{preload:V.join(Rl,"preload.js"),nodeIntegration:!1,contextIsolation:!0,webSecurity:!0},show:!1}),K.once("ready-to-show",()=>{K==null||K.show()}),process.env.VITE_DEV_SERVER_URL?(K.loadURL(process.env.VITE_DEV_SERVER_URL),K.webContents.openDevTools()):K.loadFile(V.join(Rl,"../dist/index.html")),K.on("closed",()=>{K=null}),process.env.VITE_DEV_SERVER_URL||(oT(K),setTimeout(()=>{Ju()},5e3))}D.app.whenReady().then(()=>{Il(),D.app.on("activate",()=>{D.BrowserWindow.getAllWindows().length===0&&Il()})});D.app.on("window-all-closed",()=>{process.platform!=="darwin"&&D.app.quit()});D.ipcMain.handle("auth:login",async(e,t,r)=>await pd(t,r));D.ipcMain.handle("auth:logout",async()=>(Ll(),{success:!0}));D.ipcMain.handle("auth:verify",async()=>await md());D.ipcMain.handle("auth:getUser",async()=>{const e=gd();return e?{user:e.user,subscription:e.subscription}:null});D.ipcMain.handle("auth:hasSubscription",async()=>Ed());D.ipcMain.handle("auth:openSubscribe",async()=>{D.shell.openExternal("https://hardwavestudios.com/dashboard/subscription")});D.ipcMain.handle("update:check",async()=>{Ju()});D.ipcMain.handle("update:checkManual",async()=>{lT()});D.ipcMain.handle("update:download",async()=>{Qu()});D.ipcMain.handle("update:install",async()=>{sT()});D.ipcMain.handle("app:getVersion",()=>D.app.getVersion());D.ipcMain.handle("app:getPlatform",()=>process.platform);D.ipcMain.handle("ping",()=>"pong");D.ipcMain.handle("files:search",async(e,t,r)=>{try{return(await At.search(t,r)).files}catch(n){throw console.error("Error searching files:",n),n}});D.ipcMain.handle("files:getById",async(e,t)=>{try{return await At.getById(t)}catch(r){throw console.error("Error getting file:",r),r}});D.ipcMain.handle("files:getAll",async(e,t,r)=>{try{return await At.getAll(t||100,r||0)}catch(n){throw console.error("Error getting files:",n),n}});D.ipcMain.handle("files:update",async(e,t,r)=>{try{await At.update(t,r)}catch(n){throw console.error("Error updating file:",n),n}});D.ipcMain.handle("files:delete",async(e,t)=>{try{await At.delete(t)}catch(r){throw console.error("Error deleting file:",r),r}});D.ipcMain.handle("files:bulkTag",async(e,t,r)=>{try{for(const n of t)await At.addTags(n,r)}catch(n){throw console.error("Error bulk tagging:",n),n}});D.ipcMain.handle("files:sync",async(e,t)=>{try{return await At.sync(t)}catch(r){throw console.error("Error syncing files:",r),r}});D.ipcMain.handle("tags:getAll",async()=>{try{return await Da.getAll()}catch(e){throw console.error("Error getting tags:",e),e}});D.ipcMain.handle("tags:create",async(e,t)=>{try{return await Da.create(t.name,t.category,t.color)}catch(r){throw console.error("Error creating tag:",r),r}});D.ipcMain.handle("tags:delete",async(e,t)=>{try{await Da.delete(t)}catch(r){throw console.error("Error deleting tag:",r),r}});D.ipcMain.handle("collections:getAll",async()=>{try{return await Mt.getAll()}catch(e){throw console.error("Error getting collections:",e),e}});D.ipcMain.handle("collections:create",async(e,t)=>{try{return await Mt.create(t.name,t.color,t.description)}catch(r){throw console.error("Error creating collection:",r),r}});D.ipcMain.handle("collections:update",async(e,t,r)=>{try{return await Mt.update(t,r)}catch(n){throw console.error("Error updating collection:",n),n}});D.ipcMain.handle("collections:delete",async(e,t)=>{try{return await Mt.delete(t)}catch(r){throw console.error("Error deleting collection:",r),r}});D.ipcMain.handle("collections:addFiles",async(e,t,r)=>{try{await Mt.addFiles(t,r)}catch(n){throw console.error("Error adding files to collection:",n),n}});D.ipcMain.handle("collections:removeFiles",async(e,t,r)=>{try{await Mt.removeFiles(t,r)}catch(n){throw console.error("Error removing files from collection:",n),n}});D.ipcMain.handle("collections:getById",async(e,t)=>{try{return await Mt.getById(t)}catch(r){throw console.error("Error getting collection:",r),r}});D.ipcMain.handle("stats:get",async()=>{try{return await wd.get()}catch(e){throw console.error("Error getting stats:",e),e}});D.ipcMain.handle("folders:selectFolder",async()=>{try{const e=await D.dialog.showOpenDialog(K,{properties:["openDirectory"],title:"Select Folder to Scan"});return e.canceled||e.filePaths.length===0?null:e.filePaths[0]}catch(e){throw console.error("Error selecting folder:",e),e}});D.ipcMain.handle("folders:scan",async(e,t,r)=>{try{return await Ul(t,{recursive:(r==null?void 0:r.recursive)??!0,autoTag:(r==null?void 0:r.autoTag)??!0,onProgress:i=>{K==null||K.webContents.send("scan:progress",i)}})}catch(n){throw console.error("Error scanning folder:",n),n}});D.ipcMain.handle("folders:scanMultiple",async(e,t,r)=>{try{return await Rd(t,{recursive:(r==null?void 0:r.recursive)??!0,autoTag:(r==null?void 0:r.autoTag)??!0,onProgress:i=>{K==null||K.webContents.send("scan:progress",i)}})}catch(n){throw console.error("Error scanning folders:",n),n}});D.ipcMain.handle("audio:analyze",async(e,t,r)=>{try{return await Bl(t,r)}catch(n){throw console.error("Error analyzing audio:",n),n}});D.ipcMain.handle("audio:batchAnalyze",async(e,t)=>{try{return await Ud(t,(n,i,a)=>{K==null||K.webContents.send("audio:progress",{current:n,total:i,fileName:a})})}catch(r){throw console.error("Error batch analyzing:",r),r}});D.ipcMain.handle("cloud:selectFilesForUpload",async()=>{try{const e=await D.dialog.showOpenDialog(K,{properties:["openFile","multiSelections"],title:"Select Audio Files to Upload",filters:[{name:"Audio Files",extensions:["wav","mp3","flac","ogg","aiff"]}]});return e.canceled||e.filePaths.length===0?null:e.filePaths}catch(e){throw console.error("Error selecting files:",e),e}});D.ipcMain.handle("cloud:uploadFiles",async(e,t)=>{try{return await dT(t,n=>{K==null||K.webContents.send("cloud:uploadProgress",n)})}catch(r){throw console.error("Error uploading files:",r),r}});D.ipcMain.handle("cloud:uploadFile",async(e,t)=>{try{return await tf(t,{onProgress:n=>{K==null||K.webContents.send("cloud:uploadProgress",{current:1,total:1,currentFile:n,completed:[],failed:[]})}})}catch(r){throw console.error("Error uploading file:",r),r}});D.ipcMain.handle("cloud:getFiles",async(e,t,r)=>{try{return await Bt.getFiles(t,r)}catch(n){throw console.error("Error getting cloud files:",n),n}});D.ipcMain.handle("cloud:getFile",async(e,t)=>{try{return(await Bt.getFile(t)).file}catch(r){throw console.error("Error getting cloud file:",r),r}});D.ipcMain.handle("cloud:deleteFile",async(e,t)=>{try{return await Bt.deleteFile(t),{success:!0}}catch(r){throw console.error("Error deleting cloud file:",r),r}});D.ipcMain.handle("cloud:downloadFile",async(e,t,r)=>{try{const n=await D.dialog.showSaveDialog(K,{title:"Save File",defaultPath:r,filters:[{name:"Audio Files",extensions:["wav","mp3","flac","ogg","aiff"]}]});return n.canceled||!n.filePath?{success:!1,canceled:!0}:await hT(t,n.filePath,(a,o)=>{K==null||K.webContents.send("cloud:downloadProgress",{loaded:a,total:o,percent:o>0?Math.round(a/o*100):0})})}catch(n){throw console.error("Error downloading cloud file:",n),n}});D.ipcMain.handle("cloud:shareFile",async(e,t)=>{try{return(await Bt.shareFile(t,!0)).data}catch(r){throw console.error("Error sharing file:",r),r}});D.ipcMain.handle("cloud:revokeShare",async(e,t)=>{try{return await Bt.revokeShare(t),{success:!0}}catch(r){throw console.error("Error revoking share:",r),r}});D.ipcMain.handle("cloud:getSharedWithMe",async()=>{try{return(await Bt.getSharedWithMe()).files}catch(e){throw console.error("Error getting shared files:",e),e}});D.ipcMain.handle("cloud:getStorage",async()=>{try{return(await Bt.getStorage()).data}catch(e){throw console.error("Error getting storage:",e),e}});D.ipcMain.handle("cloud:copyShareLink",async(e,t)=>{try{return D.clipboard.writeText(t),{success:!0}}catch(r){throw console.error("Error copying to clipboard:",r),r}});D.ipcMain.handle("cloud:openShareLink",async(e,t)=>{try{return await D.shell.openExternal(t),{success:!0}}catch(r){throw console.error("Error opening share link:",r),r}});
